import{$ as de,$a as fe,A as ro,Aa as kp,B as Vt,Ba as hr,C as st,Ca as Yc,D as Dn,Da as Op,E as Bc,Ea as Np,F as ir,Fa as Mp,G as Tp,Ga as bt,H as sn,Ha as ge,I as pt,Ia as xp,J as $c,Ja as Ct,K as bp,Ka as Jc,L as jc,La as Xc,M as Cp,Ma as W,N as zc,Na as J,O as ot,Oa as he,P as sr,Pa as ao,Q as Ie,Qa as De,R as we,Ra as on,S as z,Sa as an,T as Ap,Ta as cn,U as ce,Ua as Fp,V as qc,Va as Lp,W as Q,Wa as Zc,X as M,Xa as eu,Y as at,Ya as Oe,Z as Gc,Za as yt,_ as Ii,_a as tu,a as V,aa as io,ab as dr,b as Ae,ba as Dp,bb as co,c as C,ca as gt,cb as Vp,d as yp,da as Sp,db as nu,e as Oc,ea as or,eb as Up,f as nn,fa as mt,fb as Bp,g as Nc,ga as Ti,gb as bi,h as Mc,ha as ar,hb as $p,i as ft,ia as cr,ib as uo,j as nt,ja as Wc,jb as ru,k as vp,ka as Sn,kb as iu,l as _p,la as so,lb as lo,m as rn,ma as Qe,mb as su,n as xc,na as We,nb as jp,o as Fc,oa as Hc,ob as Ci,p as Lc,pa as It,pb as ou,q as He,qa as ur,qb as zp,r as $,ra as Rp,rb as Ut,s as rt,sa as Kc,t as wp,ta as Pp,u as Ep,ua as Tt,v as H,va as Qc,w as Vc,wa as Rn,x as it,xa as lr,y as Ip,ya as ne,z as Uc,za as oo}from"./chunk-R323AFYF.js";var Kp=null;function fr(){return Kp}function Qp(n){Kp??=n}var ho=class{};var Be=new ce(""),cu=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=z({token:n,factory:()=>M(B_),providedIn:"platform"})}}return n})();var B_=(()=>{class n extends cu{constructor(){super(),this._doc=M(Be),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return fr().getBaseHref(this._doc)}onPopState(t){let r=fr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=fr().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=z({token:n,factory:()=>new n,providedIn:"platform"})}}return n})();function uu(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function qp(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function Bt(n){return n&&n[0]!=="?"?"?"+n:n}var Pn=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=z({token:n,factory:()=>M(Jp),providedIn:"root"})}}return n})(),Yp=new ce(""),Jp=(()=>{class n extends Pn{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??M(Be).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return uu(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Bt(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let a=this.prepareExternalUrl(i+Bt(s));this._platformLocation.pushState(t,r,a)}replaceState(t,r,i,s){let a=this.prepareExternalUrl(i+Bt(s));this._platformLocation.replaceState(t,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(Q(cu),Q(Yp,8))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),lu=(()=>{class n extends Pn{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(t){let r=uu(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,s){let a=this.prepareExternalUrl(i+Bt(s));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.pushState(t,r,a)}replaceState(t,r,i,s){let a=this.prepareExternalUrl(i+Bt(s));a.length==0&&(a=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(Q(cu),Q(Yp,8))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac})}}return n})(),Ai=(()=>{class n{constructor(t){this._subject=new Qe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=z_(qp(Gp(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Bt(r))}normalize(t){return n.stripTrailingSlash(j_(this._basePath,Gp(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Bt(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Bt(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=Bt}static{this.joinWithSlash=uu}static{this.stripTrailingSlash=qp}static{this.\u0275fac=function(r){return new(r||n)(Q(Pn))}}static{this.\u0275prov=z({token:n,factory:()=>$_(),providedIn:"root"})}}return n})();function $_(){return new Ai(Q(Pn))}function j_(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function Gp(n){return n.replace(/\/index.html$/,"")}function z_(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function go(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var au=/\s+/,Wp=[],gr=(()=>{class n{constructor(t,r){this._ngEl=t,this._renderer=r,this.initialClasses=Wp,this.stateMap=new Map}set klass(t){this.initialClasses=t!=null?t.trim().split(au):Wp}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(au):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(au).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static{this.\u0275fac=function(r){return new(r||n)(oo(ur),oo(hr))}}static{this.\u0275dir=io({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return n})();function q_(n,e){return new we(2100,!1)}var Xp=(()=>{class n{transform(t,r,i){if(t==null)return null;if(!this.supports(t))throw q_(n,t);return t.slice(r,i)}supports(t){return typeof t=="string"||Array.isArray(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275pipe=Dp({name:"slice",type:n,pure:!1,standalone:!0})}}return n})();var Zp="browser",G_="server";function mo(n){return n===G_}var pr=class{};var Si=class{},vo=class{},$t=class n{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=i.toLowerCase(),a=t.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(a):this.headers.set(s,[a])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let a=this.headers.get(t);if(!a)return;a=a.filter(c=>s.indexOf(c)===-1),a.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}break}}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var du=class{encodeKey(e){return eg(e)}encodeValue(e){return eg(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function H_(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[a,c]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],u=t.get(a)||[];u.push(c),t.set(a,u)}),t}var K_=/%(\d[a-f0-9])/gi,Q_={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function eg(n){return encodeURIComponent(n).replace(K_,(e,t)=>Q_[t]??e)}function yo(n){return`${n}`}var ln=class n{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new du,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=H_(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],i=Array.isArray(r)?r.map(yo):[yo(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(yo(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(yo(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var fu=class{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function Y_(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function tg(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function ng(n){return typeof Blob<"u"&&n instanceof Blob}function rg(n){return typeof FormData<"u"&&n instanceof FormData}function J_(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var Di=class n{constructor(e,t,r,i){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(Y_(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new $t,this.context??=new fu,!this.params)this.params=new ln,this.urlWithParams=t;else{let a=this.params.toString();if(a.length===0)this.urlWithParams=t;else{let c=t.indexOf("?"),u=c===-1?"?":c<t.length-1?"&":"";this.urlWithParams=t+u+a}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||tg(this.body)||ng(this.body)||rg(this.body)||J_(this.body)?this.body:this.body instanceof ln?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||rg(this.body)?null:ng(this.body)?this.body.type||null:tg(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof ln?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,a=e.body!==void 0?e.body:this.body,c=e.withCredentials??this.withCredentials,u=e.reportProgress??this.reportProgress,d=e.headers||this.headers,p=e.params||this.params,m=e.context??this.context;return e.setHeaders!==void 0&&(d=Object.keys(e.setHeaders).reduce((w,A)=>w.set(A,e.setHeaders[A]),d)),e.setParams&&(p=Object.keys(e.setParams).reduce((w,A)=>w.set(A,e.setParams[A]),p)),new n(t,r,a,{params:p,headers:d,context:m,reportProgress:u,responseType:i,withCredentials:c,transferCache:s})}},hn=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(hn||{}),Ri=class{constructor(e,t=200,r="OK"){this.headers=e.headers||new $t,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},_o=class n extends Ri{constructor(e={}){super(e),this.type=hn.ResponseHeader}clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Pi=class n extends Ri{constructor(e={}){super(e),this.type=hn.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},un=class extends Ri{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},ag=200,X_=204;function hu(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var ki=(()=>{class n{constructor(t){this.handler=t}request(t,r,i={}){let s;if(t instanceof Di)s=t;else{let u;i.headers instanceof $t?u=i.headers:u=new $t(i.headers);let d;i.params&&(i.params instanceof ln?d=i.params:d=new ln({fromObject:i.params})),s=new Di(t,r,i.body!==void 0?i.body:null,{headers:u,context:i.context,params:d,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}let a=$(s).pipe(Dn(u=>this.handler.handle(u)));if(t instanceof Di||i.observe==="events")return a;let c=a.pipe(Vt(u=>u instanceof Pi));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return c.pipe(H(u=>{if(u.body!==null&&!(u.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return u.body}));case"blob":return c.pipe(H(u=>{if(u.body!==null&&!(u.body instanceof Blob))throw new Error("Response is not a Blob.");return u.body}));case"text":return c.pipe(H(u=>{if(u.body!==null&&typeof u.body!="string")throw new Error("Response is not a string.");return u.body}));case"json":default:return c.pipe(H(u=>u.body))}case"response":return c;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:new ln().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,hu(i,r))}post(t,r,i={}){return this.request("POST",t,hu(i,r))}put(t,r,i={}){return this.request("PUT",t,hu(i,r))}static{this.\u0275fac=function(r){return new(r||n)(Q(Si))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac})}}return n})(),Z_=/^\)\]\}',?\n/,ew="X-Request-URL";function ig(n){if(n.url)return n.url;let e=ew.toLocaleLowerCase();return n.headers.get(e)}var tw=(()=>{class n{constructor(){this.fetchImpl=M(pu,{optional:!0})?.fetch??((...t)=>globalThis.fetch(...t)),this.ngZone=M(We)}handle(t){return new nn(r=>{let i=new AbortController;return this.doRequest(t,i.signal,r).then(gu,s=>r.error(new un({error:s}))),()=>i.abort()})}doRequest(t,r,i){return C(this,null,function*(){let s=this.createRequestInit(t),a;try{let A=this.ngZone.runOutsideAngular(()=>this.fetchImpl(t.urlWithParams,V({signal:r},s)));nw(A),i.next({type:hn.Sent}),a=yield A}catch(A){i.error(new un({error:A,status:A.status??0,statusText:A.statusText,url:t.urlWithParams,headers:A.headers}));return}let c=new $t(a.headers),u=a.statusText,d=ig(a)??t.urlWithParams,p=a.status,m=null;if(t.reportProgress&&i.next(new _o({headers:c,status:p,statusText:u,url:d})),a.body){let A=a.headers.get("content-length"),P=[],k=a.body.getReader(),S=0,U,q,L=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>C(this,null,function*(){for(;;){let{done:ye,value:ee}=yield k.read();if(ye)break;if(P.push(ee),S+=ee.length,t.reportProgress){q=t.responseType==="text"?(q??"")+(U??=new TextDecoder).decode(ee,{stream:!0}):void 0;let E=()=>i.next({type:hn.DownloadProgress,total:A?+A:void 0,loaded:S,partialText:q});L?L.run(E):E()}}}));let se=this.concatChunks(P,S);try{let ye=a.headers.get("Content-Type")??"";m=this.parseBody(t,se,ye)}catch(ye){i.error(new un({error:ye,headers:new $t(a.headers),status:a.status,statusText:a.statusText,url:ig(a)??t.urlWithParams}));return}}p===0&&(p=m?ag:0),p>=200&&p<300?(i.next(new Pi({body:m,headers:c,status:p,statusText:u,url:d})),i.complete()):i.error(new un({error:m,headers:c,status:p,statusText:u,url:d}))})}parseBody(t,r,i){switch(t.responseType){case"json":let s=new TextDecoder().decode(r).replace(Z_,"");return s===""?null:JSON.parse(s);case"text":return new TextDecoder().decode(r);case"blob":return new Blob([r],{type:i});case"arraybuffer":return r.buffer}}createRequestInit(t){let r={},i=t.withCredentials?"include":void 0;if(t.headers.forEach((s,a)=>r[s]=a.join(",")),t.headers.has("Accept")||(r.Accept="application/json, text/plain, */*"),!t.headers.has("Content-Type")){let s=t.detectContentTypeHeader();s!==null&&(r["Content-Type"]=s)}return{body:t.serializeBody(),method:t.method,headers:r,credentials:i}}concatChunks(t,r){let i=new Uint8Array(r),s=0;for(let a of t)i.set(a,s),s+=a.length;return i}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac})}}return n})(),pu=class{};function gu(){}function nw(n){n.then(gu,gu)}function rw(n,e){return e(n)}function iw(n,e,t){return(r,i)=>mt(t,()=>e(r,s=>n(s,i)))}var cg=new ce(""),sw=new ce(""),ow=new ce("",{providedIn:"root",factory:()=>!0});var sg=(()=>{class n extends Si{constructor(t,r){super(),this.backend=t,this.injector=r,this.chain=null,this.pendingTasks=M(so),this.contributeToStability=M(ow)}handle(t){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(cg),...this.injector.get(sw,[])]));this.chain=r.reduceRight((i,s)=>iw(i,s,this.injector),rw)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(sn(()=>this.pendingTasks.remove(r)))}else return this.chain(t,r=>this.backend.handle(r))}static{this.\u0275fac=function(r){return new(r||n)(Q(vo),Q(or))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac})}}return n})();var aw=/^\)\]\}',?\n/;function cw(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}var og=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new we(-2800,!1);let r=this.xhrFactory;return(r.\u0275loadImpl?He(r.\u0275loadImpl()):$(null)).pipe(ot(()=>new nn(s=>{let a=r.build();if(a.open(t.method,t.urlWithParams),t.withCredentials&&(a.withCredentials=!0),t.headers.forEach((k,S)=>a.setRequestHeader(k,S.join(","))),t.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){let k=t.detectContentTypeHeader();k!==null&&a.setRequestHeader("Content-Type",k)}if(t.responseType){let k=t.responseType.toLowerCase();a.responseType=k!=="json"?k:"text"}let c=t.serializeBody(),u=null,d=()=>{if(u!==null)return u;let k=a.statusText||"OK",S=new $t(a.getAllResponseHeaders()),U=cw(a)||t.url;return u=new _o({headers:S,status:a.status,statusText:k,url:U}),u},p=()=>{let{headers:k,status:S,statusText:U,url:q}=d(),L=null;S!==X_&&(L=typeof a.response>"u"?a.responseText:a.response),S===0&&(S=L?ag:0);let se=S>=200&&S<300;if(t.responseType==="json"&&typeof L=="string"){let ye=L;L=L.replace(aw,"");try{L=L!==""?JSON.parse(L):null}catch(ee){L=ye,se&&(se=!1,L={error:ee,text:L})}}se?(s.next(new Pi({body:L,headers:k,status:S,statusText:U,url:q||void 0})),s.complete()):s.error(new un({error:L,headers:k,status:S,statusText:U,url:q||void 0}))},m=k=>{let{url:S}=d(),U=new un({error:k,status:a.status||0,statusText:a.statusText||"Unknown Error",url:S||void 0});s.error(U)},w=!1,A=k=>{w||(s.next(d()),w=!0);let S={type:hn.DownloadProgress,loaded:k.loaded};k.lengthComputable&&(S.total=k.total),t.responseType==="text"&&a.responseText&&(S.partialText=a.responseText),s.next(S)},P=k=>{let S={type:hn.UploadProgress,loaded:k.loaded};k.lengthComputable&&(S.total=k.total),s.next(S)};return a.addEventListener("load",p),a.addEventListener("error",m),a.addEventListener("timeout",m),a.addEventListener("abort",m),t.reportProgress&&(a.addEventListener("progress",A),c!==null&&a.upload&&a.upload.addEventListener("progress",P)),a.send(c),s.next({type:hn.Sent}),()=>{a.removeEventListener("error",m),a.removeEventListener("abort",m),a.removeEventListener("load",p),a.removeEventListener("timeout",m),t.reportProgress&&(a.removeEventListener("progress",A),c!==null&&a.upload&&a.upload.removeEventListener("progress",P)),a.readyState!==a.DONE&&a.abort()}})))}static{this.\u0275fac=function(r){return new(r||n)(Q(pr))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac})}}return n})(),ug=new ce(""),uw="XSRF-TOKEN",lw=new ce("",{providedIn:"root",factory:()=>uw}),hw="X-XSRF-TOKEN",dw=new ce("",{providedIn:"root",factory:()=>hw}),wo=class{},fw=(()=>{class n{constructor(t,r,i){this.doc=t,this.platform=r,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=go(t,this.cookieName),this.lastCookieString=t),this.lastToken}static{this.\u0275fac=function(r){return new(r||n)(Q(Be),Q(Tt),Q(lw))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac})}}return n})();function pw(n,e){let t=n.url.toLowerCase();if(!M(ug)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let r=M(wo).getToken(),i=M(dw);return r!=null&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,r)})),e(n)}function lg(...n){let e=[ki,og,sg,{provide:Si,useExisting:sg},{provide:vo,useFactory:()=>M(tw,{optional:!0})??M(og)},{provide:cg,useValue:pw,multi:!0},{provide:ug,useValue:!0},{provide:wo,useClass:fw}];for(let t of n)e.push(...t.\u0275providers);return gt(e)}var vu=class extends ho{constructor(){super(...arguments),this.supportsDOMEvents=!0}},_u=class n extends vu{static makeCurrent(){Qp(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=yw();return t==null?null:vw(t)}resetBaseElement(){Oi=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return go(document.cookie,e)}},Oi=null;function yw(){return Oi=Oi||document.querySelector("base"),Oi?Oi.getAttribute("href"):null}function vw(n){return new URL(n,document.baseURI).pathname}var _w=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac})}}return n})(),wu=new ce(""),pg=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new we(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||n)(Q(wu),Q(We))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac})}}return n})(),Eo=class{constructor(e){this._doc=e}},mu="ng-app-id",gg=(()=>{class n{constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=mo(s),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${mu}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let s=i.get(t);return s.usage+=r,s.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===t)return i.delete(r),s.removeAttribute(mu),s;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=r,this.platformIsServer&&a.setAttribute(mu,this.appId),t.appendChild(a),a}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),s=this.styleRef,a=s.get(r)?.elements;a?a.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||n)(Q(Be),Q(Kc),Q(Qc,8),Q(Tt))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac})}}return n})(),yu={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Iu=/%COMP%/g,mg="%COMP%",ww=`_nghost-${mg}`,Ew=`_ngcontent-${mg}`,Iw=!0,Tw=new ce("",{providedIn:"root",factory:()=>Iw});function bw(n){return Ew.replace(Iu,n)}function Cw(n){return ww.replace(Iu,n)}function yg(n,e){return e.map(t=>t.replace(Iu,n))}var hg=(()=>{class n{constructor(t,r,i,s,a,c,u,d=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=a,this.platformId=c,this.ngZone=u,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=mo(c),this.defaultRenderer=new Ni(t,a,u,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Ii.ShadowDom&&(r=Ae(V({},r),{encapsulation:Ii.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof Io?i.applyToHost(t):i instanceof Mi&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let a=this.doc,c=this.ngZone,u=this.eventManager,d=this.sharedStylesHost,p=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(r.encapsulation){case Ii.Emulated:s=new Io(u,d,r,this.appId,p,a,c,m);break;case Ii.ShadowDom:return new Eu(u,d,t,r,a,c,this.nonce,m);default:s=new Mi(u,d,r,p,a,c,m);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||n)(Q(pg),Q(gg),Q(Kc),Q(Tw),Q(Be),Q(Tt),Q(We),Q(Qc))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac})}}return n})(),Ni=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(yu[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(dg(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(dg(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new we(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=yu[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=yu[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(lr.DashCase|lr.Important)?e.style.setProperty(t,r,i&lr.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&lr.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=fr().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function dg(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Eu=class extends Ni{constructor(e,t,r,i,s,a,c,u){super(e,s,a,u),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=yg(i.id,i.styles);for(let p of d){let m=document.createElement("style");c&&m.setAttribute("nonce",c),m.textContent=p,this.shadowRoot.appendChild(m)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Mi=class extends Ni{constructor(e,t,r,i,s,a,c,u){super(e,s,a,c),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=u?yg(u,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Io=class extends Mi{constructor(e,t,r,i,s,a,c,u){let d=i+"-"+r.id;super(e,t,r,s,a,c,u,d),this.contentAttr=bw(d),this.hostAttr=Cw(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},Aw=(()=>{class n extends Eo{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||n)(Q(Be))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac})}}return n})(),fg=["alt","control","meta","shift"],Dw={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Sw={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},Rw=(()=>{class n extends Eo{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>fr().onAndCancel(t,s.domEventName,a))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),a="",c=r.indexOf("code");if(c>-1&&(r.splice(c,1),a="code."),fg.forEach(d=>{let p=r.indexOf(d);p>-1&&(r.splice(p,1),a+=d+".")}),a+=s,r.length!=0||s.length===0)return null;let u={};return u.domEventName=i,u.fullKey=a,u}static matchEventFullKeyCode(t,r){let i=Dw[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),fg.forEach(a=>{if(a!==i){let c=Sw[a];c(t)&&(s+=a+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||n)(Q(Be))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac})}}return n})();function vg(n,e,t){return zp(V({rootComponent:n,platformRef:t?.platformRef},Pw(e)))}function Pw(n){return{appProviders:[...xw,...n?.providers??[]],platformProviders:Mw}}function kw(){_u.makeCurrent()}function Ow(){return new Hc}function Nw(){return Rp(document),document}var Mw=[{provide:Tt,useValue:Zp},{provide:Pp,useValue:kw,multi:!0},{provide:Be,useFactory:Nw,deps:[]}];var xw=[{provide:Sp,useValue:"root"},{provide:Hc,useFactory:Ow,deps:[]},{provide:wu,useClass:Aw,multi:!0,deps:[Be,We,Tt]},{provide:wu,useClass:Rw,multi:!0,deps:[Be]},hg,gg,pg,{provide:kp,useExisting:hg},{provide:pr,useClass:_w,deps:[]},[]];var _g=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(r){return new(r||n)(Q(Be))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Y="primary",Ji=Symbol("RouteTitle"),Du=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Er(n){return new Du(n)}function Lw(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let a=r[s],c=n[s];if(a[0]===":")i[a.substring(1)]=c;else if(a!==c.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Vw(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!At(n[t],e[t]))return!1;return!0}function At(n,e){let t=n?Su(n):void 0,r=e?Su(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!Dg(n[i],e[i]))return!1;return!0}function Su(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function Dg(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function Sg(n){return n.length>0?n[n.length-1]:null}function dn(n){return wp(n)?n:ru(n)?He(Promise.resolve(n)):$(n)}var Uw={exact:Pg,subset:kg},Rg={exact:Bw,subset:$w,ignored:()=>!0};function wg(n,e,t){return Uw[t.paths](n.root,e.root,t.matrixParams)&&Rg[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function Bw(n,e){return At(n,e)}function Pg(n,e,t){if(!On(n.segments,e.segments)||!Co(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!Pg(n.children[r],e.children[r],t))return!1;return!0}function $w(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>Dg(n[t],e[t]))}function kg(n,e,t){return Og(n,e,e.segments,t)}function Og(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!On(i,t)||e.hasChildren()||!Co(i,t,r))}else if(n.segments.length===t.length){if(!On(n.segments,t)||!Co(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!kg(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!On(n.segments,i)||!Co(n.segments,i,r)||!n.children[Y]?!1:Og(n.children[Y],e,s,r)}}function Co(n,e,t){return e.every((r,i)=>Rg[t](n[i].parameters,r.parameters))}var zt=class{constructor(e=new ae([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Er(this.queryParams),this._queryParamMap}toString(){return qw.serialize(this)}},ae=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ao(this)}},kn=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Er(this.parameters),this._parameterMap}toString(){return Mg(this)}};function jw(n,e){return On(n,e)&&n.every((t,r)=>At(t.parameters,e[r].parameters))}function On(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function zw(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===Y&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==Y&&(t=t.concat(e(i,r)))}),t}var el=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=z({token:n,factory:()=>new $i,providedIn:"root"})}}return n})(),$i=class{parse(e){let t=new Pu(e);return new zt(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${xi(e.root,!0)}`,r=Hw(e.queryParams),i=typeof e.fragment=="string"?`#${Gw(e.fragment)}`:"";return`${t}${r}${i}`}},qw=new $i;function Ao(n){return n.segments.map(e=>Mg(e)).join("/")}function xi(n,e){if(!n.hasChildren())return Ao(n);if(e){let t=n.children[Y]?xi(n.children[Y],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==Y&&r.push(`${i}:${xi(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=zw(n,(r,i)=>i===Y?[xi(n.children[Y],!1)]:[`${i}:${xi(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[Y]!=null?`${Ao(n)}/${t[0]}`:`${Ao(n)}/(${t.join("//")})`}}function Ng(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function To(n){return Ng(n).replace(/%3B/gi,";")}function Gw(n){return encodeURI(n)}function Ru(n){return Ng(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Do(n){return decodeURIComponent(n)}function Eg(n){return Do(n.replace(/\+/g,"%20"))}function Mg(n){return`${Ru(n.path)}${Ww(n.parameters)}`}function Ww(n){return Object.entries(n).map(([e,t])=>`;${Ru(e)}=${Ru(t)}`).join("")}function Hw(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${To(t)}=${To(i)}`).join("&"):`${To(t)}=${To(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var Kw=/^[^\/()?;#]+/;function Tu(n){let e=n.match(Kw);return e?e[0]:""}var Qw=/^[^\/()?;=#]+/;function Yw(n){let e=n.match(Qw);return e?e[0]:""}var Jw=/^[^=?&#]+/;function Xw(n){let e=n.match(Jw);return e?e[0]:""}var Zw=/^[^&#]+/;function eE(n){let e=n.match(Zw);return e?e[0]:""}var Pu=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ae([],{}):new ae([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[Y]=new ae(e,t)),r}parseSegment(){let e=Tu(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new we(4009,!1);return this.capture(e),new kn(Do(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=Yw(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Tu(this.remaining);i&&(r=i,this.capture(r))}e[Do(t)]=Do(r)}parseQueryParam(e){let t=Xw(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let a=eE(this.remaining);a&&(r=a,this.capture(r))}let i=Eg(t),s=Eg(r);if(e.hasOwnProperty(i)){let a=e[i];Array.isArray(a)||(a=[a],e[i]=a),a.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Tu(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new we(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=Y);let a=this.parseChildren();t[s]=Object.keys(a).length===1?a[Y]:new ae([],a),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new we(4011,!1)}};function xg(n){return n.segments.length>0?new ae([],{[Y]:n}):n}function Fg(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=Fg(i);if(r===Y&&s.segments.length===0&&s.hasChildren())for(let[a,c]of Object.entries(s.children))e[a]=c;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new ae(n.segments,e);return tE(t)}function tE(n){if(n.numberOfChildren===1&&n.children[Y]){let e=n.children[Y];return new ae(n.segments.concat(e.segments),e.children)}return n}function ji(n){return n instanceof zt}function nE(n,e,t=null,r=null){let i=Lg(n);return Vg(i,e,t,r)}function Lg(n){let e;function t(s){let a={};for(let u of s.children){let d=t(u);a[u.outlet]=d}let c=new ae(s.url,a);return s===n&&(e=c),c}let r=t(n.root),i=xg(r);return e??i}function Vg(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return bu(i,i,i,t,r);let s=rE(e);if(s.toRoot())return bu(i,i,new ae([],{}),t,r);let a=iE(s,i,n),c=a.processChildren?Vi(a.segmentGroup,a.index,s.commands):Bg(a.segmentGroup,a.index,s.commands);return bu(i,a.segmentGroup,c,t,r)}function So(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function zi(n){return typeof n=="object"&&n!=null&&n.outlets}function bu(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([u,d])=>{s[u]=Array.isArray(d)?d.map(p=>`${p}`):`${d}`});let a;n===e?a=t:a=Ug(n,e,t);let c=xg(Fg(a));return new zt(c,s,i)}function Ug(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=Ug(s,e,t)}),new ae(n.segments,r)}var Ro=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&So(r[0]))throw new we(4003,!1);let i=r.find(zi);if(i&&i!==Sg(r))throw new we(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function rE(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Ro(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,a)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let c={};return Object.entries(s.outlets).forEach(([u,d])=>{c[u]=typeof d=="string"?d.split("/"):d}),[...i,{outlets:c}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:a===0?(s.split("/").forEach((c,u)=>{u==0&&c==="."||(u==0&&c===""?t=!0:c===".."?e++:c!=""&&i.push(c))}),i):[...i,s]},[]);return new Ro(t,e,r)}var vr=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function iE(n,e,t){if(n.isAbsolute)return new vr(e,!0,0);if(!t)return new vr(e,!1,NaN);if(t.parent===null)return new vr(t,!0,0);let r=So(n.commands[0])?0:1,i=t.segments.length-1+r;return sE(t,i,n.numberOfDoubleDots)}function sE(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new we(4005,!1);i=r.segments.length}return new vr(r,!1,i-s)}function oE(n){return zi(n[0])?n[0].outlets:{[Y]:n}}function Bg(n,e,t){if(n??=new ae([],{}),n.segments.length===0&&n.hasChildren())return Vi(n,e,t);let r=aE(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new ae(n.segments.slice(0,r.pathIndex),{});return s.children[Y]=new ae(n.segments.slice(r.pathIndex),n.children),Vi(s,0,i)}else return r.match&&i.length===0?new ae(n.segments,{}):r.match&&!n.hasChildren()?ku(n,e,t):r.match?Vi(n,0,i):ku(n,e,t)}function Vi(n,e,t){if(t.length===0)return new ae(n.segments,{});{let r=oE(t),i={};if(Object.keys(r).some(s=>s!==Y)&&n.children[Y]&&n.numberOfChildren===1&&n.children[Y].segments.length===0){let s=Vi(n.children[Y],e,t);return new ae(n.segments,s.children)}return Object.entries(r).forEach(([s,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(i[s]=Bg(n.children[s],e,a))}),Object.entries(n.children).forEach(([s,a])=>{r[s]===void 0&&(i[s]=a)}),new ae(n.segments,i)}}function aE(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let a=n.segments[i],c=t[r];if(zi(c))break;let u=`${c}`,d=r<t.length-1?t[r+1]:null;if(i>0&&u===void 0)break;if(u&&d&&typeof d=="object"&&d.outlets===void 0){if(!Tg(u,d,a))return s;r+=2}else{if(!Tg(u,{},a))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function ku(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(zi(s)){let u=cE(s.outlets);return new ae(r,u)}if(i===0&&So(t[0])){let u=n.segments[e];r.push(new kn(u.path,Ig(t[0]))),i++;continue}let a=zi(s)?s.outlets[Y]:`${s}`,c=i<t.length-1?t[i+1]:null;a&&c&&So(c)?(r.push(new kn(a,Ig(c))),i+=2):(r.push(new kn(a,{})),i++)}return new ae(r,{})}function cE(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=ku(new ae([],{}),0,r))}),e}function Ig(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function Tg(n,e,t){return n==t.path&&At(e,t.parameters)}var Ui="imperative",Ne=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(Ne||{}),ct=class{constructor(e,t){this.id=e,this.url=t}},qi=class extends ct{constructor(e,t,r="imperative",i=null){super(e,t),this.type=Ne.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Nn=class extends ct{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=Ne.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Je=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Je||{}),Ou=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Ou||{}),jt=class extends ct{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Ne.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Mn=class extends ct{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=Ne.NavigationSkipped}},Gi=class extends ct{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=Ne.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Po=class extends ct{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Ne.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Nu=class extends ct{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Ne.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Mu=class extends ct{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=Ne.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},xu=class extends ct{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Ne.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Fu=class extends ct{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=Ne.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Lu=class{constructor(e){this.route=e,this.type=Ne.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Vu=class{constructor(e){this.route=e,this.type=Ne.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Uu=class{constructor(e){this.snapshot=e,this.type=Ne.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Bu=class{constructor(e){this.snapshot=e,this.type=Ne.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},$u=class{constructor(e){this.snapshot=e,this.type=Ne.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ju=class{constructor(e){this.snapshot=e,this.type=Ne.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Wi=class{},Ir=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function uE(n,e){return n.providers&&!n._injector&&(n._injector=Mp(n.providers,e,`Route: ${n.path}`)),n._injector??e}function vt(n){return n.outlet||Y}function lE(n,e){let t=n.filter(r=>vt(r)===e);return t.push(...n.filter(r=>vt(r)!==e)),t}function Xi(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var zu=class{get injector(){return Xi(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new Lo(this.rootInjector),this.attachRef=null}},Lo=(()=>{class n{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new zu(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||n)(Q(or))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),ko=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=qu(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=qu(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=Gu(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return Gu(e,this._root).map(t=>t.value)}};function qu(n,e){if(n===e.value)return e;for(let t of e.children){let r=qu(n,t);if(r)return r}return null}function Gu(n,e){if(n===e.value)return[e];for(let t of e.children){let r=Gu(n,t);if(r.length)return r.unshift(e),r}return[]}var Ye=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function yr(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var Oo=class extends ko{constructor(e,t){super(e),this.snapshot=t,tl(this,e)}toString(){return this.snapshot.toString()}};function $g(n){let e=hE(n),t=new nt([new kn("",{})]),r=new nt({}),i=new nt({}),s=new nt({}),a=new nt(""),c=new Tr(t,r,s,a,i,Y,n,e.root);return c.snapshot=e.root,new Oo(new Ye(c,[]),e)}function hE(n){let e={},t={},r={},i="",s=new _r([],e,r,i,t,Y,n,null,{});return new Mo("",new Ye(s,[]))}var Tr=class{constructor(e,t,r,i,s,a,c,u){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=a,this.component=c,this._futureSnapshot=u,this.title=this.dataSubject?.pipe(H(d=>d[Ji]))??$(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(H(e=>Er(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(H(e=>Er(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function No(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:V(V({},e.params),n.params),data:V(V({},e.data),n.data),resolve:V(V(V(V({},n.data),e.data),i?.data),n._resolvedData)}:r={params:V({},n.params),data:V({},n.data),resolve:V(V({},n.data),n._resolvedData??{})},i&&zg(i)&&(r.resolve[Ji]=i.title),r}var _r=class{get title(){return this.data?.[Ji]}constructor(e,t,r,i,s,a,c,u,d){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=a,this.component=c,this.routeConfig=u,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Er(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Er(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},Mo=class extends ko{constructor(e,t){super(t),this.url=e,tl(this,t)}toString(){return jg(this._root)}};function tl(n,e){e.value._routerState=n,e.children.forEach(t=>tl(n,t))}function jg(n){let e=n.children.length>0?` { ${n.children.map(jg).join(", ")} } `:"";return`${n.value}${e}`}function Cu(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,At(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),At(e.params,t.params)||n.paramsSubject.next(t.params),Vw(e.url,t.url)||n.urlSubject.next(t.url),At(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Wu(n,e){let t=At(n.params,e.params)&&jw(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||Wu(n.parent,e.parent))}function zg(n){return typeof n.title=="string"||n.title===null}var nl=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=Y,this.activateEvents=new Qe,this.deactivateEvents=new Qe,this.attachEvents=new Qe,this.detachEvents=new Qe,this.parentContexts=M(Lo),this.location=M(Yc),this.changeDetector=M(Ci),this.inputBinder=M(rl,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new we(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new we(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new we(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new we(4013,!1);this._activatedRoute=t;let i=this.location,a=t.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,u=new Hu(t,c,i.injector);this.activated=i.createComponent(a,{index:i.length,injector:u,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=io({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ti]})}}return n})(),Hu=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Tr?this.route:e===Lo?this.childContexts:this.parent.get(e,t)}},rl=new ce("");function dE(n,e,t){let r=Hi(n,e._root,t?t._root:void 0);return new Oo(r,e)}function Hi(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=fE(n,e,t);return new Ye(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let a=s.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(c=>Hi(n,c)),a}}let r=pE(e.value),i=e.children.map(s=>Hi(n,s));return new Ye(r,i)}}function fE(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return Hi(n,r,i);return Hi(n,r)})}function pE(n){return new Tr(new nt(n.url),new nt(n.params),new nt(n.queryParams),new nt(n.fragment),new nt(n.data),n.outlet,n.component,n)}var Ki=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},qg="ngNavigationCancelingError";function xo(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=ji(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=Gg(!1,Je.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function Gg(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[qg]=!0,t.cancellationCode=e,t}function gE(n){return Wg(n)&&ji(n.url)}function Wg(n){return!!n&&n[qg]}var mE=(n,e,t,r)=>H(i=>(new Ku(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),Ku=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),Cu(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=yr(t);e.children.forEach(s=>{let a=s.value.outlet;this.deactivateRoutes(s,i[a],r),delete i[a]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let a=r.getContext(i.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=yr(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);if(r&&r.outlet){let a=r.outlet.detach(),c=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:c})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=yr(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=yr(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new ju(s.value.snapshot))}),e.children.length&&this.forwardEvent(new Bu(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(Cu(i),i===s)if(i.component){let a=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let a=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let c=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(c.contexts),a.attachRef=c.componentRef,a.route=c.route.value,a.outlet&&a.outlet.attach(c.componentRef,c.route.value),Cu(c.route.value),this.activateChildRoutes(e,null,a.children)}else a.attachRef=null,a.route=i,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(e,null,a.children)}else this.activateChildRoutes(e,null,r)}},Fo=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},wr=class{constructor(e,t){this.component=e,this.route=t}};function yE(n,e,t){let r=n._root,i=e?e._root:null;return Fi(r,i,t,[r.value])}function vE(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Cr(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!Ap(n)?n:e.get(n):r}function Fi(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=yr(e);return n.children.forEach(a=>{_E(a,s[a.value.outlet],t,r.concat([a.value]),i),delete s[a.value.outlet]}),Object.entries(s).forEach(([a,c])=>Bi(c,t.getContext(a),i)),i}function _E(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,a=e?e.value:null,c=t?t.getContext(n.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){let u=wE(a,s,s.routeConfig.runGuardsAndResolvers);u?i.canActivateChecks.push(new Fo(r)):(s.data=a.data,s._resolvedData=a._resolvedData),s.component?Fi(n,e,c?c.children:null,r,i):Fi(n,e,t,r,i),u&&c&&c.outlet&&c.outlet.isActivated&&i.canDeactivateChecks.push(new wr(c.outlet.component,a))}else a&&Bi(e,c,i),i.canActivateChecks.push(new Fo(r)),s.component?Fi(n,null,c?c.children:null,r,i):Fi(n,null,t,r,i);return i}function wE(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!On(n.url,e.url);case"pathParamsOrQueryParamsChange":return!On(n.url,e.url)||!At(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Wu(n,e)||!At(n.queryParams,e.queryParams);case"paramsChange":default:return!Wu(n,e)}}function Bi(n,e,t){let r=yr(n),i=n.value;Object.entries(r).forEach(([s,a])=>{i.component?e?Bi(a,e.children.getContext(s),t):Bi(a,null,t):Bi(a,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new wr(e.outlet.component,i)):t.canDeactivateChecks.push(new wr(null,i)):t.canDeactivateChecks.push(new wr(null,i))}function Zi(n){return typeof n=="function"}function EE(n){return typeof n=="boolean"}function IE(n){return n&&Zi(n.canLoad)}function TE(n){return n&&Zi(n.canActivate)}function bE(n){return n&&Zi(n.canActivateChild)}function CE(n){return n&&Zi(n.canDeactivate)}function AE(n){return n&&Zi(n.canMatch)}function Hg(n){return n instanceof Ep||n?.name==="EmptyError"}var bo=Symbol("INITIAL_VALUE");function br(){return ot(n=>Vc(n.map(e=>e.pipe(ir(1),zc(bo)))).pipe(H(e=>{for(let t of e)if(t!==!0){if(t===bo)return bo;if(t===!1||DE(t))return t}return!0}),Vt(e=>e!==bo),ir(1)))}function DE(n){return ji(n)||n instanceof Ki}function SE(n,e){return it(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:a}}=t;return a.length===0&&s.length===0?$(Ae(V({},t),{guardsResult:!0})):RE(a,r,i,n).pipe(it(c=>c&&EE(c)?PE(r,s,n,e):$(c)),H(c=>Ae(V({},t),{guardsResult:c})))})}function RE(n,e,t,r){return He(n).pipe(it(i=>xE(i.component,i.route,t,e,r)),pt(i=>i!==!0,!0))}function PE(n,e,t,r){return He(e).pipe(Dn(i=>Ip(OE(i.route.parent,r),kE(i.route,r),ME(n,i.path,t),NE(n,i.route,t))),pt(i=>i!==!0,!0))}function kE(n,e){return n!==null&&e&&e(new $u(n)),$(!0)}function OE(n,e){return n!==null&&e&&e(new Uu(n)),$(!0)}function NE(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return $(!0);let i=r.map(s=>Uc(()=>{let a=Xi(e)??t,c=Cr(s,a),u=TE(c)?c.canActivate(e,n):mt(a,()=>c(e,n));return dn(u).pipe(pt())}));return $(i).pipe(br())}function ME(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(a=>vE(a)).filter(a=>a!==null).map(a=>Uc(()=>{let c=a.guards.map(u=>{let d=Xi(a.node)??t,p=Cr(u,d),m=bE(p)?p.canActivateChild(r,n):mt(d,()=>p(r,n));return dn(m).pipe(pt())});return $(c).pipe(br())}));return $(s).pipe(br())}function xE(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return $(!0);let a=s.map(c=>{let u=Xi(e)??i,d=Cr(c,u),p=CE(d)?d.canDeactivate(n,e,t,r):mt(u,()=>d(n,e,t,r));return dn(p).pipe(pt())});return $(a).pipe(br())}function FE(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return $(!0);let s=i.map(a=>{let c=Cr(a,n),u=IE(c)?c.canLoad(e,t):mt(n,()=>c(e,t));return dn(u)});return $(s).pipe(br(),Kg(r))}function Kg(n){return Oc(Ie(e=>{if(typeof e!="boolean")throw xo(n,e)}),H(e=>e===!0))}function LE(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return $(!0);let s=i.map(a=>{let c=Cr(a,n),u=AE(c)?c.canMatch(e,t):mt(n,()=>c(e,t));return dn(u)});return $(s).pipe(br(),Kg(r))}var Qi=class{constructor(e){this.segmentGroup=e||null}},Yi=class extends Error{constructor(e){super(),this.urlTree=e}};function mr(n){return rt(new Qi(n))}function VE(n){return rt(new we(4e3,!1))}function UE(n){return rt(Gg(!1,Je.GuardRejected))}var Qu=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return $(r);if(i.numberOfChildren>1||!i.children[Y])return VE(`${e.redirectTo}`);i=i.children[Y]}}applyRedirectCommands(e,t,r,i,s){if(typeof t!="string"){let c=t,{queryParams:u,fragment:d,routeConfig:p,url:m,outlet:w,params:A,data:P,title:k}=i,S=mt(s,()=>c({params:A,data:P,queryParams:u,fragment:d,routeConfig:p,url:m,outlet:w,title:k}));if(S instanceof zt)throw new Yi(S);t=S}let a=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new Yi(a);return a}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new zt(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let c=s.substring(1);r[i]=t[c]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),a={};return Object.entries(t.children).forEach(([c,u])=>{a[c]=this.createSegmentGroup(e,u,r,i)}),new ae(s,a)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new we(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},Yu={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function BE(n,e,t,r,i){let s=Qg(n,e,t);return s.matched?(r=uE(e,r),LE(r,e,t,i).pipe(H(a=>a===!0?s:V({},Yu)))):$(s)}function Qg(n,e,t){if(e.path==="**")return $E(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?V({},Yu):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||Lw)(t,n,e);if(!i)return V({},Yu);let s={};Object.entries(i.posParams??{}).forEach(([c,u])=>{s[c]=u.path});let a=i.consumed.length>0?V(V({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function $E(n){return{matched:!0,parameters:n.length>0?Sg(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function bg(n,e,t,r){return t.length>0&&qE(n,t,r)?{segmentGroup:new ae(e,zE(r,new ae(t,n.children))),slicedSegments:[]}:t.length===0&&GE(n,t,r)?{segmentGroup:new ae(n.segments,jE(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new ae(n.segments,n.children),slicedSegments:t}}function jE(n,e,t,r){let i={};for(let s of t)if(Vo(n,e,s)&&!r[vt(s)]){let a=new ae([],{});i[vt(s)]=a}return V(V({},r),i)}function zE(n,e){let t={};t[Y]=e;for(let r of n)if(r.path===""&&vt(r)!==Y){let i=new ae([],{});t[vt(r)]=i}return t}function qE(n,e,t){return t.some(r=>Vo(n,e,r)&&vt(r)!==Y)}function GE(n,e,t){return t.some(r=>Vo(n,e,r))}function Vo(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function WE(n,e,t){return e.length===0&&!n.children[t]}var Ju=class{};function HE(n,e,t,r,i,s,a="emptyOnly"){return new Xu(n,e,t,r,i,a,s).recognize()}var KE=31,Xu=class{constructor(e,t,r,i,s,a,c){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=a,this.urlSerializer=c,this.applyRedirects=new Qu(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new we(4002,`'${e.segmentGroup}'`)}recognize(){let e=bg(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(H(({children:t,rootSnapshot:r})=>{let i=new Ye(r,t),s=new Mo("",i),a=nE(r,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(a),{state:s,tree:a}}))}match(e){let t=new _r([],Object.freeze({}),Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Y,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,Y,t).pipe(H(r=>({children:r,rootSnapshot:t})),st(r=>{if(r instanceof Yi)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Qi?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,s):this.processSegment(e,t,r,r.segments,i,!0,s).pipe(H(a=>a instanceof Ye?[a]:[]))}processChildren(e,t,r,i){let s=[];for(let a of Object.keys(r.children))a==="primary"?s.unshift(a):s.push(a);return He(s).pipe(Dn(a=>{let c=r.children[a],u=lE(t,a);return this.processSegmentGroup(e,u,c,a,i)}),jc((a,c)=>(a.push(...c),a)),Bc(null),bp(),it(a=>{if(a===null)return mr(r);let c=Yg(a);return QE(c),$(c)}))}processSegment(e,t,r,i,s,a,c){return He(t).pipe(Dn(u=>this.processSegmentAgainstRoute(u._injector??e,t,u,r,i,s,a,c).pipe(st(d=>{if(d instanceof Qi)return $(null);throw d}))),pt(u=>!!u),st(u=>{if(Hg(u))return WE(r,i,s)?$(new Ju):mr(r);throw u}))}processSegmentAgainstRoute(e,t,r,i,s,a,c,u){return vt(r)!==a&&(a===Y||!Vo(i,s,r))?mr(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,a,u):this.allowRedirects&&c?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,a,u):mr(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,a,c){let{matched:u,parameters:d,consumedSegments:p,positionalParamSegments:m,remainingSegments:w}=Qg(t,i,s);if(!u)return mr(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>KE&&(this.allowRedirects=!1));let A=new _r(s,d,Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,Cg(i),vt(i),i.component??i._loadedComponent??null,i,Ag(i)),P=No(A,c,this.paramsInheritanceStrategy);A.params=Object.freeze(P.params),A.data=Object.freeze(P.data);let k=this.applyRedirects.applyRedirectCommands(p,i.redirectTo,m,A,e);return this.applyRedirects.lineralizeSegments(i,k).pipe(it(S=>this.processSegment(e,r,t,S.concat(w),a,!1,c)))}matchSegmentAgainstRoute(e,t,r,i,s,a){let c=BE(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),c.pipe(ot(u=>u.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(ot(({routes:d})=>{let p=r._loadedInjector??e,{parameters:m,consumedSegments:w,remainingSegments:A}=u,P=new _r(w,m,Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,Cg(r),vt(r),r.component??r._loadedComponent??null,r,Ag(r)),k=No(P,a,this.paramsInheritanceStrategy);P.params=Object.freeze(k.params),P.data=Object.freeze(k.data);let{segmentGroup:S,slicedSegments:U}=bg(t,w,A,d);if(U.length===0&&S.hasChildren())return this.processChildren(p,d,S,P).pipe(H(L=>new Ye(P,L)));if(d.length===0&&U.length===0)return $(new Ye(P,[]));let q=vt(r)===s;return this.processSegment(p,d,S,U,q?Y:s,!0,P).pipe(H(L=>new Ye(P,L instanceof Ye?[L]:[])))}))):mr(t)))}getChildConfig(e,t,r){return t.children?$({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?$({routes:t._loadedRoutes,injector:t._loadedInjector}):FE(e,t,r,this.urlSerializer).pipe(it(i=>i?this.configLoader.loadChildren(e,t).pipe(Ie(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):UE(t))):$({routes:[],injector:e})}};function QE(n){n.sort((e,t)=>e.value.outlet===Y?-1:t.value.outlet===Y?1:e.value.outlet.localeCompare(t.value.outlet))}function YE(n){let e=n.value.routeConfig;return e&&e.path===""}function Yg(n){let e=[],t=new Set;for(let r of n){if(!YE(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=Yg(r.children);e.push(new Ye(r.value,i))}return e.filter(r=>!t.has(r))}function Cg(n){return n.data||{}}function Ag(n){return n.resolve||{}}function JE(n,e,t,r,i,s){return it(a=>HE(n,e,t,r,a.extractedUrl,i,s).pipe(H(({state:c,tree:u})=>Ae(V({},a),{targetSnapshot:c,urlAfterRedirects:u}))))}function XE(n,e){return it(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return $(t);let s=new Set(i.map(u=>u.route)),a=new Set;for(let u of s)if(!a.has(u))for(let d of Jg(u))a.add(d);let c=0;return He(a).pipe(Dn(u=>s.has(u)?ZE(u,r,n,e):(u.data=No(u,u.parent,n).resolve,$(void 0))),Ie(()=>c++),$c(1),it(u=>c===a.size?$(t):rn))})}function Jg(n){let e=n.children.map(t=>Jg(t)).flat();return[n,...e]}function ZE(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!zg(i)&&(s[Ji]=i.title),e0(s,n,e,r).pipe(H(a=>(n._resolvedData=a,n.data=No(n,n.parent,t).resolve,null)))}function e0(n,e,t,r){let i=Su(n);if(i.length===0)return $({});let s={};return He(i).pipe(it(a=>t0(n[a],e,t,r).pipe(pt(),Ie(c=>{if(c instanceof Ki)throw xo(new $i,c);s[a]=c}))),$c(1),Tp(s),st(a=>Hg(a)?rn:rt(a)))}function t0(n,e,t,r){let i=Xi(e)??r,s=Cr(n,i),a=s.resolve?s.resolve(e,t):mt(i,()=>s(e,t));return dn(a)}function Au(n){return ot(e=>{let t=n(e);return t?He(t).pipe(H(()=>e)):$(e)})}var Xg=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===Y);return r}getResolvedTitleForRoute(t){return t.data[Ji]}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=z({token:n,factory:()=>M(n0),providedIn:"root"})}}return n})(),n0=(()=>{class n extends Xg{constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||n)(Q(_g))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),il=new ce("",{providedIn:"root",factory:()=>({})}),r0=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=de({type:n,selectors:[["ng-component"]],standalone:!0,features:[fe],decls:1,vars:0,template:function(r,i){r&1&&he(0,"router-outlet")},dependencies:[nl],encapsulation:2})}}return n})();function sl(n){let e=n.children&&n.children.map(sl),t=e?Ae(V({},n),{children:e}):V({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==Y&&(t.component=r0),t}var ol=new ce(""),i0=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=M(su)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return $(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=dn(t.loadComponent()).pipe(H(Zg),Ie(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),sn(()=>{this.componentLoaders.delete(t)})),i=new Mc(r,()=>new ft).pipe(Nc());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return $({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=s0(r,this.compiler,t,this.onLoadEndListener).pipe(sn(()=>{this.childrenLoaders.delete(r)})),a=new Mc(s,()=>new ft).pipe(Nc());return this.childrenLoaders.set(r,a),a}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function s0(n,e,t,r){return dn(n.loadChildren()).pipe(H(Zg),it(i=>i instanceof Np||Array.isArray(i)?$(i):He(e.compileModuleAsync(i))),H(i=>{r&&r(n);let s,a,c=!1;return Array.isArray(i)?(a=i,c=!0):(s=i.create(t).injector,a=s.get(ol,[],{optional:!0,self:!0}).flat()),{routes:a.map(sl),injector:s}}))}function o0(n){return n&&typeof n=="object"&&"default"in n}function Zg(n){return o0(n)?n.default:n}var al=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=z({token:n,factory:()=>M(a0),providedIn:"root"})}}return n})(),a0=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),c0=new ce("");var u0=new ce(""),l0=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new ft,this.transitionAbortSubject=new ft,this.configLoader=M(i0),this.environmentInjector=M(or),this.urlSerializer=M(el),this.rootContexts=M(Lo),this.location=M(Ai),this.inputBindingEnabled=M(rl,{optional:!0})!==null,this.titleStrategy=M(Xg),this.options=M(il,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=M(al),this.createViewTransition=M(c0,{optional:!0}),this.navigationErrorHandler=M(u0,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>$(void 0),this.rootComponentType=null;let t=i=>this.events.next(new Lu(i)),r=i=>this.events.next(new Vu(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(Ae(V(V({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new nt({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Ui,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Vt(s=>s.id!==0),H(s=>Ae(V({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),ot(s=>{let a=!1,c=!1;return $(s).pipe(ot(u=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",Je.SupersededByNewNavigation),rn;this.currentTransition=s,this.currentNavigation={id:u.id,initialUrl:u.rawUrl,extractedUrl:u.extractedUrl,targetBrowserUrl:typeof u.extras.browserUrl=="string"?this.urlSerializer.parse(u.extras.browserUrl):u.extras.browserUrl,trigger:u.source,extras:u.extras,previousNavigation:this.lastSuccessfulNavigation?Ae(V({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),p=u.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!d&&p!=="reload"){let m="";return this.events.next(new Mn(u.id,this.urlSerializer.serialize(u.rawUrl),m,Ou.IgnoredSameUrlNavigation)),u.resolve(!1),rn}if(this.urlHandlingStrategy.shouldProcessUrl(u.rawUrl))return $(u).pipe(ot(m=>{let w=this.transitions?.getValue();return this.events.next(new qi(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),w!==this.transitions?.getValue()?rn:Promise.resolve(m)}),JE(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Ie(m=>{s.targetSnapshot=m.targetSnapshot,s.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation=Ae(V({},this.currentNavigation),{finalUrl:m.urlAfterRedirects});let w=new Po(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(w)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(u.currentRawUrl)){let{id:m,extractedUrl:w,source:A,restoredState:P,extras:k}=u,S=new qi(m,this.urlSerializer.serialize(w),A,P);this.events.next(S);let U=$g(this.rootComponentType).snapshot;return this.currentTransition=s=Ae(V({},u),{targetSnapshot:U,urlAfterRedirects:w,extras:Ae(V({},k),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=w,$(s)}else{let m="";return this.events.next(new Mn(u.id,this.urlSerializer.serialize(u.extractedUrl),m,Ou.IgnoredByUrlHandlingStrategy)),u.resolve(!1),rn}}),Ie(u=>{let d=new Nu(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),H(u=>(this.currentTransition=s=Ae(V({},u),{guards:yE(u.targetSnapshot,u.currentSnapshot,this.rootContexts)}),s)),SE(this.environmentInjector,u=>this.events.next(u)),Ie(u=>{if(s.guardsResult=u.guardsResult,u.guardsResult&&typeof u.guardsResult!="boolean")throw xo(this.urlSerializer,u.guardsResult);let d=new Mu(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot,!!u.guardsResult);this.events.next(d)}),Vt(u=>u.guardsResult?!0:(this.cancelNavigationTransition(u,"",Je.GuardRejected),!1)),Au(u=>{if(u.guards.canActivateChecks.length)return $(u).pipe(Ie(d=>{let p=new xu(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(p)}),ot(d=>{let p=!1;return $(d).pipe(XE(this.paramsInheritanceStrategy,this.environmentInjector),Ie({next:()=>p=!0,complete:()=>{p||this.cancelNavigationTransition(d,"",Je.NoDataFromResolver)}}))}),Ie(d=>{let p=new Fu(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(p)}))}),Au(u=>{let d=p=>{let m=[];p.routeConfig?.loadComponent&&!p.routeConfig._loadedComponent&&m.push(this.configLoader.loadComponent(p.routeConfig).pipe(Ie(w=>{p.component=w}),H(()=>{})));for(let w of p.children)m.push(...d(w));return m};return Vc(d(u.targetSnapshot.root)).pipe(Bc(null),ir(1))}),Au(()=>this.afterPreactivation()),ot(()=>{let{currentSnapshot:u,targetSnapshot:d}=s,p=this.createViewTransition?.(this.environmentInjector,u.root,d.root);return p?He(p).pipe(H(()=>s)):$(s)}),H(u=>{let d=dE(t.routeReuseStrategy,u.targetSnapshot,u.currentRouterState);return this.currentTransition=s=Ae(V({},u),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,s}),Ie(()=>{this.events.next(new Wi)}),mE(this.rootContexts,t.routeReuseStrategy,u=>this.events.next(u),this.inputBindingEnabled),ir(1),Ie({next:u=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Nn(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects))),this.titleStrategy?.updateTitle(u.targetRouterState.snapshot),u.resolve(!0)},complete:()=>{a=!0}}),sr(this.transitionAbortSubject.pipe(Ie(u=>{throw u}))),sn(()=>{!a&&!c&&this.cancelNavigationTransition(s,"",Je.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),st(u=>{if(c=!0,Wg(u))this.events.next(new jt(s.id,this.urlSerializer.serialize(s.extractedUrl),u.message,u.cancellationCode)),gE(u)?this.events.next(new Ir(u.url,u.navigationBehaviorOptions)):s.resolve(!1);else{let d=new Gi(s.id,this.urlSerializer.serialize(s.extractedUrl),u,s.targetSnapshot??void 0);try{let p=mt(this.environmentInjector,()=>this.navigationErrorHandler?.(d));if(p instanceof Ki){let{message:m,cancellationCode:w}=xo(this.urlSerializer,p);this.events.next(new jt(s.id,this.urlSerializer.serialize(s.extractedUrl),m,w)),this.events.next(new Ir(p.redirectTo,p.navigationBehaviorOptions))}else{this.events.next(d);let m=t.errorHandler(u);s.resolve(!!m)}}catch(p){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(p)}}return rn}))}))}cancelNavigationTransition(t,r,i){let s=new jt(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function h0(n){return n!==Ui}var d0=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=z({token:n,factory:()=>M(f0),providedIn:"root"})}}return n})(),Zu=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},f0=(()=>{class n extends Zu{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Wc(n)))(i||n)}})()}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),em=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=z({token:n,factory:()=>M(p0),providedIn:"root"})}}return n})(),p0=(()=>{class n extends em{constructor(){super(...arguments),this.location=M(Ai),this.urlSerializer=M(el),this.options=M(il,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=M(al),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new zt,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=$g(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof qi)this.stateMemento=this.createStateMemento();else if(t instanceof Mn)this.rawUrlTree=r.initialUrl;else if(t instanceof Po){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof Wi?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof jt&&(t.code===Je.GuardRejected||t.code===Je.NoDataFromResolver)?this.restoreHistory(r):t instanceof Gi?this.restoreHistory(r,!0):t instanceof Nn&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof zt?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let s=this.browserPageId,a=V(V({},r.extras.state),this.generateNgRouterState(r.id,s));this.location.replaceState(i,"",a)}else{let s=V(V({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",s)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=Wc(n)))(i||n)}})()}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),Li=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(Li||{});function g0(n,e){n.events.pipe(Vt(t=>t instanceof Nn||t instanceof jt||t instanceof Gi||t instanceof Mn),H(t=>t instanceof Nn||t instanceof Mn?Li.COMPLETE:(t instanceof jt?t.code===Je.Redirect||t.code===Je.SupersededByNewNavigation:!1)?Li.REDIRECTING:Li.FAILED),Vt(t=>t!==Li.REDIRECTING),ir(1)).subscribe(()=>{e()})}function m0(n){throw n}var y0={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},v0={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Uo=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=M(uo),this.stateManager=M(em),this.options=M(il,{optional:!0})||{},this.pendingTasks=M(so),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=M(l0),this.urlSerializer=M(el),this.location=M(Ai),this.urlHandlingStrategy=M(al),this._events=new ft,this.errorHandler=this.options.errorHandler||m0,this.navigated=!1,this.routeReuseStrategy=M(d0),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=M(ol,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!M(rl,{optional:!0}),this.eventsSubscription=new yp,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof jt&&r.code!==Je.Redirect&&r.code!==Je.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Nn)this.navigated=!0;else if(r instanceof Ir){let a=r.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),u=V({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||h0(i.source)},a);this.scheduleNavigation(c,Ui,null,u,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}w0(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Ui,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},a=i?.navigationId?i:null;if(i){let u=V({},i);delete u.navigationId,delete u.\u0275routerPageId,Object.keys(u).length!==0&&(s.state=u)}let c=this.parseUrl(t);this.scheduleNavigation(c,r,a,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(sl),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:a,queryParamsHandling:c,preserveFragment:u}=r,d=u?this.currentUrlTree.fragment:a,p=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":p=V(V({},this.currentUrlTree.queryParams),s);break;case"preserve":p=this.currentUrlTree.queryParams;break;default:p=s||null}p!==null&&(p=this.removeEmptyProps(p));let m;try{let w=i?i.snapshot:this.routerState.snapshot.root;m=Lg(w)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),m=this.currentUrlTree.root}return Vg(m,t,p,d??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=ji(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Ui,null,r)}navigate(t,r={skipLocationChange:!1}){return _0(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=V({},y0):r===!1?i=V({},v0):i=r,ji(t))return wg(this.currentUrlTree,t,i);let s=this.parseUrl(t);return wg(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,a){if(this.disposed)return Promise.resolve(!1);let c,u,d;a?(c=a.resolve,u=a.reject,d=a.promise):d=new Promise((m,w)=>{c=m,u=w});let p=this.pendingTasks.add();return g0(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(p))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:c,reject:u,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(m=>Promise.reject(m))}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function _0(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new we(4008,!1)}function w0(n){return!(n instanceof Wi)&&!(n instanceof Ir)}var E0=new ce("");function tm(n,...e){return gt([{provide:ol,multi:!0,useValue:n},[],{provide:Tr,useFactory:I0,deps:[Uo]},{provide:iu,multi:!0,useFactory:T0},e.map(t=>t.\u0275providers)])}function I0(n){return n.routerState.root}function T0(){let n=M(Sn);return e=>{let t=n.get(lo);if(e!==t.components[0])return;let r=n.get(Uo),i=n.get(b0);n.get(C0)===1&&r.initialNavigation(),n.get(A0,null,qc.Optional)?.setUpPreloading(),n.get(E0,null,qc.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var b0=new ce("",{factory:()=>new ft}),C0=new ce("",{providedIn:"root",factory:()=>1});var A0=new ce("");var rm=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},D0=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],a=n[t++],c=n[t++],u=((i&7)<<18|(s&63)<<12|(a&63)<<6|c&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{let s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},im={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],a=i+1<n.length,c=a?n[i+1]:0,u=i+2<n.length,d=u?n[i+2]:0,p=s>>2,m=(s&3)<<4|c>>4,w=(c&15)<<2|d>>6,A=d&63;u||(A=64,a||(w=64)),r.push(t[p],t[m],t[w],t[A])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(rm(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):D0(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],c=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||c==null||d==null||m==null)throw new ul;let w=s<<2|c>>4;if(r.push(w),d!==64){let A=c<<4&240|d>>2;if(r.push(A),m!==64){let P=d<<6&192|m;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},ul=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},S0=function(n){let e=rm(n);return im.encodeByteArray(e,!0)},es=function(n){return S0(n).replace(/\./g,"")},hl=function(n){try{return im.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function R0(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var P0=()=>R0().__FIREBASE_DEFAULTS__,k0=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},O0=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&hl(n[1]);return e&&JSON.parse(e)},$o=()=>{try{return P0()||k0()||O0()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},sm=n=>{var e,t;return(t=(e=$o())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},om=n=>{let e=sm(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},dl=()=>{var n;return(n=$o())===null||n===void 0?void 0:n.config},am=n=>{var e;return(e=$o())===null||e===void 0?void 0:e[`_${n}`]};var Bo=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function cm(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[es(JSON.stringify(t)),es(JSON.stringify(a)),""].join(".")}function Xe(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function um(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xe())}function N0(){var n;let e=(n=$o())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function lm(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function hm(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function dm(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function fm(){return!N0()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function fl(){try{return typeof indexedDB=="object"}catch{return!1}}function pm(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var M0="FirebaseError",ut=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=M0,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,qt.prototype.create)}},qt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?x0(s,r):"Error",c=`${this.serviceName}: ${a} (${i}).`;return new ut(i,c,r)}};function x0(n,e){return n.replace(F0,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var F0=/\{\$([^}]+)}/g;function Ar(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],a=e[i];if(nm(s)&&nm(a)){if(!Ar(s,a))return!1}else if(s!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function nm(n){return n!==null&&typeof n=="object"}function pl(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function gm(n,e){let t=new ll(n,e);return t.subscribe.bind(t)}var ll=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");L0(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=cl),i.error===void 0&&(i.error=cl),i.complete===void 0&&(i.complete=cl);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function L0(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function cl(){}var HS=4*60*60*1e3;function Me(n){return n&&n._delegate?n._delegate:n}var lt=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var xn="[DEFAULT]";var gl=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Bo;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(U0(e))try{this.getOrInitializeService({instanceIdentifier:xn})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=xn){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return C(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=xn){return this.instances.has(e)}getOptions(e=xn){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,a]of this.instancesDeferred.entries()){let c=this.normalizeInstanceIdentifier(s);r===c&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:V0(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=xn){return this.component?this.component.multipleInstances?e:xn:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function V0(n){return n===xn?void 0:n}function U0(n){return n.instantiationMode==="EAGER"}var jo=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new gl(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var B0=[],X=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(X||{}),$0={debug:X.DEBUG,verbose:X.VERBOSE,info:X.INFO,warn:X.WARN,error:X.ERROR,silent:X.SILENT},j0=X.INFO,z0={[X.DEBUG]:"log",[X.VERBOSE]:"log",[X.INFO]:"info",[X.WARN]:"warn",[X.ERROR]:"error"},q0=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=z0[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},fn=class{constructor(e){this.name=e,this._logLevel=j0,this._logHandler=q0,this._userLogHandler=null,B0.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in X))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?$0[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,X.DEBUG,...e),this._logHandler(this,X.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,X.VERBOSE,...e),this._logHandler(this,X.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,X.INFO,...e),this._logHandler(this,X.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,X.WARN,...e),this._logHandler(this,X.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,X.ERROR,...e),this._logHandler(this,X.ERROR,...e)}};var G0=(n,e)=>e.some(t=>n instanceof t),mm,ym;function W0(){return mm||(mm=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function H0(){return ym||(ym=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var vm=new WeakMap,yl=new WeakMap,_m=new WeakMap,ml=new WeakMap,_l=new WeakMap;function K0(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(Dt(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&vm.set(t,n)}).catch(()=>{}),_l.set(e,n),e}function Q0(n){if(yl.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});yl.set(n,e)}var vl={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return yl.get(n);if(e==="objectStoreNames")return n.objectStoreNames||_m.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Dt(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function wm(n){vl=n(vl)}function Y0(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(zo(this),e,...t);return _m.set(r,e.sort?e.sort():[e]),Dt(r)}:H0().includes(n)?function(...e){return n.apply(zo(this),e),Dt(vm.get(this))}:function(...e){return Dt(n.apply(zo(this),e))}}function J0(n){return typeof n=="function"?Y0(n):(n instanceof IDBTransaction&&Q0(n),G0(n,W0())?new Proxy(n,vl):n)}function Dt(n){if(n instanceof IDBRequest)return K0(n);if(ml.has(n))return ml.get(n);let e=J0(n);return e!==n&&(ml.set(n,e),_l.set(e,n)),e}var zo=n=>_l.get(n);function Im(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(n,e),c=Dt(a);return r&&a.addEventListener("upgradeneeded",u=>{r(Dt(a.result),u.oldVersion,u.newVersion,Dt(a.transaction),u)}),t&&a.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),c.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),c}var X0=["get","getKey","getAll","getAllKeys","count"],Z0=["put","add","delete","clear"],wl=new Map;function Em(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(wl.get(e))return wl.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=Z0.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||X0.includes(t)))return;let s=function(a,...c){return C(this,null,function*(){let u=this.transaction(a,i?"readwrite":"readonly"),d=u.store;return r&&(d=d.index(c.shift())),(yield Promise.all([d[t](...c),i&&u.done]))[0]})};return wl.set(e,s),s}wm(n=>Ae(V({},n),{get:(e,t,r)=>Em(e,t)||n.get(e,t,r),has:(e,t)=>!!Em(e,t)||n.has(e,t)}));var Il=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(eI(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function eI(n){let e=n.getComponent();return e?.type==="VERSION"}var Tl="@firebase/app",Tm="0.10.13";var Gt=new fn("@firebase/app"),tI="@firebase/app-compat",nI="@firebase/analytics-compat",rI="@firebase/analytics",iI="@firebase/app-check-compat",sI="@firebase/app-check",oI="@firebase/auth",aI="@firebase/auth-compat",cI="@firebase/database",uI="@firebase/data-connect",lI="@firebase/database-compat",hI="@firebase/functions",dI="@firebase/functions-compat",fI="@firebase/installations",pI="@firebase/installations-compat",gI="@firebase/messaging",mI="@firebase/messaging-compat",yI="@firebase/performance",vI="@firebase/performance-compat",_I="@firebase/remote-config",wI="@firebase/remote-config-compat",EI="@firebase/storage",II="@firebase/storage-compat",TI="@firebase/firestore",bI="@firebase/vertexai-preview",CI="@firebase/firestore-compat",AI="firebase",DI="10.14.1";var bl="[DEFAULT]",SI={[Tl]:"fire-core",[tI]:"fire-core-compat",[rI]:"fire-analytics",[nI]:"fire-analytics-compat",[sI]:"fire-app-check",[iI]:"fire-app-check-compat",[oI]:"fire-auth",[aI]:"fire-auth-compat",[cI]:"fire-rtdb",[uI]:"fire-data-connect",[lI]:"fire-rtdb-compat",[hI]:"fire-fn",[dI]:"fire-fn-compat",[fI]:"fire-iid",[pI]:"fire-iid-compat",[gI]:"fire-fcm",[mI]:"fire-fcm-compat",[yI]:"fire-perf",[vI]:"fire-perf-compat",[_I]:"fire-rc",[wI]:"fire-rc-compat",[EI]:"fire-gcs",[II]:"fire-gcs-compat",[TI]:"fire-fst",[CI]:"fire-fst-compat",[bI]:"fire-vertex","fire-js":"fire-js",[AI]:"fire-js-all"};var ts=new Map,RI=new Map,Cl=new Map;function bm(n,e){try{n.container.addComponent(e)}catch(t){Gt.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function gn(n){let e=n.name;if(Cl.has(e))return Gt.debug(`There were multiple attempts to register component ${e}.`),!1;Cl.set(e,n);for(let t of ts.values())bm(t,n);for(let t of RI.values())bm(t,n);return!0}function Rl(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function Dr(n){return n.settings!==void 0}var PI={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},pn=new qt("app","Firebase",PI);var Al=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new lt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw pn.create("app-deleted",{appName:this._name})}};var Sr=DI;function Pl(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:bl,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw pn.create("bad-app-name",{appName:String(i)});if(t||(t=dl()),!t)throw pn.create("no-options");let s=ts.get(i);if(s){if(Ar(t,s.options)&&Ar(r,s.config))return s;throw pn.create("duplicate-app",{appName:i})}let a=new jo(i);for(let u of Cl.values())a.addComponent(u);let c=new Al(t,r,a);return ts.set(i,c),c}function rs(n=bl){let e=ts.get(n);if(!e&&n===bl&&dl())return Pl();if(!e)throw pn.create("no-app",{appName:n});return e}function qo(){return Array.from(ts.values())}function Re(n,e,t){var r;let i=(r=SI[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let c=[`Unable to register library "${i}" with version "${e}":`];s&&c.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&c.push("and"),a&&c.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Gt.warn(c.join(" "));return}gn(new lt(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var kI="firebase-heartbeat-database",OI=1,ns="firebase-heartbeat-store",El=null;function Sm(){return El||(El=Im(kI,OI,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(ns)}catch(t){console.warn(t)}}}}).catch(n=>{throw pn.create("idb-open",{originalErrorMessage:n.message})})),El}function NI(n){return C(this,null,function*(){try{let t=(yield Sm()).transaction(ns),r=yield t.objectStore(ns).get(Rm(n));return yield t.done,r}catch(e){if(e instanceof ut)Gt.warn(e.message);else{let t=pn.create("idb-get",{originalErrorMessage:e?.message});Gt.warn(t.message)}}})}function Cm(n,e){return C(this,null,function*(){try{let r=(yield Sm()).transaction(ns,"readwrite");yield r.objectStore(ns).put(e,Rm(n)),yield r.done}catch(t){if(t instanceof ut)Gt.warn(t.message);else{let r=pn.create("idb-set",{originalErrorMessage:t?.message});Gt.warn(r.message)}}})}function Rm(n){return`${n.name}!${n.options.appId}`}var MI=1024,xI=30*24*60*60*1e3,Dl=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Sl(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return C(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=Am();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let c=new Date(a.date).valueOf();return Date.now()-c<=xI}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Gt.warn(r)}})}getHeartbeatsHeader(){return C(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=Am(),{heartbeatsToSend:r,unsentEntries:i}=FI(this._heartbeatsCache.heartbeats),s=es(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Gt.warn(t),""}})}};function Am(){return new Date().toISOString().substring(0,10)}function FI(n,e=MI){let t=[],r=n.slice();for(let i of n){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),Dm(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),Dm(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Sl=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return C(this,null,function*(){return fl()?pm().then(()=>!0).catch(()=>!1):!1})}read(){return C(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield NI(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return C(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Cm(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return C(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return Cm(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function Dm(n){return es(JSON.stringify({version:2,heartbeats:n})).length}function LI(n){gn(new lt("platform-logger",e=>new Il(e),"PRIVATE")),gn(new lt("heartbeat",e=>new Dl(e),"PRIVATE")),Re(Tl,Tm,n),Re(Tl,Tm,"esm2017"),Re("fire-js","")}LI("");var VI="firebase",UI="10.14.1";Re(VI,UI,"app");var Pr=new bi("ANGULARFIRE2_VERSION");function Ol(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var ss=(n,e)=>{let t=e?[e]:qo(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},is=class{constructor(){return ss(BI)}},BI="app-check";function Rr(){}var Go=class{zone;delegate;constructor(e,t=_p){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(s,t,r)}},kl=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Rr,{},Rr,Rr)),t.pipe(Ie({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},os=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Go(Zone.current)),this.insideAngular=t.run(()=>new Go(Zone.current,vp)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(Q(We))};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Wo(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function $I(n){return Wo().ngZone.runOutsideAngular(()=>n())}function Fn(n){return Wo().ngZone.run(()=>n())}function jI(n){return zI(Wo())(n)}function zI(n){return function(t){return t=t.lift(new kl(n.ngZone)),t.pipe(Lc(n.outsideAngular),Fc(n.insideAngular))}}var qI=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),Fn(()=>n.apply(void 0,r))},_t=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=Fn(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Rr,{},Rr,Rr))),r[s]=qI(r[s],t));let i=$I(()=>n.apply(this,r));if(!e)if(i instanceof nn){let s=Wo();return i.pipe(Lc(s.outsideAngular),Fc(s.insideAngular))}else return Fn(()=>i);return i instanceof nn?i.pipe(jI):i instanceof Promise?Fn(()=>new Promise((s,a)=>i.then(c=>Fn(()=>s(c)),c=>Fn(()=>a(c))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:Fn(()=>i)};var Ln=class{constructor(e){return e}},as=class{constructor(){return qo()}};function GI(n){return n&&n.length===1?n[0]:new Ln(rs())}var Nl=new ce("angularfire2._apps"),WI={provide:Ln,useFactory:GI,deps:[[new at,Nl]]},HI={provide:as,deps:[[new at,Nl]]};function KI(n){return(e,t)=>{let r=t.get(Tt);Re("angularfire",Pr.full,"core"),Re("angularfire",Pr.full,"app"),Re("angular",$p.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new Ln(i)}}function Pm(n,...e){return gt([WI,HI,{provide:Nl,useFactory:KI(n),multi:!0,deps:[We,Sn,os,...e]}])}var km=_t(Pl,!0);function Um(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var Bm=Um,$m=new qt("auth","Firebase",Um());var Yo=new fn("@firebase/auth");function YI(n,...e){Yo.logLevel<=X.WARN&&Yo.warn(`Auth (${Sr}): ${n}`,...e)}function Ko(n,...e){Yo.logLevel<=X.ERROR&&Yo.error(`Auth (${Sr}): ${n}`,...e)}function Om(n,...e){throw Gl(n,...e)}function ql(n,...e){return Gl(n,...e)}function jm(n,e,t){let r=Object.assign(Object.assign({},Bm()),{[e]:t});return new qt("auth","Firebase",r).create(e,{appName:n.name})}function Qo(n){return jm(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Gl(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return $m.create(n,...e)}function oe(n,e,...t){if(!n)throw Gl(e,...t)}function cs(n){let e="INTERNAL ASSERTION FAILED: "+n;throw Ko(e),new Error(e)}function Jo(n,e){n||cs(e)}function JI(){return Nm()==="http:"||Nm()==="https:"}function Nm(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function XI(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(JI()||hm()||"connection"in navigator)?navigator.onLine:!0}function ZI(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var Un=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,Jo(t>e,"Short delay should be less than long delay!"),this.isMobile=um()||dm()}get(){return XI()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function eT(n,e){Jo(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var Xo=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;cs("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;cs("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;cs("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var tT={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var nT=new Un(3e4,6e4);function zm(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function na(s,a,c,u){return C(this,arguments,function*(n,e,t,r,i={}){return qm(n,i,()=>C(this,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let m=pl(Object.assign({key:n.config.apiKey},p)).slice(1),w=yield n._getAdditionalHeaders();w["Content-Type"]="application/json",n.languageCode&&(w["X-Firebase-Locale"]=n.languageCode);let A=Object.assign({method:e,headers:w},d);return lm()||(A.referrerPolicy="no-referrer"),Xo.fetch()(Gm(n,n.config.apiHost,t,m),A)}))})}function qm(n,e,t){return C(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},tT),e);try{let i=new Fl(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw Ho(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let c=s.ok?a.errorMessage:a.error.message,[u,d]=c.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ho(n,"credential-already-in-use",a);if(u==="EMAIL_EXISTS")throw Ho(n,"email-already-in-use",a);if(u==="USER_DISABLED")throw Ho(n,"user-disabled",a);let p=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw jm(n,p,d);Om(n,p)}}catch(i){if(i instanceof ut)throw i;Om(n,"network-request-failed",{message:String(i)})}})}function Gm(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?eT(n.config,i):`${n.config.apiScheme}://${i}`}var Fl=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(ql(this.auth,"network-request-failed")),nT.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Ho(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=ql(n,e,r);return i.customData._tokenResponse=t,i}function rT(n,e){return C(this,null,function*(){return na(n,"POST","/v1/accounts:delete",e)})}function Wm(n,e){return C(this,null,function*(){return na(n,"POST","/v1/accounts:lookup",e)})}function us(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function Wl(n,e=!1){return C(this,null,function*(){let t=Me(n),r=yield t.getIdToken(e),i=Hm(r);oe(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:us(Ml(i.auth_time)),issuedAtTime:us(Ml(i.iat)),expirationTime:us(Ml(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function Ml(n){return Number(n)*1e3}function Hm(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Ko("JWT malformed, contained fewer than 3 sections"),null;try{let i=hl(t);return i?JSON.parse(i):(Ko("Failed to decode base64 JWT payload"),null)}catch(i){return Ko("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Mm(n){let e=Hm(n);return oe(e,"internal-error"),oe(typeof e.exp<"u","internal-error"),oe(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function Ll(n,e,t=!1){return C(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof ut&&iT(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function iT({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var Vl=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>C(this,null,function*(){yield this.iteration()}),t)}iteration(){return C(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var hs=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=us(this.lastLoginAt),this.creationTime=us(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function Zo(n){return C(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield Ll(n,Wm(t,{idToken:r}));oe(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Km(s.providerUserInfo):[],c=sT(n.providerData,a),u=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!c?.length,p=u?d:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:c,metadata:new hs(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,m)})}function Hl(n){return C(this,null,function*(){let e=Me(n);yield Zo(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function sT(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function Km(n){return n.map(e=>{var{providerId:t}=e,r=xc(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function oT(n,e){return C(this,null,function*(){let t=yield qm(n,{},()=>C(this,null,function*(){let r=pl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=Gm(n,i,"/v1/token",`key=${s}`),c=yield n._getAdditionalHeaders();return c["Content-Type"]="application/x-www-form-urlencoded",Xo.fetch()(a,{method:"POST",headers:c,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function aT(n,e){return C(this,null,function*(){return na(n,"POST","/v2/accounts:revokeToken",zm(n,e))})}var ls=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){oe(e.idToken,"internal-error"),oe(typeof e.idToken<"u","internal-error"),oe(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Mm(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){oe(e.length!==0,"internal-error");let t=Mm(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return C(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(oe(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return C(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield oT(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new n;return r&&(oe(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(oe(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(oe(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return cs("not implemented")}};function mn(n,e){oe(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var ds=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=xc(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Vl(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new hs(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return C(this,null,function*(){let t=yield Ll(this,this.stsTokenManager.getToken(this.auth,e));return oe(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return Wl(this,e)}reload(){return Hl(this)}_assign(e){this!==e&&(oe(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){oe(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return C(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield Zo(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return C(this,null,function*(){if(Dr(this.auth.app))return Promise.reject(Qo(this.auth));let e=yield this.getIdToken();return yield Ll(this,rT(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,c,u,d,p;let m=(r=t.displayName)!==null&&r!==void 0?r:void 0,w=(i=t.email)!==null&&i!==void 0?i:void 0,A=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,P=(a=t.photoURL)!==null&&a!==void 0?a:void 0,k=(c=t.tenantId)!==null&&c!==void 0?c:void 0,S=(u=t._redirectEventId)!==null&&u!==void 0?u:void 0,U=(d=t.createdAt)!==null&&d!==void 0?d:void 0,q=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:L,emailVerified:se,isAnonymous:ye,providerData:ee,stsTokenManager:E}=t;oe(L&&E,e,"internal-error");let g=ls.fromJSON(this.name,E);oe(typeof L=="string",e,"internal-error"),mn(m,e.name),mn(w,e.name),oe(typeof se=="boolean",e,"internal-error"),oe(typeof ye=="boolean",e,"internal-error"),mn(A,e.name),mn(P,e.name),mn(k,e.name),mn(S,e.name),mn(U,e.name),mn(q,e.name);let v=new n({uid:L,auth:e,email:w,emailVerified:se,displayName:m,isAnonymous:ye,photoURL:P,phoneNumber:A,tenantId:k,stsTokenManager:g,createdAt:U,lastLoginAt:q});return ee&&Array.isArray(ee)&&(v.providerData=ee.map(_=>Object.assign({},_))),S&&(v._redirectEventId=S),v}static _fromIdTokenResponse(e,t,r=!1){return C(this,null,function*(){let i=new ls;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield Zo(s),s})}static _fromGetAccountInfoResponse(e,t,r){return C(this,null,function*(){let i=t.users[0];oe(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?Km(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,c=new ls;c.updateFromIdToken(r);let u=new n({uid:i.localId,auth:e,stsTokenManager:c,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new hs(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(u,d),u})}};var xm=new Map;function Vn(n){Jo(n instanceof Function,"Expected a class definition");let e=xm.get(n);return e?(Jo(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,xm.set(n,e),e)}var cT=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return C(this,null,function*(){return!0})}_set(t,r){return C(this,null,function*(){this.storage[t]=r})}_get(t){return C(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return C(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),Ul=cT;function xl(n,e,t){return`firebase:${n}:${e}:${t}`}var ea=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=xl(this.userKey,i.apiKey,s),this.fullPersistenceKey=xl("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return C(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?ds._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return C(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return C(this,null,function*(){if(!t.length)return new n(Vn(Ul),e,r);let i=(yield Promise.all(t.map(d=>C(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),s=i[0]||Vn(Ul),a=xl(r,e.config.apiKey,e.name),c=null;for(let d of t)try{let p=yield d._get(a);if(p){let m=ds._fromJSON(e,p);d!==s&&(c=m),s=d;break}}catch{}let u=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new n(s,e,r):(s=u[0],c&&(yield s._set(a,c.toJSON())),yield Promise.all(t.map(d=>C(this,null,function*(){if(d!==s)try{yield d._remove(a)}catch{}}))),new n(s,e,r))})}};function Fm(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(dT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(uT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(pT(e))return"Blackberry";if(gT(e))return"Webos";if(lT(e))return"Safari";if((e.includes("chrome/")||hT(e))&&!e.includes("edge/"))return"Chrome";if(fT(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function uT(n=Xe()){return/firefox\//i.test(n)}function lT(n=Xe()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function hT(n=Xe()){return/crios\//i.test(n)}function dT(n=Xe()){return/iemobile/i.test(n)}function fT(n=Xe()){return/android/i.test(n)}function pT(n=Xe()){return/blackberry/i.test(n)}function gT(n=Xe()){return/webos/i.test(n)}function Qm(n,e=[]){let t;switch(n){case"Browser":t=Fm(Xe());break;case"Worker":t=`${Fm(Xe())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Sr}/${r}`}var Bl=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((a,c)=>{try{let u=e(s);a(u)}catch(u){c(u)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return C(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function mT(t){return C(this,arguments,function*(n,e={}){return na(n,"GET","/v2/passwordPolicy",zm(n,e))})}var yT=6,$l=class{constructor(e){var t,r,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:yT,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,c;let u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(t=u.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(s=u.containsUppercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(a=u.containsNumericCharacter)!==null&&a!==void 0?a:!0),u.isValid&&(u.isValid=(c=u.containsNonAlphanumericCharacter)!==null&&c!==void 0?c:!0),u}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var jl=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ta(this),this.idTokenSubscription=new ta(this),this.beforeStateQueue=new Bl(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$m,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Vn(t)),this._initializationPromise=this.queue(()=>C(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield ea.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return C(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return C(this,null,function*(){try{let t=yield Wm(this,{idToken:e}),r=yield ds._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return C(this,null,function*(){var t;if(Dr(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(c=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(c,c))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,c=i?._redirectEventId,u=yield this.tryRedirectSignIn(e);(!a||a===c)&&u?.user&&(i=u.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return oe(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return C(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return C(this,null,function*(){try{yield Zo(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=ZI()}_delete(){return C(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return C(this,null,function*(){if(Dr(this.app))return Promise.reject(Qo(this));let t=e?Me(e):null;return t&&oe(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return C(this,null,function*(){if(!this._deleted)return e&&oe(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>C(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return C(this,null,function*(){return Dr(this.app)?Promise.reject(Qo(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return Dr(this.app)?Promise.reject(Qo(this)):this.queue(()=>C(this,null,function*(){yield this.assertedPersistence.setPersistence(Vn(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return C(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return C(this,null,function*(){let e=yield mT(this),t=new $l(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new qt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return C(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield aT(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return C(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return C(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&Vn(e)||this._popupRedirectResolver;oe(t,this,"argument-error"),this.redirectPersistenceManager=yield ea.create(this,[Vn(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return C(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>C(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return C(this,null,function*(){if(e===this.currentUser)return this.queue(()=>C(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,c=this._isInitialized?Promise.resolve():this._initializationPromise;if(oe(c,this,"internal-error"),c.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let u=e.addObserver(t,r,i);return()=>{a=!0,u()}}else{let u=e.addObserver(t);return()=>{a=!0,u()}}}directlySetCurrentUser(e){return C(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return oe(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Qm(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return C(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return C(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&YI(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function vT(n){return Me(n)}var ta=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=gm(t=>this.observer=t)}get next(){return oe(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var _T={loadJS(){return C(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function wT(n){_T=n}function ET(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function IT(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(Vn);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}var qR=ET("rcb"),GR=new Un(3e4,6e4);var WR=new Un(2e3,1e4);var HR=10*60*1e3;var KR=new Un(3e4,6e4);var QR=new Un(5e3,15e3);var YR=encodeURIComponent("fac");var Lm="@firebase/auth",Vm="1.7.9";var zl=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return C(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){oe(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function TT(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function bT(n){gn(new lt("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:c}=r.options;oe(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let u={apiKey:a,authDomain:c,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Qm(n)},d=new jl(r,i,s,u);return IT(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),gn(new lt("auth-internal",e=>{let t=vT(e.getProvider("auth").getImmediate());return(r=>new zl(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Re(Lm,Vm,TT(n)),Re(Lm,Vm,"esm2017")}var CT=5*60,JR=am("authIdTokenMaxAge")||CT;function AT(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}wT({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=ql("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",AT().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});bT("Browser");var Cb="auth";var ra=class{constructor(){return ss(Cb)}};var Ym=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Jm={};var yn,Kl;(function(){var n;function e(E,g){function v(){}v.prototype=g.prototype,E.D=g.prototype,E.prototype=new v,E.prototype.constructor=E,E.C=function(_,I,b){for(var y=Array(arguments.length-2),xt=2;xt<arguments.length;xt++)y[xt-2]=arguments[xt];return g.prototype[I].apply(_,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,g,v){v||(v=0);var _=Array(16);if(typeof g=="string")for(var I=0;16>I;++I)_[I]=g.charCodeAt(v++)|g.charCodeAt(v++)<<8|g.charCodeAt(v++)<<16|g.charCodeAt(v++)<<24;else for(I=0;16>I;++I)_[I]=g[v++]|g[v++]<<8|g[v++]<<16|g[v++]<<24;g=E.g[0],v=E.g[1],I=E.g[2];var b=E.g[3],y=g+(b^v&(I^b))+_[0]+3614090360&4294967295;g=v+(y<<7&4294967295|y>>>25),y=b+(I^g&(v^I))+_[1]+3905402710&4294967295,b=g+(y<<12&4294967295|y>>>20),y=I+(v^b&(g^v))+_[2]+606105819&4294967295,I=b+(y<<17&4294967295|y>>>15),y=v+(g^I&(b^g))+_[3]+3250441966&4294967295,v=I+(y<<22&4294967295|y>>>10),y=g+(b^v&(I^b))+_[4]+4118548399&4294967295,g=v+(y<<7&4294967295|y>>>25),y=b+(I^g&(v^I))+_[5]+1200080426&4294967295,b=g+(y<<12&4294967295|y>>>20),y=I+(v^b&(g^v))+_[6]+2821735955&4294967295,I=b+(y<<17&4294967295|y>>>15),y=v+(g^I&(b^g))+_[7]+4249261313&4294967295,v=I+(y<<22&4294967295|y>>>10),y=g+(b^v&(I^b))+_[8]+1770035416&4294967295,g=v+(y<<7&4294967295|y>>>25),y=b+(I^g&(v^I))+_[9]+2336552879&4294967295,b=g+(y<<12&4294967295|y>>>20),y=I+(v^b&(g^v))+_[10]+4294925233&4294967295,I=b+(y<<17&4294967295|y>>>15),y=v+(g^I&(b^g))+_[11]+2304563134&4294967295,v=I+(y<<22&4294967295|y>>>10),y=g+(b^v&(I^b))+_[12]+1804603682&4294967295,g=v+(y<<7&4294967295|y>>>25),y=b+(I^g&(v^I))+_[13]+4254626195&4294967295,b=g+(y<<12&4294967295|y>>>20),y=I+(v^b&(g^v))+_[14]+2792965006&4294967295,I=b+(y<<17&4294967295|y>>>15),y=v+(g^I&(b^g))+_[15]+1236535329&4294967295,v=I+(y<<22&4294967295|y>>>10),y=g+(I^b&(v^I))+_[1]+4129170786&4294967295,g=v+(y<<5&4294967295|y>>>27),y=b+(v^I&(g^v))+_[6]+3225465664&4294967295,b=g+(y<<9&4294967295|y>>>23),y=I+(g^v&(b^g))+_[11]+643717713&4294967295,I=b+(y<<14&4294967295|y>>>18),y=v+(b^g&(I^b))+_[0]+3921069994&4294967295,v=I+(y<<20&4294967295|y>>>12),y=g+(I^b&(v^I))+_[5]+3593408605&4294967295,g=v+(y<<5&4294967295|y>>>27),y=b+(v^I&(g^v))+_[10]+38016083&4294967295,b=g+(y<<9&4294967295|y>>>23),y=I+(g^v&(b^g))+_[15]+3634488961&4294967295,I=b+(y<<14&4294967295|y>>>18),y=v+(b^g&(I^b))+_[4]+3889429448&4294967295,v=I+(y<<20&4294967295|y>>>12),y=g+(I^b&(v^I))+_[9]+568446438&4294967295,g=v+(y<<5&4294967295|y>>>27),y=b+(v^I&(g^v))+_[14]+3275163606&4294967295,b=g+(y<<9&4294967295|y>>>23),y=I+(g^v&(b^g))+_[3]+4107603335&4294967295,I=b+(y<<14&4294967295|y>>>18),y=v+(b^g&(I^b))+_[8]+1163531501&4294967295,v=I+(y<<20&4294967295|y>>>12),y=g+(I^b&(v^I))+_[13]+2850285829&4294967295,g=v+(y<<5&4294967295|y>>>27),y=b+(v^I&(g^v))+_[2]+4243563512&4294967295,b=g+(y<<9&4294967295|y>>>23),y=I+(g^v&(b^g))+_[7]+1735328473&4294967295,I=b+(y<<14&4294967295|y>>>18),y=v+(b^g&(I^b))+_[12]+2368359562&4294967295,v=I+(y<<20&4294967295|y>>>12),y=g+(v^I^b)+_[5]+4294588738&4294967295,g=v+(y<<4&4294967295|y>>>28),y=b+(g^v^I)+_[8]+2272392833&4294967295,b=g+(y<<11&4294967295|y>>>21),y=I+(b^g^v)+_[11]+1839030562&4294967295,I=b+(y<<16&4294967295|y>>>16),y=v+(I^b^g)+_[14]+4259657740&4294967295,v=I+(y<<23&4294967295|y>>>9),y=g+(v^I^b)+_[1]+2763975236&4294967295,g=v+(y<<4&4294967295|y>>>28),y=b+(g^v^I)+_[4]+1272893353&4294967295,b=g+(y<<11&4294967295|y>>>21),y=I+(b^g^v)+_[7]+4139469664&4294967295,I=b+(y<<16&4294967295|y>>>16),y=v+(I^b^g)+_[10]+3200236656&4294967295,v=I+(y<<23&4294967295|y>>>9),y=g+(v^I^b)+_[13]+681279174&4294967295,g=v+(y<<4&4294967295|y>>>28),y=b+(g^v^I)+_[0]+3936430074&4294967295,b=g+(y<<11&4294967295|y>>>21),y=I+(b^g^v)+_[3]+3572445317&4294967295,I=b+(y<<16&4294967295|y>>>16),y=v+(I^b^g)+_[6]+76029189&4294967295,v=I+(y<<23&4294967295|y>>>9),y=g+(v^I^b)+_[9]+3654602809&4294967295,g=v+(y<<4&4294967295|y>>>28),y=b+(g^v^I)+_[12]+3873151461&4294967295,b=g+(y<<11&4294967295|y>>>21),y=I+(b^g^v)+_[15]+530742520&4294967295,I=b+(y<<16&4294967295|y>>>16),y=v+(I^b^g)+_[2]+3299628645&4294967295,v=I+(y<<23&4294967295|y>>>9),y=g+(I^(v|~b))+_[0]+4096336452&4294967295,g=v+(y<<6&4294967295|y>>>26),y=b+(v^(g|~I))+_[7]+1126891415&4294967295,b=g+(y<<10&4294967295|y>>>22),y=I+(g^(b|~v))+_[14]+2878612391&4294967295,I=b+(y<<15&4294967295|y>>>17),y=v+(b^(I|~g))+_[5]+4237533241&4294967295,v=I+(y<<21&4294967295|y>>>11),y=g+(I^(v|~b))+_[12]+1700485571&4294967295,g=v+(y<<6&4294967295|y>>>26),y=b+(v^(g|~I))+_[3]+2399980690&4294967295,b=g+(y<<10&4294967295|y>>>22),y=I+(g^(b|~v))+_[10]+4293915773&4294967295,I=b+(y<<15&4294967295|y>>>17),y=v+(b^(I|~g))+_[1]+2240044497&4294967295,v=I+(y<<21&4294967295|y>>>11),y=g+(I^(v|~b))+_[8]+1873313359&4294967295,g=v+(y<<6&4294967295|y>>>26),y=b+(v^(g|~I))+_[15]+4264355552&4294967295,b=g+(y<<10&4294967295|y>>>22),y=I+(g^(b|~v))+_[6]+2734768916&4294967295,I=b+(y<<15&4294967295|y>>>17),y=v+(b^(I|~g))+_[13]+1309151649&4294967295,v=I+(y<<21&4294967295|y>>>11),y=g+(I^(v|~b))+_[4]+4149444226&4294967295,g=v+(y<<6&4294967295|y>>>26),y=b+(v^(g|~I))+_[11]+3174756917&4294967295,b=g+(y<<10&4294967295|y>>>22),y=I+(g^(b|~v))+_[2]+718787259&4294967295,I=b+(y<<15&4294967295|y>>>17),y=v+(b^(I|~g))+_[9]+3951481745&4294967295,E.g[0]=E.g[0]+g&4294967295,E.g[1]=E.g[1]+(I+(y<<21&4294967295|y>>>11))&4294967295,E.g[2]=E.g[2]+I&4294967295,E.g[3]=E.g[3]+b&4294967295}r.prototype.u=function(E,g){g===void 0&&(g=E.length);for(var v=g-this.blockSize,_=this.B,I=this.h,b=0;b<g;){if(I==0)for(;b<=v;)i(this,E,b),b+=this.blockSize;if(typeof E=="string"){for(;b<g;)if(_[I++]=E.charCodeAt(b++),I==this.blockSize){i(this,_),I=0;break}}else for(;b<g;)if(_[I++]=E[b++],I==this.blockSize){i(this,_),I=0;break}}this.h=I,this.o+=g},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var g=1;g<E.length-8;++g)E[g]=0;var v=8*this.o;for(g=E.length-8;g<E.length;++g)E[g]=v&255,v/=256;for(this.u(E),E=Array(16),g=v=0;4>g;++g)for(var _=0;32>_;_+=8)E[v++]=this.g[g]>>>_&255;return E};function s(E,g){var v=c;return Object.prototype.hasOwnProperty.call(v,E)?v[E]:v[E]=g(E)}function a(E,g){this.h=g;for(var v=[],_=!0,I=E.length-1;0<=I;I--){var b=E[I]|0;_&&b==g||(v[I]=b,_=!1)}this.g=v}var c={};function u(E){return-128<=E&&128>E?s(E,function(g){return new a([g|0],0>g?-1:0)}):new a([E|0],0>E?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return m;if(0>E)return S(d(-E));for(var g=[],v=1,_=0;E>=v;_++)g[_]=E/v|0,v*=4294967296;return new a(g,0)}function p(E,g){if(E.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(E.charAt(0)=="-")return S(p(E.substring(1),g));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=d(Math.pow(g,8)),_=m,I=0;I<E.length;I+=8){var b=Math.min(8,E.length-I),y=parseInt(E.substring(I,I+b),g);8>b?(b=d(Math.pow(g,b)),_=_.j(b).add(d(y))):(_=_.j(v),_=_.add(d(y)))}return _}var m=u(0),w=u(1),A=u(16777216);n=a.prototype,n.m=function(){if(k(this))return-S(this).m();for(var E=0,g=1,v=0;v<this.g.length;v++){var _=this.i(v);E+=(0<=_?_:4294967296+_)*g,g*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(P(this))return"0";if(k(this))return"-"+S(this).toString(E);for(var g=d(Math.pow(E,6)),v=this,_="";;){var I=se(v,g).g;v=U(v,I.j(g));var b=((0<v.g.length?v.g[0]:v.h)>>>0).toString(E);if(v=I,P(v))return b+_;for(;6>b.length;)b="0"+b;_=b+_}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function P(E){if(E.h!=0)return!1;for(var g=0;g<E.g.length;g++)if(E.g[g]!=0)return!1;return!0}function k(E){return E.h==-1}n.l=function(E){return E=U(this,E),k(E)?-1:P(E)?0:1};function S(E){for(var g=E.g.length,v=[],_=0;_<g;_++)v[_]=~E.g[_];return new a(v,~E.h).add(w)}n.abs=function(){return k(this)?S(this):this},n.add=function(E){for(var g=Math.max(this.g.length,E.g.length),v=[],_=0,I=0;I<=g;I++){var b=_+(this.i(I)&65535)+(E.i(I)&65535),y=(b>>>16)+(this.i(I)>>>16)+(E.i(I)>>>16);_=y>>>16,b&=65535,y&=65535,v[I]=y<<16|b}return new a(v,v[v.length-1]&-2147483648?-1:0)};function U(E,g){return E.add(S(g))}n.j=function(E){if(P(this)||P(E))return m;if(k(this))return k(E)?S(this).j(S(E)):S(S(this).j(E));if(k(E))return S(this.j(S(E)));if(0>this.l(A)&&0>E.l(A))return d(this.m()*E.m());for(var g=this.g.length+E.g.length,v=[],_=0;_<2*g;_++)v[_]=0;for(_=0;_<this.g.length;_++)for(var I=0;I<E.g.length;I++){var b=this.i(_)>>>16,y=this.i(_)&65535,xt=E.i(I)>>>16,ri=E.i(I)&65535;v[2*_+2*I]+=y*ri,q(v,2*_+2*I),v[2*_+2*I+1]+=b*ri,q(v,2*_+2*I+1),v[2*_+2*I+1]+=y*xt,q(v,2*_+2*I+1),v[2*_+2*I+2]+=b*xt,q(v,2*_+2*I+2)}for(_=0;_<g;_++)v[_]=v[2*_+1]<<16|v[2*_];for(_=g;_<2*g;_++)v[_]=0;return new a(v,0)};function q(E,g){for(;(E[g]&65535)!=E[g];)E[g+1]+=E[g]>>>16,E[g]&=65535,g++}function L(E,g){this.g=E,this.h=g}function se(E,g){if(P(g))throw Error("division by zero");if(P(E))return new L(m,m);if(k(E))return g=se(S(E),g),new L(S(g.g),S(g.h));if(k(g))return g=se(E,S(g)),new L(S(g.g),g.h);if(30<E.g.length){if(k(E)||k(g))throw Error("slowDivide_ only works with positive integers.");for(var v=w,_=g;0>=_.l(E);)v=ye(v),_=ye(_);var I=ee(v,1),b=ee(_,1);for(_=ee(_,2),v=ee(v,2);!P(_);){var y=b.add(_);0>=y.l(E)&&(I=I.add(v),b=y),_=ee(_,1),v=ee(v,1)}return g=U(E,I.j(g)),new L(I,g)}for(I=m;0<=E.l(g);){for(v=Math.max(1,Math.floor(E.m()/g.m())),_=Math.ceil(Math.log(v)/Math.LN2),_=48>=_?1:Math.pow(2,_-48),b=d(v),y=b.j(g);k(y)||0<y.l(E);)v-=_,b=d(v),y=b.j(g);P(b)&&(b=w),I=I.add(b),E=U(E,y)}return new L(I,E)}n.A=function(E){return se(this,E).h},n.and=function(E){for(var g=Math.max(this.g.length,E.g.length),v=[],_=0;_<g;_++)v[_]=this.i(_)&E.i(_);return new a(v,this.h&E.h)},n.or=function(E){for(var g=Math.max(this.g.length,E.g.length),v=[],_=0;_<g;_++)v[_]=this.i(_)|E.i(_);return new a(v,this.h|E.h)},n.xor=function(E){for(var g=Math.max(this.g.length,E.g.length),v=[],_=0;_<g;_++)v[_]=this.i(_)^E.i(_);return new a(v,this.h^E.h)};function ye(E){for(var g=E.g.length+1,v=[],_=0;_<g;_++)v[_]=E.i(_)<<1|E.i(_-1)>>>31;return new a(v,E.h)}function ee(E,g){var v=g>>5;g%=32;for(var _=E.g.length-v,I=[],b=0;b<_;b++)I[b]=0<g?E.i(b+v)>>>g|E.i(b+v+1)<<32-g:E.i(b+v);return new a(I,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Kl=Jm.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,yn=Jm.Integer=a}).apply(typeof Ym<"u"?Ym:typeof self<"u"?self:typeof window<"u"?window:{});var ia=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Wt={};var Ql,Ab,kr,Yl,fs,sa,Jl,Xl,Zl;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,l,h){return o==Array.prototype||o==Object.prototype||(o[l]=h.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof ia=="object"&&ia];for(var l=0;l<o.length;++l){var h=o[l];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var r=t(this);function i(o,l){if(l)e:{var h=r;o=o.split(".");for(var f=0;f<o.length-1;f++){var T=o[f];if(!(T in h))break e;h=h[T]}o=o[o.length-1],f=h[o],l=l(f),l!=f&&l!=null&&e(h,o,{configurable:!0,writable:!0,value:l})}}function s(o,l){o instanceof String&&(o+="");var h=0,f=!1,T={next:function(){if(!f&&h<o.length){var D=h++;return{value:l(D,o[D]),done:!1}}return f=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(o){return o||function(){return s(this,function(l,h){return h})}});var a=a||{},c=this||self;function u(o){var l=typeof o;return l=l!="object"?l:o?Array.isArray(o)?"array":l:"null",l=="array"||l=="object"&&typeof o.length=="number"}function d(o){var l=typeof o;return l=="object"&&o!=null||l=="function"}function p(o,l,h){return o.call.apply(o.bind,arguments)}function m(o,l,h){if(!o)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,f),o.apply(l,T)}}return function(){return o.apply(l,arguments)}}function w(o,l,h){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:m,w.apply(null,arguments)}function A(o,l){var h=Array.prototype.slice.call(arguments,1);return function(){var f=h.slice();return f.push.apply(f,arguments),o.apply(this,f)}}function P(o,l){function h(){}h.prototype=l.prototype,o.aa=l.prototype,o.prototype=new h,o.prototype.constructor=o,o.Qb=function(f,T,D){for(var N=Array(arguments.length-2),le=2;le<arguments.length;le++)N[le-2]=arguments[le];return l.prototype[T].apply(f,N)}}function k(o){let l=o.length;if(0<l){let h=Array(l);for(let f=0;f<l;f++)h[f]=o[f];return h}return[]}function S(o,l){for(let h=1;h<arguments.length;h++){let f=arguments[h];if(u(f)){let T=o.length||0,D=f.length||0;o.length=T+D;for(let N=0;N<D;N++)o[T+N]=f[N]}else o.push(f)}}class U{constructor(l,h){this.i=l,this.j=h,this.h=0,this.g=null}get(){let l;return 0<this.h?(this.h--,l=this.g,this.g=l.next,l.next=null):l=this.i(),l}}function q(o){return/^[\s\xa0]*$/.test(o)}function L(){var o=c.navigator;return o&&(o=o.userAgent)?o:""}function se(o){return se[" "](o),o}se[" "]=function(){};var ye=L().indexOf("Gecko")!=-1&&!(L().toLowerCase().indexOf("webkit")!=-1&&L().indexOf("Edge")==-1)&&!(L().indexOf("Trident")!=-1||L().indexOf("MSIE")!=-1)&&L().indexOf("Edge")==-1;function ee(o,l,h){for(let f in o)l.call(h,o[f],f,o)}function E(o,l){for(let h in o)l.call(void 0,o[h],h,o)}function g(o){let l={};for(let h in o)l[h]=o[h];return l}let v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _(o,l){let h,f;for(let T=1;T<arguments.length;T++){f=arguments[T];for(h in f)o[h]=f[h];for(let D=0;D<v.length;D++)h=v[D],Object.prototype.hasOwnProperty.call(f,h)&&(o[h]=f[h])}}function I(o){var l=1;o=o.split(":");let h=[];for(;0<l&&o.length;)h.push(o.shift()),l--;return o.length&&h.push(o.join(":")),h}function b(o){c.setTimeout(()=>{throw o},0)}function y(){var o=ac;let l=null;return o.g&&(l=o.g,o.g=o.g.next,o.g||(o.h=null),l.next=null),l}class xt{constructor(){this.h=this.g=null}add(l,h){let f=ri.get();f.set(l,h),this.h?this.h.next=f:this.g=f,this.h=f}}var ri=new U(()=>new e_,o=>o.reset());class e_{constructor(){this.next=this.g=this.h=null}set(l,h){this.h=l,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let ii,si=!1,ac=new xt,mf=()=>{let o=c.Promise.resolve(void 0);ii=()=>{o.then(t_)}};var t_=()=>{for(var o;o=y();){try{o.h.call(o.g)}catch(h){b(h)}var l=ri;l.j(o),100>l.h&&(l.h++,o.next=l.g,l.g=o)}si=!1};function Xt(){this.s=this.s,this.C=this.C}Xt.prototype.s=!1,Xt.prototype.ma=function(){this.s||(this.s=!0,this.N())},Xt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Fe(o,l){this.type=o,this.g=this.target=l,this.defaultPrevented=!1}Fe.prototype.h=function(){this.defaultPrevented=!0};var n_=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var o=!1,l=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let h=()=>{};c.addEventListener("test",h,l),c.removeEventListener("test",h,l)}catch{}return o}();function oi(o,l){if(Fe.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var h=this.type=o.type,f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=l,l=o.relatedTarget){if(ye){e:{try{se(l.nodeName);var T=!0;break e}catch{}T=!1}T||(l=null)}}else h=="mouseover"?l=o.fromElement:h=="mouseout"&&(l=o.toElement);this.relatedTarget=l,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:r_[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&oi.aa.h.call(this)}}P(oi,Fe);var r_={2:"touch",3:"pen",4:"mouse"};oi.prototype.h=function(){oi.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var ai="closure_listenable_"+(1e6*Math.random()|0),i_=0;function s_(o,l,h,f,T){this.listener=o,this.proxy=null,this.src=l,this.type=h,this.capture=!!f,this.ha=T,this.key=++i_,this.da=this.fa=!1}function Bs(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function $s(o){this.src=o,this.g={},this.h=0}$s.prototype.add=function(o,l,h,f,T){var D=o.toString();o=this.g[D],o||(o=this.g[D]=[],this.h++);var N=uc(o,l,f,T);return-1<N?(l=o[N],h||(l.fa=!1)):(l=new s_(l,this.src,D,!!f,T),l.fa=h,o.push(l)),l};function cc(o,l){var h=l.type;if(h in o.g){var f=o.g[h],T=Array.prototype.indexOf.call(f,l,void 0),D;(D=0<=T)&&Array.prototype.splice.call(f,T,1),D&&(Bs(l),o.g[h].length==0&&(delete o.g[h],o.h--))}}function uc(o,l,h,f){for(var T=0;T<o.length;++T){var D=o[T];if(!D.da&&D.listener==l&&D.capture==!!h&&D.ha==f)return T}return-1}var lc="closure_lm_"+(1e6*Math.random()|0),hc={};function yf(o,l,h,f,T){if(f&&f.once)return _f(o,l,h,f,T);if(Array.isArray(l)){for(var D=0;D<l.length;D++)yf(o,l[D],h,f,T);return null}return h=gc(h),o&&o[ai]?o.K(l,h,d(f)?!!f.capture:!!f,T):vf(o,l,h,!1,f,T)}function vf(o,l,h,f,T,D){if(!l)throw Error("Invalid event type");var N=d(T)?!!T.capture:!!T,le=fc(o);if(le||(o[lc]=le=new $s(o)),h=le.add(l,h,f,N,D),h.proxy)return h;if(f=o_(),h.proxy=f,f.src=o,f.listener=h,o.addEventListener)n_||(T=N),T===void 0&&(T=!1),o.addEventListener(l.toString(),f,T);else if(o.attachEvent)o.attachEvent(Ef(l.toString()),f);else if(o.addListener&&o.removeListener)o.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return h}function o_(){function o(h){return l.call(o.src,o.listener,h)}let l=a_;return o}function _f(o,l,h,f,T){if(Array.isArray(l)){for(var D=0;D<l.length;D++)_f(o,l[D],h,f,T);return null}return h=gc(h),o&&o[ai]?o.L(l,h,d(f)?!!f.capture:!!f,T):vf(o,l,h,!0,f,T)}function wf(o,l,h,f,T){if(Array.isArray(l))for(var D=0;D<l.length;D++)wf(o,l[D],h,f,T);else f=d(f)?!!f.capture:!!f,h=gc(h),o&&o[ai]?(o=o.i,l=String(l).toString(),l in o.g&&(D=o.g[l],h=uc(D,h,f,T),-1<h&&(Bs(D[h]),Array.prototype.splice.call(D,h,1),D.length==0&&(delete o.g[l],o.h--)))):o&&(o=fc(o))&&(l=o.g[l.toString()],o=-1,l&&(o=uc(l,h,f,T)),(h=-1<o?l[o]:null)&&dc(h))}function dc(o){if(typeof o!="number"&&o&&!o.da){var l=o.src;if(l&&l[ai])cc(l.i,o);else{var h=o.type,f=o.proxy;l.removeEventListener?l.removeEventListener(h,f,o.capture):l.detachEvent?l.detachEvent(Ef(h),f):l.addListener&&l.removeListener&&l.removeListener(f),(h=fc(l))?(cc(h,o),h.h==0&&(h.src=null,l[lc]=null)):Bs(o)}}}function Ef(o){return o in hc?hc[o]:hc[o]="on"+o}function a_(o,l){if(o.da)o=!0;else{l=new oi(l,this);var h=o.listener,f=o.ha||o.src;o.fa&&dc(o),o=h.call(f,l)}return o}function fc(o){return o=o[lc],o instanceof $s?o:null}var pc="__closure_events_fn_"+(1e9*Math.random()>>>0);function gc(o){return typeof o=="function"?o:(o[pc]||(o[pc]=function(l){return o.handleEvent(l)}),o[pc])}function Le(){Xt.call(this),this.i=new $s(this),this.M=this,this.F=null}P(Le,Xt),Le.prototype[ai]=!0,Le.prototype.removeEventListener=function(o,l,h,f){wf(this,o,l,h,f)};function qe(o,l){var h,f=o.F;if(f)for(h=[];f;f=f.F)h.push(f);if(o=o.M,f=l.type||l,typeof l=="string")l=new Fe(l,o);else if(l instanceof Fe)l.target=l.target||o;else{var T=l;l=new Fe(f,o),_(l,T)}if(T=!0,h)for(var D=h.length-1;0<=D;D--){var N=l.g=h[D];T=js(N,f,!0,l)&&T}if(N=l.g=o,T=js(N,f,!0,l)&&T,T=js(N,f,!1,l)&&T,h)for(D=0;D<h.length;D++)N=l.g=h[D],T=js(N,f,!1,l)&&T}Le.prototype.N=function(){if(Le.aa.N.call(this),this.i){var o=this.i,l;for(l in o.g){for(var h=o.g[l],f=0;f<h.length;f++)Bs(h[f]);delete o.g[l],o.h--}}this.F=null},Le.prototype.K=function(o,l,h,f){return this.i.add(String(o),l,!1,h,f)},Le.prototype.L=function(o,l,h,f){return this.i.add(String(o),l,!0,h,f)};function js(o,l,h,f){if(l=o.i.g[String(l)],!l)return!0;l=l.concat();for(var T=!0,D=0;D<l.length;++D){var N=l[D];if(N&&!N.da&&N.capture==h){var le=N.listener,ke=N.ha||N.src;N.fa&&cc(o.i,N),T=le.call(ke,f)!==!1&&T}}return T&&!f.defaultPrevented}function If(o,l,h){if(typeof o=="function")h&&(o=w(o,h));else if(o&&typeof o.handleEvent=="function")o=w(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(l)?-1:c.setTimeout(o,l||0)}function Tf(o){o.g=If(()=>{o.g=null,o.i&&(o.i=!1,Tf(o))},o.l);let l=o.h;o.h=null,o.m.apply(null,l)}class c_ extends Xt{constructor(l,h){super(),this.m=l,this.l=h,this.h=null,this.i=!1,this.g=null}j(l){this.h=arguments,this.g?this.i=!0:Tf(this)}N(){super.N(),this.g&&(c.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ci(o){Xt.call(this),this.h=o,this.g={}}P(ci,Xt);var bf=[];function Cf(o){ee(o.g,function(l,h){this.g.hasOwnProperty(h)&&dc(l)},o),o.g={}}ci.prototype.N=function(){ci.aa.N.call(this),Cf(this)},ci.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var mc=c.JSON.stringify,u_=c.JSON.parse,l_=class{stringify(o){return c.JSON.stringify(o,void 0)}parse(o){return c.JSON.parse(o,void 0)}};function yc(){}yc.prototype.h=null;function Af(o){return o.h||(o.h=o.i())}function Df(){}var ui={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function vc(){Fe.call(this,"d")}P(vc,Fe);function _c(){Fe.call(this,"c")}P(_c,Fe);var Tn={},Sf=null;function zs(){return Sf=Sf||new Le}Tn.La="serverreachability";function Rf(o){Fe.call(this,Tn.La,o)}P(Rf,Fe);function li(o){let l=zs();qe(l,new Rf(l))}Tn.STAT_EVENT="statevent";function Pf(o,l){Fe.call(this,Tn.STAT_EVENT,o),this.stat=l}P(Pf,Fe);function Ge(o){let l=zs();qe(l,new Pf(l,o))}Tn.Ma="timingevent";function kf(o,l){Fe.call(this,Tn.Ma,o),this.size=l}P(kf,Fe);function hi(o,l){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return c.setTimeout(function(){o()},l)}function di(){this.g=!0}di.prototype.xa=function(){this.g=!1};function h_(o,l,h,f,T,D){o.info(function(){if(o.g)if(D)for(var N="",le=D.split("&"),ke=0;ke<le.length;ke++){var re=le[ke].split("=");if(1<re.length){var Ve=re[0];re=re[1];var Ue=Ve.split("_");N=2<=Ue.length&&Ue[1]=="type"?N+(Ve+"="+re+"&"):N+(Ve+"=redacted&")}}else N=null;else N=D;return"XMLHTTP REQ ("+f+") [attempt "+T+"]: "+l+`
`+h+`
`+N})}function d_(o,l,h,f,T,D,N){o.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+T+"]: "+l+`
`+h+`
`+D+" "+N})}function er(o,l,h,f){o.info(function(){return"XMLHTTP TEXT ("+l+"): "+p_(o,h)+(f?" "+f:"")})}function f_(o,l){o.info(function(){return"TIMEOUT: "+l})}di.prototype.info=function(){};function p_(o,l){if(!o.g)return l;if(!l)return null;try{var h=JSON.parse(l);if(h){for(o=0;o<h.length;o++)if(Array.isArray(h[o])){var f=h[o];if(!(2>f.length)){var T=f[1];if(Array.isArray(T)&&!(1>T.length)){var D=T[0];if(D!="noop"&&D!="stop"&&D!="close")for(var N=1;N<T.length;N++)T[N]=""}}}}return mc(h)}catch{return l}}var qs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Of={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},wc;function Gs(){}P(Gs,yc),Gs.prototype.g=function(){return new XMLHttpRequest},Gs.prototype.i=function(){return{}},wc=new Gs;function Zt(o,l,h,f){this.j=o,this.i=l,this.l=h,this.R=f||1,this.U=new ci(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Nf}function Nf(){this.i=null,this.g="",this.h=!1}var Mf={},Ec={};function Ic(o,l,h){o.L=1,o.v=Qs(Ft(l)),o.m=h,o.P=!0,xf(o,null)}function xf(o,l){o.F=Date.now(),Ws(o),o.A=Ft(o.v);var h=o.A,f=o.R;Array.isArray(f)||(f=[String(f)]),Qf(h.i,"t",f),o.C=0,h=o.j.J,o.h=new Nf,o.g=fp(o.j,h?l:null,!o.m),0<o.O&&(o.M=new c_(w(o.Y,o,o.g),o.O)),l=o.U,h=o.g,f=o.ca;var T="readystatechange";Array.isArray(T)||(T&&(bf[0]=T.toString()),T=bf);for(var D=0;D<T.length;D++){var N=yf(h,T[D],f||l.handleEvent,!1,l.h||l);if(!N)break;l.g[N.key]=N}l=o.H?g(o.H):{},o.m?(o.u||(o.u="POST"),l["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,l)):(o.u="GET",o.g.ea(o.A,o.u,null,l)),li(),h_(o.i,o.u,o.A,o.l,o.R,o.m)}Zt.prototype.ca=function(o){o=o.target;let l=this.M;l&&Lt(o)==3?l.j():this.Y(o)},Zt.prototype.Y=function(o){try{if(o==this.g)e:{let Ue=Lt(this.g);var l=this.g.Ba();let rr=this.g.Z();if(!(3>Ue)&&(Ue!=3||this.g&&(this.h.h||this.g.oa()||np(this.g)))){this.J||Ue!=4||l==7||(l==8||0>=rr?li(3):li(2)),Tc(this);var h=this.g.Z();this.X=h;t:if(Ff(this)){var f=np(this.g);o="";var T=f.length,D=Lt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){bn(this),fi(this);var N="";break t}this.h.i=new c.TextDecoder}for(l=0;l<T;l++)this.h.h=!0,o+=this.h.i.decode(f[l],{stream:!(D&&l==T-1)});f.length=0,this.h.g+=o,this.C=0,N=this.h.g}else N=this.g.oa();if(this.o=h==200,d_(this.i,this.u,this.A,this.l,this.R,Ue,h),this.o){if(this.T&&!this.K){t:{if(this.g){var le,ke=this.g;if((le=ke.g?ke.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(le)){var re=le;break t}}re=null}if(h=re)er(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,bc(this,h);else{this.o=!1,this.s=3,Ge(12),bn(this),fi(this);break e}}if(this.P){h=!0;let dt;for(;!this.J&&this.C<N.length;)if(dt=g_(this,N),dt==Ec){Ue==4&&(this.s=4,Ge(14),h=!1),er(this.i,this.l,null,"[Incomplete Response]");break}else if(dt==Mf){this.s=4,Ge(15),er(this.i,this.l,N,"[Invalid Chunk]"),h=!1;break}else er(this.i,this.l,dt,null),bc(this,dt);if(Ff(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ue!=4||N.length!=0||this.h.h||(this.s=1,Ge(16),h=!1),this.o=this.o&&h,!h)er(this.i,this.l,N,"[Invalid Chunked Response]"),bn(this),fi(this);else if(0<N.length&&!this.W){this.W=!0;var Ve=this.j;Ve.g==this&&Ve.ba&&!Ve.M&&(Ve.j.info("Great, no buffering proxy detected. Bytes received: "+N.length),Pc(Ve),Ve.M=!0,Ge(11))}}else er(this.i,this.l,N,null),bc(this,N);Ue==4&&bn(this),this.o&&!this.J&&(Ue==4?up(this.j,this):(this.o=!1,Ws(this)))}else O_(this.g),h==400&&0<N.indexOf("Unknown SID")?(this.s=3,Ge(12)):(this.s=0,Ge(13)),bn(this),fi(this)}}}catch{}finally{}};function Ff(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function g_(o,l){var h=o.C,f=l.indexOf(`
`,h);return f==-1?Ec:(h=Number(l.substring(h,f)),isNaN(h)?Mf:(f+=1,f+h>l.length?Ec:(l=l.slice(f,f+h),o.C=f+h,l)))}Zt.prototype.cancel=function(){this.J=!0,bn(this)};function Ws(o){o.S=Date.now()+o.I,Lf(o,o.I)}function Lf(o,l){if(o.B!=null)throw Error("WatchDog timer not null");o.B=hi(w(o.ba,o),l)}function Tc(o){o.B&&(c.clearTimeout(o.B),o.B=null)}Zt.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(f_(this.i,this.A),this.L!=2&&(li(),Ge(17)),bn(this),this.s=2,fi(this)):Lf(this,this.S-o)};function fi(o){o.j.G==0||o.J||up(o.j,o)}function bn(o){Tc(o);var l=o.M;l&&typeof l.ma=="function"&&l.ma(),o.M=null,Cf(o.U),o.g&&(l=o.g,o.g=null,l.abort(),l.ma())}function bc(o,l){try{var h=o.j;if(h.G!=0&&(h.g==o||Cc(h.h,o))){if(!o.K&&Cc(h.h,o)&&h.G==3){try{var f=h.Da.g.parse(l)}catch{f=null}if(Array.isArray(f)&&f.length==3){var T=f;if(T[0]==0){e:if(!h.u){if(h.g)if(h.g.F+3e3<o.F)eo(h),Xs(h);else break e;Rc(h),Ge(18)}}else h.za=T[1],0<h.za-h.T&&37500>T[2]&&h.F&&h.v==0&&!h.C&&(h.C=hi(w(h.Za,h),6e3));if(1>=Bf(h.h)&&h.ca){try{h.ca()}catch{}h.ca=void 0}}else An(h,11)}else if((o.K||h.g==o)&&eo(h),!q(l))for(T=h.Da.g.parse(l),l=0;l<T.length;l++){let re=T[l];if(h.T=re[0],re=re[1],h.G==2)if(re[0]=="c"){h.K=re[1],h.ia=re[2];let Ve=re[3];Ve!=null&&(h.la=Ve,h.j.info("VER="+h.la));let Ue=re[4];Ue!=null&&(h.Aa=Ue,h.j.info("SVER="+h.Aa));let rr=re[5];rr!=null&&typeof rr=="number"&&0<rr&&(f=1.5*rr,h.L=f,h.j.info("backChannelRequestTimeoutMs_="+f)),f=h;let dt=o.g;if(dt){let no=dt.g?dt.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(no){var D=f.h;D.g||no.indexOf("spdy")==-1&&no.indexOf("quic")==-1&&no.indexOf("h2")==-1||(D.j=D.l,D.g=new Set,D.h&&(Ac(D,D.h),D.h=null))}if(f.D){let kc=dt.g?dt.g.getResponseHeader("X-HTTP-Session-Id"):null;kc&&(f.ya=kc,pe(f.I,f.D,kc))}}h.G=3,h.l&&h.l.ua(),h.ba&&(h.R=Date.now()-o.F,h.j.info("Handshake RTT: "+h.R+"ms")),f=h;var N=o;if(f.qa=dp(f,f.J?f.ia:null,f.W),N.K){$f(f.h,N);var le=N,ke=f.L;ke&&(le.I=ke),le.B&&(Tc(le),Ws(le)),f.g=N}else ap(f);0<h.i.length&&Zs(h)}else re[0]!="stop"&&re[0]!="close"||An(h,7);else h.G==3&&(re[0]=="stop"||re[0]=="close"?re[0]=="stop"?An(h,7):Sc(h):re[0]!="noop"&&h.l&&h.l.ta(re),h.v=0)}}li(4)}catch{}}var m_=class{constructor(o,l){this.g=o,this.map=l}};function Vf(o){this.l=o||10,c.PerformanceNavigationTiming?(o=c.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(c.chrome&&c.chrome.loadTimes&&c.chrome.loadTimes()&&c.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Uf(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Bf(o){return o.h?1:o.g?o.g.size:0}function Cc(o,l){return o.h?o.h==l:o.g?o.g.has(l):!1}function Ac(o,l){o.g?o.g.add(l):o.h=l}function $f(o,l){o.h&&o.h==l?o.h=null:o.g&&o.g.has(l)&&o.g.delete(l)}Vf.prototype.cancel=function(){if(this.i=jf(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function jf(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let l=o.i;for(let h of o.g.values())l=l.concat(h.D);return l}return k(o.i)}function y_(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(u(o)){for(var l=[],h=o.length,f=0;f<h;f++)l.push(o[f]);return l}l=[],h=0;for(f in o)l[h++]=o[f];return l}function v_(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(u(o)||typeof o=="string"){var l=[];o=o.length;for(var h=0;h<o;h++)l.push(h);return l}l=[],h=0;for(let f in o)l[h++]=f;return l}}}function zf(o,l){if(o.forEach&&typeof o.forEach=="function")o.forEach(l,void 0);else if(u(o)||typeof o=="string")Array.prototype.forEach.call(o,l,void 0);else for(var h=v_(o),f=y_(o),T=f.length,D=0;D<T;D++)l.call(void 0,f[D],h&&h[D],o)}var qf=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function __(o,l){if(o){o=o.split("&");for(var h=0;h<o.length;h++){var f=o[h].indexOf("="),T=null;if(0<=f){var D=o[h].substring(0,f);T=o[h].substring(f+1)}else D=o[h];l(D,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function Cn(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof Cn){this.h=o.h,Hs(this,o.j),this.o=o.o,this.g=o.g,Ks(this,o.s),this.l=o.l;var l=o.i,h=new mi;h.i=l.i,l.g&&(h.g=new Map(l.g),h.h=l.h),Gf(this,h),this.m=o.m}else o&&(l=String(o).match(qf))?(this.h=!1,Hs(this,l[1]||"",!0),this.o=pi(l[2]||""),this.g=pi(l[3]||"",!0),Ks(this,l[4]),this.l=pi(l[5]||"",!0),Gf(this,l[6]||"",!0),this.m=pi(l[7]||"")):(this.h=!1,this.i=new mi(null,this.h))}Cn.prototype.toString=function(){var o=[],l=this.j;l&&o.push(gi(l,Wf,!0),":");var h=this.g;return(h||l=="file")&&(o.push("//"),(l=this.o)&&o.push(gi(l,Wf,!0),"@"),o.push(encodeURIComponent(String(h)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.s,h!=null&&o.push(":",String(h))),(h=this.l)&&(this.g&&h.charAt(0)!="/"&&o.push("/"),o.push(gi(h,h.charAt(0)=="/"?I_:E_,!0))),(h=this.i.toString())&&o.push("?",h),(h=this.m)&&o.push("#",gi(h,b_)),o.join("")};function Ft(o){return new Cn(o)}function Hs(o,l,h){o.j=h?pi(l,!0):l,o.j&&(o.j=o.j.replace(/:$/,""))}function Ks(o,l){if(l){if(l=Number(l),isNaN(l)||0>l)throw Error("Bad port number "+l);o.s=l}else o.s=null}function Gf(o,l,h){l instanceof mi?(o.i=l,C_(o.i,o.h)):(h||(l=gi(l,T_)),o.i=new mi(l,o.h))}function pe(o,l,h){o.i.set(l,h)}function Qs(o){return pe(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function pi(o,l){return o?l?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function gi(o,l,h){return typeof o=="string"?(o=encodeURI(o).replace(l,w_),h&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function w_(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Wf=/[#\/\?@]/g,E_=/[#\?:]/g,I_=/[#\?]/g,T_=/[#\?@]/g,b_=/#/g;function mi(o,l){this.h=this.g=null,this.i=o||null,this.j=!!l}function en(o){o.g||(o.g=new Map,o.h=0,o.i&&__(o.i,function(l,h){o.add(decodeURIComponent(l.replace(/\+/g," ")),h)}))}n=mi.prototype,n.add=function(o,l){en(this),this.i=null,o=tr(this,o);var h=this.g.get(o);return h||this.g.set(o,h=[]),h.push(l),this.h+=1,this};function Hf(o,l){en(o),l=tr(o,l),o.g.has(l)&&(o.i=null,o.h-=o.g.get(l).length,o.g.delete(l))}function Kf(o,l){return en(o),l=tr(o,l),o.g.has(l)}n.forEach=function(o,l){en(this),this.g.forEach(function(h,f){h.forEach(function(T){o.call(l,T,f,this)},this)},this)},n.na=function(){en(this);let o=Array.from(this.g.values()),l=Array.from(this.g.keys()),h=[];for(let f=0;f<l.length;f++){let T=o[f];for(let D=0;D<T.length;D++)h.push(l[f])}return h},n.V=function(o){en(this);let l=[];if(typeof o=="string")Kf(this,o)&&(l=l.concat(this.g.get(tr(this,o))));else{o=Array.from(this.g.values());for(let h=0;h<o.length;h++)l=l.concat(o[h])}return l},n.set=function(o,l){return en(this),this.i=null,o=tr(this,o),Kf(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[l]),this.h+=1,this},n.get=function(o,l){return o?(o=this.V(o),0<o.length?String(o[0]):l):l};function Qf(o,l,h){Hf(o,l),0<h.length&&(o.i=null,o.g.set(tr(o,l),k(h)),o.h+=h.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],l=Array.from(this.g.keys());for(var h=0;h<l.length;h++){var f=l[h];let D=encodeURIComponent(String(f)),N=this.V(f);for(f=0;f<N.length;f++){var T=D;N[f]!==""&&(T+="="+encodeURIComponent(String(N[f]))),o.push(T)}}return this.i=o.join("&")};function tr(o,l){return l=String(l),o.j&&(l=l.toLowerCase()),l}function C_(o,l){l&&!o.j&&(en(o),o.i=null,o.g.forEach(function(h,f){var T=f.toLowerCase();f!=T&&(Hf(this,f),Qf(this,T,h))},o)),o.j=l}function A_(o,l){let h=new di;if(c.Image){let f=new Image;f.onload=A(tn,h,"TestLoadImage: loaded",!0,l,f),f.onerror=A(tn,h,"TestLoadImage: error",!1,l,f),f.onabort=A(tn,h,"TestLoadImage: abort",!1,l,f),f.ontimeout=A(tn,h,"TestLoadImage: timeout",!1,l,f),c.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=o}else l(!1)}function D_(o,l){let h=new di,f=new AbortController,T=setTimeout(()=>{f.abort(),tn(h,"TestPingServer: timeout",!1,l)},1e4);fetch(o,{signal:f.signal}).then(D=>{clearTimeout(T),D.ok?tn(h,"TestPingServer: ok",!0,l):tn(h,"TestPingServer: server error",!1,l)}).catch(()=>{clearTimeout(T),tn(h,"TestPingServer: error",!1,l)})}function tn(o,l,h,f,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),f(h)}catch{}}function S_(){this.g=new l_}function R_(o,l,h){let f=h||"";try{zf(o,function(T,D){let N=T;d(T)&&(N=mc(T)),l.push(f+D+"="+encodeURIComponent(N))})}catch(T){throw l.push(f+"type="+encodeURIComponent("_badmap")),T}}function yi(o){this.l=o.Ub||null,this.j=o.eb||!1}P(yi,yc),yi.prototype.g=function(){return new Ys(this.l,this.j)},yi.prototype.i=function(o){return function(){return o}}({});function Ys(o,l){Le.call(this),this.D=o,this.o=l,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}P(Ys,Le),n=Ys.prototype,n.open=function(o,l){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=l,this.readyState=1,_i(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let l={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(l.body=o),(this.D||c).fetch(new Request(this.A,l)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,vi(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,_i(this)),this.g&&(this.readyState=3,_i(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof c.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Yf(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function Yf(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var l=o.value?o.value:new Uint8Array(0);(l=this.v.decode(l,{stream:!o.done}))&&(this.response=this.responseText+=l)}o.done?vi(this):_i(this),this.readyState==3&&Yf(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,vi(this))},n.Qa=function(o){this.g&&(this.response=o,vi(this))},n.ga=function(){this.g&&vi(this)};function vi(o){o.readyState=4,o.l=null,o.j=null,o.v=null,_i(o)}n.setRequestHeader=function(o,l){this.u.append(o,l)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],l=this.h.entries();for(var h=l.next();!h.done;)h=h.value,o.push(h[0]+": "+h[1]),h=l.next();return o.join(`\r
`)};function _i(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(Ys.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function Jf(o){let l="";return ee(o,function(h,f){l+=f,l+=":",l+=h,l+=`\r
`}),l}function Dc(o,l,h){e:{for(f in h){var f=!1;break e}f=!0}f||(h=Jf(h),typeof o=="string"?h!=null&&encodeURIComponent(String(h)):pe(o,l,h))}function _e(o){Le.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}P(_e,Le);var P_=/^https?$/i,k_=["POST","PUT"];n=_e.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,l,h,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);l=l?l.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():wc.g(),this.v=this.o?Af(this.o):Af(wc),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(l,String(o),!0),this.B=!1}catch(D){Xf(this,D);return}if(o=h||"",h=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var T in f)h.set(T,f[T]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let D of f.keys())h.set(D,f.get(D));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(h.keys()).find(D=>D.toLowerCase()=="content-type"),T=c.FormData&&o instanceof c.FormData,!(0<=Array.prototype.indexOf.call(k_,l,void 0))||f||T||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[D,N]of h)this.g.setRequestHeader(D,N);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{tp(this),this.u=!0,this.g.send(o),this.u=!1}catch(D){Xf(this,D)}};function Xf(o,l){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=l,o.m=5,Zf(o),Js(o)}function Zf(o){o.A||(o.A=!0,qe(o,"complete"),qe(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,qe(this,"complete"),qe(this,"abort"),Js(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Js(this,!0)),_e.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?ep(this):this.bb())},n.bb=function(){ep(this)};function ep(o){if(o.h&&typeof a<"u"&&(!o.v[1]||Lt(o)!=4||o.Z()!=2)){if(o.u&&Lt(o)==4)If(o.Ea,0,o);else if(qe(o,"readystatechange"),Lt(o)==4){o.h=!1;try{let N=o.Z();e:switch(N){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var l=!0;break e;default:l=!1}var h;if(!(h=l)){var f;if(f=N===0){var T=String(o.D).match(qf)[1]||null;!T&&c.self&&c.self.location&&(T=c.self.location.protocol.slice(0,-1)),f=!P_.test(T?T.toLowerCase():"")}h=f}if(h)qe(o,"complete"),qe(o,"success");else{o.m=6;try{var D=2<Lt(o)?o.g.statusText:""}catch{D=""}o.l=D+" ["+o.Z()+"]",Zf(o)}}finally{Js(o)}}}}function Js(o,l){if(o.g){tp(o);let h=o.g,f=o.v[0]?()=>{}:null;o.g=null,o.v=null,l||qe(o,"ready");try{h.onreadystatechange=f}catch{}}}function tp(o){o.I&&(c.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function Lt(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<Lt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var l=this.g.responseText;return o&&l.indexOf(o)==0&&(l=l.substring(o.length)),u_(l)}};function np(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function O_(o){let l={};o=(o.g&&2<=Lt(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<o.length;f++){if(q(o[f]))continue;var h=I(o[f]);let T=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();let D=l[T]||[];l[T]=D,D.push(h)}E(l,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function wi(o,l,h){return h&&h.internalChannelParams&&h.internalChannelParams[o]||l}function rp(o){this.Aa=0,this.i=[],this.j=new di,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=wi("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=wi("baseRetryDelayMs",5e3,o),this.cb=wi("retryDelaySeedMs",1e4,o),this.Wa=wi("forwardChannelMaxRetries",2,o),this.wa=wi("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Vf(o&&o.concurrentRequestLimit),this.Da=new S_,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=rp.prototype,n.la=8,n.G=1,n.connect=function(o,l,h,f){Ge(0),this.W=o,this.H=l||{},h&&f!==void 0&&(this.H.OSID=h,this.H.OAID=f),this.F=this.X,this.I=dp(this,null,this.W),Zs(this)};function Sc(o){if(ip(o),o.G==3){var l=o.U++,h=Ft(o.I);if(pe(h,"SID",o.K),pe(h,"RID",l),pe(h,"TYPE","terminate"),Ei(o,h),l=new Zt(o,o.j,l),l.L=2,l.v=Qs(Ft(h)),h=!1,c.navigator&&c.navigator.sendBeacon)try{h=c.navigator.sendBeacon(l.v.toString(),"")}catch{}!h&&c.Image&&(new Image().src=l.v,h=!0),h||(l.g=fp(l.j,null),l.g.ea(l.v)),l.F=Date.now(),Ws(l)}hp(o)}function Xs(o){o.g&&(Pc(o),o.g.cancel(),o.g=null)}function ip(o){Xs(o),o.u&&(c.clearTimeout(o.u),o.u=null),eo(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&c.clearTimeout(o.s),o.s=null)}function Zs(o){if(!Uf(o.h)&&!o.s){o.s=!0;var l=o.Ga;ii||mf(),si||(ii(),si=!0),ac.add(l,o),o.B=0}}function N_(o,l){return Bf(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=l.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=hi(w(o.Ga,o,l),lp(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let T=new Zt(this,this.j,o),D=this.o;if(this.S&&(D?(D=g(D),_(D,this.S)):D=this.S),this.m!==null||this.O||(T.H=D,D=null),this.P)e:{for(var l=0,h=0;h<this.i.length;h++){t:{var f=this.i[h];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(l+=f,4096<l){l=h;break e}if(l===4096||h===this.i.length-1){l=h+1;break e}}l=1e3}else l=1e3;l=op(this,T,l),h=Ft(this.I),pe(h,"RID",o),pe(h,"CVER",22),this.D&&pe(h,"X-HTTP-Session-Id",this.D),Ei(this,h),D&&(this.O?l="headers="+encodeURIComponent(String(Jf(D)))+"&"+l:this.m&&Dc(h,this.m,D)),Ac(this.h,T),this.Ua&&pe(h,"TYPE","init"),this.P?(pe(h,"$req",l),pe(h,"SID","null"),T.T=!0,Ic(T,h,null)):Ic(T,h,l),this.G=2}}else this.G==3&&(o?sp(this,o):this.i.length==0||Uf(this.h)||sp(this))};function sp(o,l){var h;l?h=l.l:h=o.U++;let f=Ft(o.I);pe(f,"SID",o.K),pe(f,"RID",h),pe(f,"AID",o.T),Ei(o,f),o.m&&o.o&&Dc(f,o.m,o.o),h=new Zt(o,o.j,h,o.B+1),o.m===null&&(h.H=o.o),l&&(o.i=l.D.concat(o.i)),l=op(o,h,1e3),h.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),Ac(o.h,h),Ic(h,f,l)}function Ei(o,l){o.H&&ee(o.H,function(h,f){pe(l,f,h)}),o.l&&zf({},function(h,f){pe(l,f,h)})}function op(o,l,h){h=Math.min(o.i.length,h);var f=o.l?w(o.l.Na,o.l,o):null;e:{var T=o.i;let D=-1;for(;;){let N=["count="+h];D==-1?0<h?(D=T[0].g,N.push("ofs="+D)):D=0:N.push("ofs="+D);let le=!0;for(let ke=0;ke<h;ke++){let re=T[ke].g,Ve=T[ke].map;if(re-=D,0>re)D=Math.max(0,T[ke].g-100),le=!1;else try{R_(Ve,N,"req"+re+"_")}catch{f&&f(Ve)}}if(le){f=N.join("&");break e}}}return o=o.i.splice(0,h),l.D=o,f}function ap(o){if(!o.g&&!o.u){o.Y=1;var l=o.Fa;ii||mf(),si||(ii(),si=!0),ac.add(l,o),o.v=0}}function Rc(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=hi(w(o.Fa,o),lp(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,cp(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=hi(w(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ge(10),Xs(this),cp(this))};function Pc(o){o.A!=null&&(c.clearTimeout(o.A),o.A=null)}function cp(o){o.g=new Zt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var l=Ft(o.qa);pe(l,"RID","rpc"),pe(l,"SID",o.K),pe(l,"AID",o.T),pe(l,"CI",o.F?"0":"1"),!o.F&&o.ja&&pe(l,"TO",o.ja),pe(l,"TYPE","xmlhttp"),Ei(o,l),o.m&&o.o&&Dc(l,o.m,o.o),o.L&&(o.g.I=o.L);var h=o.g;o=o.ia,h.L=1,h.v=Qs(Ft(l)),h.m=null,h.P=!0,xf(h,o)}n.Za=function(){this.C!=null&&(this.C=null,Xs(this),Rc(this),Ge(19))};function eo(o){o.C!=null&&(c.clearTimeout(o.C),o.C=null)}function up(o,l){var h=null;if(o.g==l){eo(o),Pc(o),o.g=null;var f=2}else if(Cc(o.h,l))h=l.D,$f(o.h,l),f=1;else return;if(o.G!=0){if(l.o)if(f==1){h=l.m?l.m.length:0,l=Date.now()-l.F;var T=o.B;f=zs(),qe(f,new kf(f,h)),Zs(o)}else ap(o);else if(T=l.s,T==3||T==0&&0<l.X||!(f==1&&N_(o,l)||f==2&&Rc(o)))switch(h&&0<h.length&&(l=o.h,l.i=l.i.concat(h)),T){case 1:An(o,5);break;case 4:An(o,10);break;case 3:An(o,6);break;default:An(o,2)}}}function lp(o,l){let h=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(h*=2),h*l}function An(o,l){if(o.j.info("Error code "+l),l==2){var h=w(o.fb,o),f=o.Xa;let T=!f;f=new Cn(f||"//www.google.com/images/cleardot.gif"),c.location&&c.location.protocol=="http"||Hs(f,"https"),Qs(f),T?A_(f.toString(),h):D_(f.toString(),h)}else Ge(2);o.G=0,o.l&&o.l.sa(l),hp(o),ip(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Ge(2)):(this.j.info("Failed to ping google.com"),Ge(1))};function hp(o){if(o.G=0,o.ka=[],o.l){let l=jf(o.h);(l.length!=0||o.i.length!=0)&&(S(o.ka,l),S(o.ka,o.i),o.h.i.length=0,k(o.i),o.i.length=0),o.l.ra()}}function dp(o,l,h){var f=h instanceof Cn?Ft(h):new Cn(h);if(f.g!="")l&&(f.g=l+"."+f.g),Ks(f,f.s);else{var T=c.location;f=T.protocol,l=l?l+"."+T.hostname:T.hostname,T=+T.port;var D=new Cn(null);f&&Hs(D,f),l&&(D.g=l),T&&Ks(D,T),h&&(D.l=h),f=D}return h=o.D,l=o.ya,h&&l&&pe(f,h,l),pe(f,"VER",o.la),Ei(o,f),f}function fp(o,l,h){if(l&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return l=o.Ca&&!o.pa?new _e(new yi({eb:h})):new _e(o.pa),l.Ha(o.J),l}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function pp(){}n=pp.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function to(){}to.prototype.g=function(o,l){return new Ke(o,l)};function Ke(o,l){Le.call(this),this.g=new rp(l),this.l=o,this.h=l&&l.messageUrlParams||null,o=l&&l.messageHeaders||null,l&&l.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=l&&l.initMessageHeaders||null,l&&l.messageContentType&&(o?o["X-WebChannel-Content-Type"]=l.messageContentType:o={"X-WebChannel-Content-Type":l.messageContentType}),l&&l.va&&(o?o["X-WebChannel-Client-Profile"]=l.va:o={"X-WebChannel-Client-Profile":l.va}),this.g.S=o,(o=l&&l.Sb)&&!q(o)&&(this.g.m=o),this.v=l&&l.supportsCrossDomainXhr||!1,this.u=l&&l.sendRawJson||!1,(l=l&&l.httpSessionIdParam)&&!q(l)&&(this.g.D=l,o=this.h,o!==null&&l in o&&(o=this.h,l in o&&delete o[l])),this.j=new nr(this)}P(Ke,Le),Ke.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ke.prototype.close=function(){Sc(this.g)},Ke.prototype.o=function(o){var l=this.g;if(typeof o=="string"){var h={};h.__data__=o,o=h}else this.u&&(h={},h.__data__=mc(o),o=h);l.i.push(new m_(l.Ya++,o)),l.G==3&&Zs(l)},Ke.prototype.N=function(){this.g.l=null,delete this.j,Sc(this.g),delete this.g,Ke.aa.N.call(this)};function gp(o){vc.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var l=o.__sm__;if(l){e:{for(let h in l){o=h;break e}o=void 0}(this.i=o)&&(o=this.i,l=l!==null&&o in l?l[o]:void 0),this.data=l}else this.data=o}P(gp,vc);function mp(){_c.call(this),this.status=1}P(mp,_c);function nr(o){this.g=o}P(nr,pp),nr.prototype.ua=function(){qe(this.g,"a")},nr.prototype.ta=function(o){qe(this.g,new gp(o))},nr.prototype.sa=function(o){qe(this.g,new mp)},nr.prototype.ra=function(){qe(this.g,"b")},to.prototype.createWebChannel=to.prototype.g,Ke.prototype.send=Ke.prototype.o,Ke.prototype.open=Ke.prototype.m,Ke.prototype.close=Ke.prototype.close,Zl=Wt.createWebChannelTransport=function(){return new to},Xl=Wt.getStatEventTarget=function(){return zs()},Jl=Wt.Event=Tn,sa=Wt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},qs.NO_ERROR=0,qs.TIMEOUT=8,qs.HTTP_ERROR=6,fs=Wt.ErrorCode=qs,Of.COMPLETE="complete",Yl=Wt.EventType=Of,Df.EventType=ui,ui.OPEN="a",ui.CLOSE="b",ui.ERROR="c",ui.MESSAGE="d",Le.prototype.listen=Le.prototype.K,kr=Wt.WebChannel=Df,Ab=Wt.FetchXmlHttpFactory=yi,_e.prototype.listenOnce=_e.prototype.L,_e.prototype.getLastError=_e.prototype.Ka,_e.prototype.getLastErrorCode=_e.prototype.Ba,_e.prototype.getStatus=_e.prototype.Z,_e.prototype.getResponseJson=_e.prototype.Oa,_e.prototype.getResponseText=_e.prototype.oa,_e.prototype.send=_e.prototype.ea,_e.prototype.setWithCredentials=_e.prototype.Ha,Ql=Wt.XhrIo=_e}).apply(typeof ia<"u"?ia:typeof self<"u"?self:typeof window<"u"?window:{});var Xm="@firebase/firestore";var Pe=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Pe.UNAUTHENTICATED=new Pe(null),Pe.GOOGLE_CREDENTIALS=new Pe("google-credentials-uid"),Pe.FIRST_PARTY=new Pe("first-party-uid"),Pe.MOCK_USER=new Pe("mock-user");var Jr="10.14.0";var zn=new fn("@firebase/firestore");function ps(){return zn.logLevel}function F(n,...e){if(zn.logLevel<=X.DEBUG){let t=e.map($d);zn.debug(`Firestore (${Jr}): ${n}`,...t)}}function Qt(n,...e){if(zn.logLevel<=X.ERROR){let t=e.map($d);zn.error(`Firestore (${Jr}): ${n}`,...t)}}function Vr(n,...e){if(zn.logLevel<=X.WARN){let t=e.map($d);zn.warn(`Firestore (${Jr}): ${n}`,...t)}}function $d(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function j(n="Unexpected state"){let e=`FIRESTORE (${Jr}) INTERNAL ASSERTION FAILED: `+n;throw Qt(e),new Error(e)}function ue(n,e){n||j()}function G(n,e){return n}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},x=class extends ut{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var Ht=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var la=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},sh=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Pe.UNAUTHENTICATED))}shutdown(){}},oh=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},ah=class{constructor(e){this.t=e,this.currentUser=Pe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ue(this.o===void 0);let r=this.i,i=u=>this.i!==r?(r=this.i,t(u)):Promise.resolve(),s=new Ht;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ht,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let u=s;e.enqueueRetryable(()=>C(this,null,function*(){yield u.promise,yield i(this.currentUser)}))},c=u=>{F("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>c(u)),setTimeout(()=>{if(!this.auth){let u=this.t.getImmediate({optional:!0});u?c(u):(F("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ht)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(F("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ue(typeof r.accessToken=="string"),new la(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return ue(e===null||typeof e=="string"),new Pe(e)}},ch=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Pe.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},uh=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new ch(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Pe.FIRST_PARTY))}shutdown(){}invalidateToken(){}},lh=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},hh=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){ue(this.o===void 0);let r=s=>{s.error!=null&&F("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,F("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{F("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):F("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(ue(typeof t.token=="string"),this.R=t.token,new lh(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function Db(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var ha=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=Db(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function ie(n,e){return n<e?-1:n>e?1:0}function Ur(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var xe=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new x(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new x(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new x(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new x(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ie(this.nanoseconds,e.nanoseconds):ie(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var K=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new xe(0,0))}static max(){return new n(new xe(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var da=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&j(),r===void 0?r=e.length-t:r>e.length-t&&j(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},ve=class n extends da{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new x(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},Sb=/^[_a-zA-Z][_a-zA-Z0-9]*$/,et=class n extends da{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return Sb.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new x(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let c=e[i];if(c==="\\"){if(i+1===e.length)throw new x(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new x(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,i+=2}else c==="`"?(a=!a,i++):c!=="."||a?(r+=c,i++):(s(),i++)}if(s(),a)throw new x(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(ve.fromString(e))}static fromName(e){return new n(ve.fromString(e).popFirst(5))}static empty(){return new n(ve.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ve.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ve.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new ve(e.slice()))}};var dh=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};dh.UNKNOWN_ID=-1;function Rb(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=K.fromTimestamp(r===1e9?new xe(t+1,0):new xe(t,r));return new qn(i,B.empty(),e)}function Pb(n){return new qn(n.readTime,n.key,-1)}var qn=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(K.min(),B.empty(),-1)}static max(){return new n(K.max(),B.empty(),-1)}};function kb(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:ie(n.largestBatchId,e.largestBatchId))}var Ob="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",fh=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Ms(n){return C(this,null,function*(){if(n.code!==R.FAILED_PRECONDITION||n.message!==Ob)throw n;F("LocalStore","Unexpectedly lost primary lease")})}var O=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&j(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,a=!1;e.forEach(c=>{++i,c.next(()=>{++s,a&&s===i&&t()},u=>r(u))}),a=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,a=new Array(s),c=0;for(let u=0;u<s;u++){let d=u;t(e[d]).next(p=>{a[d]=p,++c,c===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function Nb(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function xs(n){return n.name==="IndexedDbTransactionError"}var My=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function $a(n){return n==null}function Es(n){return n===0&&1/n==-1/0}function Mb(n){return typeof n=="number"&&Number.isInteger(n)&&!Es(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var xb=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],XP=[...xb,"documentOverlays"],Fb=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Lb=Fb,Vb=[...Lb,"indexConfiguration","indexState","indexEntries"];var ZP=[...Vb,"globals"];function Zm(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Jn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function xy(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var Ee=class n{constructor(e,t){this.comparator=e,this.root=t||Rt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Rt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new xr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new xr(this.root,e,this.comparator,!1)}getReverseIterator(){return new xr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new xr(this.root,e,this.comparator,!0)}},xr=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Rt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw j();let e=this.left.check();if(e!==this.right.check())throw j();return e+(this.isRed()?0:1)}};Rt.EMPTY=null,Rt.RED=!0,Rt.BLACK=!1;Rt.EMPTY=new class{constructor(){this.size=0}get key(){throw j()}get value(){throw j()}get color(){throw j()}get left(){throw j()}get right(){throw j()}copy(e,t,r,i,s){return this}insert(e,t,r){return new Rt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var je=class n{constructor(e){this.comparator=e,this.data=new Ee(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new fa(this.data.getIterator())}getIteratorFrom(e){return new fa(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},fa=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var ht=class n{constructor(e){this.fields=e,e.sort(et.comparator)}static empty(){return new n([])}unionWith(e){let t=new je(et.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ur(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var pa=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var ze=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new pa("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ie(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};ze.EMPTY_BYTE_STRING=new ze("");var Ub=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Yt(n){if(ue(!!n),typeof n=="string"){let e=0,t=Ub.exec(n);if(ue(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:me(n.seconds),nanos:me(n.nanos)}}function me(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function _n(n){return typeof n=="string"?ze.fromBase64String(n):ze.fromUint8Array(n)}function jd(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function zd(n){let e=n.mapValue.fields.__previous_value__;return jd(e)?zd(e):e}function Is(n){let e=Yt(n.mapValue.fields.__local_write_time__.timestampValue);return new xe(e.seconds,e.nanos)}var ph=class{constructor(e,t,r,i,s,a,c,u,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=c,this.longPollingOptions=u,this.useFetchStreams=d}},ga=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var oa={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Gn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?jd(n)?4:Ly(n)?9007199254740991:Fy(n)?10:11:j()}function Ot(n,e){if(n===e)return!0;let t=Gn(n);if(t!==Gn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Is(n).isEqual(Is(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=Yt(i.timestampValue),c=Yt(s.timestampValue);return a.seconds===c.seconds&&a.nanos===c.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return _n(i.bytesValue).isEqual(_n(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return me(i.geoPointValue.latitude)===me(s.geoPointValue.latitude)&&me(i.geoPointValue.longitude)===me(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return me(i.integerValue)===me(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=me(i.doubleValue),c=me(s.doubleValue);return a===c?Es(a)===Es(c):isNaN(a)&&isNaN(c)}return!1}(n,e);case 9:return Ur(n.arrayValue.values||[],e.arrayValue.values||[],Ot);case 10:case 11:return function(i,s){let a=i.mapValue.fields||{},c=s.mapValue.fields||{};if(Zm(a)!==Zm(c))return!1;for(let u in a)if(a.hasOwnProperty(u)&&(c[u]===void 0||!Ot(a[u],c[u])))return!1;return!0}(n,e);default:return j()}}function Ts(n,e){return(n.values||[]).find(t=>Ot(t,e))!==void 0}function Br(n,e){if(n===e)return 0;let t=Gn(n),r=Gn(e);if(t!==r)return ie(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return ie(n.booleanValue,e.booleanValue);case 2:return function(s,a){let c=me(s.integerValue||s.doubleValue),u=me(a.integerValue||a.doubleValue);return c<u?-1:c>u?1:c===u?0:isNaN(c)?isNaN(u)?0:-1:1}(n,e);case 3:return ey(n.timestampValue,e.timestampValue);case 4:return ey(Is(n),Is(e));case 5:return ie(n.stringValue,e.stringValue);case 6:return function(s,a){let c=_n(s),u=_n(a);return c.compareTo(u)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){let c=s.split("/"),u=a.split("/");for(let d=0;d<c.length&&d<u.length;d++){let p=ie(c[d],u[d]);if(p!==0)return p}return ie(c.length,u.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){let c=ie(me(s.latitude),me(a.latitude));return c!==0?c:ie(me(s.longitude),me(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return ty(n.arrayValue,e.arrayValue);case 10:return function(s,a){var c,u,d,p;let m=s.fields||{},w=a.fields||{},A=(c=m.value)===null||c===void 0?void 0:c.arrayValue,P=(u=w.value)===null||u===void 0?void 0:u.arrayValue,k=ie(((d=A?.values)===null||d===void 0?void 0:d.length)||0,((p=P?.values)===null||p===void 0?void 0:p.length)||0);return k!==0?k:ty(A,P)}(n.mapValue,e.mapValue);case 11:return function(s,a){if(s===oa.mapValue&&a===oa.mapValue)return 0;if(s===oa.mapValue)return 1;if(a===oa.mapValue)return-1;let c=s.fields||{},u=Object.keys(c),d=a.fields||{},p=Object.keys(d);u.sort(),p.sort();for(let m=0;m<u.length&&m<p.length;++m){let w=ie(u[m],p[m]);if(w!==0)return w;let A=Br(c[u[m]],d[p[m]]);if(A!==0)return A}return ie(u.length,p.length)}(n.mapValue,e.mapValue);default:throw j()}}function ey(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return ie(n,e);let t=Yt(n),r=Yt(e),i=ie(t.seconds,r.seconds);return i!==0?i:ie(t.nanos,r.nanos)}function ty(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=Br(t[i],r[i]);if(s)return s}return ie(t.length,r.length)}function $r(n){return gh(n)}function gh(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Yt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return _n(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return B.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=gh(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of r)s?s=!1:i+=",",i+=`${a}:${gh(t.fields[a])}`;return i+"}"}(n.mapValue):j()}function ny(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function mh(n){return!!n&&"integerValue"in n}function qd(n){return!!n&&"arrayValue"in n}function ry(n){return!!n&&"nullValue"in n}function iy(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ca(n){return!!n&&"mapValue"in n}function Fy(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function ms(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Jn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=ms(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=ms(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Ly(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Ze=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ca(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ms(t)}setAll(e){let t=et.emptyPath(),r={},i=[];e.forEach((a,c)=>{if(!t.isImmediateParentOf(c)){let u=this.getFieldsMap(t);this.applyChanges(u,r,i),r={},i=[],t=c.popLast()}a?r[c.lastSegment()]=ms(a):i.push(c.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());ca(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Ot(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ca(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Jn(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(ms(this.value))}};function Vy(n){let e=[];return Jn(n.fields,(t,r)=>{let i=new et([t]);if(ca(r)){let s=Vy(r.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new ht(e)}var wt=class n{constructor(e,t,r,i,s,a,c){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=c}static newInvalidDocument(e){return new n(e,0,K.min(),K.min(),K.min(),Ze.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,K.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,K.min(),K.min(),Ze.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,K.min(),K.min(),Ze.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(K.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ze.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ze.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=K.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var jr=class{constructor(e,t){this.position=e,this.inclusive=t}};function sy(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],a=n.position[i];if(s.field.isKeyField()?r=B.comparator(B.fromName(a.referenceValue),t.key):r=Br(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function oy(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Ot(n.position[t],e.position[t]))return!1;return!0}var Wn=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function Bb(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var ma=class{},Ce=class n extends ma{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new vh(e,t,r):t==="array-contains"?new Eh(e,r):t==="in"?new Ih(e,r):t==="not-in"?new Th(e,r):t==="array-contains-any"?new bh(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new _h(e,r):new wh(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(Br(t,this.value)):t!==null&&Gn(this.value)===Gn(t)&&this.matchesComparison(Br(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return j()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Et=class n extends ma{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return Uy(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function Uy(n){return n.op==="and"}function By(n){return $b(n)&&Uy(n)}function $b(n){for(let e of n.filters)if(e instanceof Et)return!1;return!0}function yh(n){if(n instanceof Ce)return n.field.canonicalString()+n.op.toString()+$r(n.value);if(By(n))return n.filters.map(e=>yh(e)).join(",");{let e=n.filters.map(t=>yh(t)).join(",");return`${n.op}(${e})`}}function $y(n,e){return n instanceof Ce?function(r,i){return i instanceof Ce&&r.op===i.op&&r.field.isEqual(i.field)&&Ot(r.value,i.value)}(n,e):n instanceof Et?function(r,i){return i instanceof Et&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,c)=>s&&$y(a,i.filters[c]),!0):!1}(n,e):void j()}function jy(n){return n instanceof Ce?function(t){return`${t.field.canonicalString()} ${t.op} ${$r(t.value)}`}(n):n instanceof Et?function(t){return t.op.toString()+" {"+t.getFilters().map(jy).join(" ,")+"}"}(n):"Filter"}var vh=class extends Ce{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},_h=class extends Ce{constructor(e,t){super(e,"in",t),this.keys=zy("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},wh=class extends Ce{constructor(e,t){super(e,"not-in",t),this.keys=zy("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function zy(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>B.fromName(r.referenceValue))}var Eh=class extends Ce{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return qd(t)&&Ts(t.arrayValue,this.value)}},Ih=class extends Ce{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Ts(this.value.arrayValue,t)}},Th=class extends Ce{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ts(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Ts(this.value.arrayValue,t)}},bh=class extends Ce{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!qd(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Ts(this.value.arrayValue,r))}};var Ch=class{constructor(e,t=null,r=[],i=[],s=null,a=null,c=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=c,this.ue=null}};function ay(n,e=null,t=[],r=[],i=null,s=null,a=null){return new Ch(n,e,t,r,i,s,a)}function Gd(n){let e=G(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>yh(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),$a(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>$r(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>$r(r)).join(",")),e.ue=t}return e.ue}function Wd(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!Bb(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!$y(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!oy(n.startAt,e.startAt)&&oy(n.endAt,e.endAt)}function Ah(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var wn=class{constructor(e,t=null,r=[],i=[],s=null,a="F",c=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=c,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function jb(n,e,t,r,i,s,a,c){return new wn(n,e,t,r,i,s,a,c)}function Hd(n){return new wn(n)}function cy(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function qy(n){return n.collectionGroup!==null}function ys(n){let e=G(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let c=new je(et.comparator);return a.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(c=c.add(d.field))})}),c})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new Wn(s,r))}),t.has(et.keyField().canonicalString())||e.ce.push(new Wn(et.keyField(),r))}return e.ce}function Pt(n){let e=G(n);return e.le||(e.le=zb(e,ys(n))),e.le}function zb(n,e){if(n.limitType==="F")return ay(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new Wn(i.field,s)});let t=n.endAt?new jr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new jr(n.startAt.position,n.startAt.inclusive):null;return ay(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Dh(n,e){let t=n.filters.concat([e]);return new wn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Sh(n,e,t){return new wn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function ja(n,e){return Wd(Pt(n),Pt(e))&&n.limitType===e.limitType}function Gy(n){return`${Gd(Pt(n))}|lt:${n.limitType}`}function Or(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>jy(i)).join(", ")}]`),$a(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>$r(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>$r(i)).join(",")),`Target(${r})`}(Pt(n))}; limitType=${n.limitType})`}function za(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):B.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of ys(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,c,u){let d=sy(a,c,u);return a.inclusive?d<=0:d<0}(r.startAt,ys(r),i)||r.endAt&&!function(a,c,u){let d=sy(a,c,u);return a.inclusive?d>=0:d>0}(r.endAt,ys(r),i))}(n,e)}function qb(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Wy(n){return(e,t)=>{let r=!1;for(let i of ys(n)){let s=Gb(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function Gb(n,e,t){let r=n.field.isKeyField()?B.comparator(e.key,t.key):function(s,a,c){let u=a.data.field(s),d=c.data.field(s);return u!==null&&d!==null?Br(u,d):j()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return j()}}var En=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Jn(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return xy(this.inner)}size(){return this.innerSize}};var Wb=new Ee(B.comparator);function Jt(){return Wb}var Hy=new Ee(B.comparator);function gs(...n){let e=Hy;for(let t of n)e=e.insert(t.key,t);return e}function Ky(n){let e=Hy;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Bn(){return vs()}function Qy(){return vs()}function vs(){return new En(n=>n.toString(),(n,e)=>n.isEqual(e))}var Hb=new Ee(B.comparator),Kb=new je(B.comparator);function Z(...n){let e=Kb;for(let t of n)e=e.add(t);return e}var Qb=new je(ie);function Yb(){return Qb}function Kd(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Es(e)?"-0":e}}function Yy(n){return{integerValue:""+n}}function Jb(n,e){return Mb(e)?Yy(e):Kd(n,e)}var zr=class{constructor(){this._=void 0}};function Xb(n,e,t){return n instanceof qr?function(i,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&jd(s)&&(s=zd(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof Hn?Xy(n,e):n instanceof Kn?Zy(n,e):function(i,s){let a=Jy(i,s),c=uy(a)+uy(i.Pe);return mh(a)&&mh(i.Pe)?Yy(c):Kd(i.serializer,c)}(n,e)}function Zb(n,e,t){return n instanceof Hn?Xy(n,e):n instanceof Kn?Zy(n,e):t}function Jy(n,e){return n instanceof Gr?function(r){return mh(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var qr=class extends zr{},Hn=class extends zr{constructor(e){super(),this.elements=e}};function Xy(n,e){let t=ev(e);for(let r of n.elements)t.some(i=>Ot(i,r))||t.push(r);return{arrayValue:{values:t}}}var Kn=class extends zr{constructor(e){super(),this.elements=e}};function Zy(n,e){let t=ev(e);for(let r of n.elements)t=t.filter(i=>!Ot(i,r));return{arrayValue:{values:t}}}var Gr=class extends zr{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function uy(n){return me(n.integerValue||n.doubleValue)}function ev(n){return qd(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function eC(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof Hn&&i instanceof Hn||r instanceof Kn&&i instanceof Kn?Ur(r.elements,i.elements,Ot):r instanceof Gr&&i instanceof Gr?Ot(r.Pe,i.Pe):r instanceof qr&&i instanceof qr}(n.transform,e.transform)}var Rh=class{constructor(e,t){this.version=e,this.transformResults=t}},Kt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function ua(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var Wr=class{};function tv(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new bs(n.key,Kt.none()):new Qn(n.key,n.data,Kt.none());{let t=n.data,r=Ze.empty(),i=new je(et.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new Nt(n.key,r,new ht(i.toArray()),Kt.none())}}function tC(n,e,t){n instanceof Qn?function(i,s,a){let c=i.value.clone(),u=hy(i.fieldTransforms,s,a.transformResults);c.setAll(u),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(n,e,t):n instanceof Nt?function(i,s,a){if(!ua(i.precondition,s))return void s.convertToUnknownDocument(a.version);let c=hy(i.fieldTransforms,s,a.transformResults),u=s.data;u.setAll(nv(i)),u.setAll(c),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function _s(n,e,t,r){return n instanceof Qn?function(s,a,c,u){if(!ua(s.precondition,a))return c;let d=s.value.clone(),p=dy(s.fieldTransforms,u,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof Nt?function(s,a,c,u){if(!ua(s.precondition,a))return c;let d=dy(s.fieldTransforms,u,a),p=a.data;return p.setAll(nv(s)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),c===null?null:c.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(s,a,c){return ua(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):c}(n,e,t)}function nC(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=Jy(r.transform,i||null);s!=null&&(t===null&&(t=Ze.empty()),t.set(r.field,s))}return t||null}function ly(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ur(r,i,(s,a)=>eC(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var Qn=class extends Wr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},Nt=class extends Wr{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function nv(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function hy(n,e,t){let r=new Map;ue(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],a=s.transform,c=e.data.field(s.field);r.set(s.field,Zb(a,c,t[i]))}return r}function dy(n,e,t){let r=new Map;for(let i of n){let s=i.transform,a=t.data.field(i.field);r.set(i.field,Xb(s,a,e))}return r}var bs=class extends Wr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Ph=class extends Wr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var kh=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&tC(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=_s(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=_s(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=Qy();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,c=this.applyToLocalView(a,s.mutatedFields);c=t.has(i.key)?null:c;let u=tv(a,c);u!==null&&r.set(i.key,u),a.isValidDocument()||a.convertToNoDocument(K.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Z())}isEqual(e){return this.batchId===e.batchId&&Ur(this.mutations,e.mutations,(t,r)=>ly(t,r))&&Ur(this.baseMutations,e.baseMutations,(t,r)=>ly(t,r))}},Oh=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){ue(e.mutations.length===r.length);let i=function(){return Hb}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new n(e,t,r,i)}};var Nh=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Mh=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var Te,te;function rC(n){switch(n){default:return j();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function rv(n){if(n===void 0)return Qt("GRPC error has no .code"),R.UNKNOWN;switch(n){case Te.OK:return R.OK;case Te.CANCELLED:return R.CANCELLED;case Te.UNKNOWN:return R.UNKNOWN;case Te.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case Te.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case Te.INTERNAL:return R.INTERNAL;case Te.UNAVAILABLE:return R.UNAVAILABLE;case Te.UNAUTHENTICATED:return R.UNAUTHENTICATED;case Te.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case Te.NOT_FOUND:return R.NOT_FOUND;case Te.ALREADY_EXISTS:return R.ALREADY_EXISTS;case Te.PERMISSION_DENIED:return R.PERMISSION_DENIED;case Te.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case Te.ABORTED:return R.ABORTED;case Te.OUT_OF_RANGE:return R.OUT_OF_RANGE;case Te.UNIMPLEMENTED:return R.UNIMPLEMENTED;case Te.DATA_LOSS:return R.DATA_LOSS;default:return j()}}(te=Te||(Te={}))[te.OK=0]="OK",te[te.CANCELLED=1]="CANCELLED",te[te.UNKNOWN=2]="UNKNOWN",te[te.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",te[te.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",te[te.NOT_FOUND=5]="NOT_FOUND",te[te.ALREADY_EXISTS=6]="ALREADY_EXISTS",te[te.PERMISSION_DENIED=7]="PERMISSION_DENIED",te[te.UNAUTHENTICATED=16]="UNAUTHENTICATED",te[te.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",te[te.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",te[te.ABORTED=10]="ABORTED",te[te.OUT_OF_RANGE=11]="OUT_OF_RANGE",te[te.UNIMPLEMENTED=12]="UNIMPLEMENTED",te[te.INTERNAL=13]="INTERNAL",te[te.UNAVAILABLE=14]="UNAVAILABLE",te[te.DATA_LOSS=15]="DATA_LOSS";var fy=null;function iC(){return new TextEncoder}var sC=new yn([4294967295,4294967295],0);function py(n){let e=iC().encode(n),t=new Kl;return t.update(e),new Uint8Array(t.digest())}function gy(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new yn([t,r],0),new yn([i,s],0)]}var xh=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new $n(`Invalid padding: ${t}`);if(r<0)throw new $n(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new $n(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new $n(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=yn.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(yn.fromNumber(r)));return i.compare(sC)===1&&(i=new yn([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=py(e),[r,i]=gy(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);if(!this.de(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,i,t);return r.forEach(c=>a.insert(c)),a}insert(e){if(this.Ie===0)return;let t=py(e),[r,i]=gy(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},$n=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var ya=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Cs.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(K.min(),i,new Ee(ie),Jt(),Z())}},Cs=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,Z(),Z(),Z())}};var Fr=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},va=class{constructor(e,t){this.targetId=e,this.me=t}},_a=class{constructor(e,t,r=ze.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},wa=class{constructor(){this.fe=0,this.ge=yy(),this.pe=ze.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Z(),t=Z(),r=Z();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:j()}}),new Cs(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=yy()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ue(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Fh=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Jt(),this.qe=my(),this.Qe=new Ee(ie)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:j()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(Ah(s))if(r===0){let a=new B(s.path);this.Ue(t,a,wt.newNoDocument(a,K.min()))}else ue(r===1);else{let a=this.Ye(t);if(a!==r){let c=this.Ze(e),u=c?this.Xe(c,e,a):1;if(u!==0){this.je(t);let d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}fy?.et(function(p,m,w,A,P){var k,S,U,q,L,se;let ye={localCacheCount:p,existenceFilterCount:m.count,databaseId:w.database,projectId:w.projectId},ee=m.unchangedNames;return ee&&(ye.bloomFilter={applied:P===0,hashCount:(k=ee?.hashCount)!==null&&k!==void 0?k:0,bitmapLength:(q=(U=(S=ee?.bits)===null||S===void 0?void 0:S.bitmap)===null||U===void 0?void 0:U.length)!==null&&q!==void 0?q:0,padding:(se=(L=ee?.bits)===null||L===void 0?void 0:L.padding)!==null&&se!==void 0?se:0,mightContain:E=>{var g;return(g=A?.mightContain(E))!==null&&g!==void 0&&g}}),ye}(a,e.me,this.Le.tt(),c,u))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,a,c;try{a=_n(r).toUint8Array()}catch(u){if(u instanceof pa)return Vr("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{c=new xh(a,i,s)}catch(u){return Vr(u instanceof $n?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return c.Ie===0?null:c}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let a=this.Le.tt(),c=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(c)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,a)=>{let c=this.Je(a);if(c){if(s.current&&Ah(c.target)){let u=new B(c.target.path);this.ke.get(u)!==null||this.it(a,u)||this.Ue(a,u,wt.newNoDocument(u,e))}s.be&&(t.set(a,s.ve()),s.Ce())}});let r=Z();this.qe.forEach((s,a)=>{let c=!0;a.forEachWhile(u=>{let d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(c=!1,!1)}),c&&(r=r.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));let i=new ya(e,t,this.Qe,this.ke,r);return this.ke=Jt(),this.qe=my(),this.Qe=new Ee(ie),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new wa,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new je(ie),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||F("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new wa),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function my(){return new Ee(B.comparator)}function yy(){return new Ee(B.comparator)}var oC={asc:"ASCENDING",desc:"DESCENDING"},aC={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},cC={and:"AND",or:"OR"},Lh=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function Vh(n,e){return n.useProto3Json||$a(e)?e:{value:e}}function Ea(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function iv(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function uC(n,e){return Ea(n,e.toTimestamp())}function kt(n){return ue(!!n),K.fromTimestamp(function(t){let r=Yt(t);return new xe(r.seconds,r.nanos)}(n))}function Qd(n,e){return Uh(n,e).canonicalString()}function Uh(n,e){let t=function(i){return new ve(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function sv(n){let e=ve.fromString(n);return ue(lv(e)),e}function Bh(n,e){return Qd(n.databaseId,e.path)}function eh(n,e){let t=sv(e);if(t.get(1)!==n.databaseId.projectId)throw new x(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new x(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(av(t))}function ov(n,e){return Qd(n.databaseId,e)}function lC(n){let e=sv(n);return e.length===4?ve.emptyPath():av(e)}function $h(n){return new ve(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function av(n){return ue(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function vy(n,e,t){return{name:Bh(n,e),fields:t.value.mapValue.fields}}function hC(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:j()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,p){return d.useProto3Json?(ue(p===void 0||typeof p=="string"),ze.fromBase64String(p||"")):(ue(p===void 0||p instanceof Buffer||p instanceof Uint8Array),ze.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,c=a&&function(d){let p=d.code===void 0?R.UNKNOWN:rv(d.code);return new x(p,d.message||"")}(a);t=new _a(r,i,s,c||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=eh(n,r.document.name),s=kt(r.document.updateTime),a=r.document.createTime?kt(r.document.createTime):K.min(),c=new Ze({mapValue:{fields:r.document.fields}}),u=wt.newFoundDocument(i,s,a,c),d=r.targetIds||[],p=r.removedTargetIds||[];t=new Fr(d,p,u.key,u)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=eh(n,r.document),s=r.readTime?kt(r.readTime):K.min(),a=wt.newNoDocument(i,s),c=r.removedTargetIds||[];t=new Fr([],c,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=eh(n,r.document),s=r.removedTargetIds||[];t=new Fr([],s,i,null)}else{if(!("filter"in e))return j();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,a=new Mh(i,s),c=r.targetId;t=new va(c,a)}}return t}function dC(n,e){let t;if(e instanceof Qn)t={update:vy(n,e.key,e.value)};else if(e instanceof bs)t={delete:Bh(n,e.key)};else if(e instanceof Nt)t={update:vy(n,e.key,e.data),updateMask:EC(e.fieldMask)};else{if(!(e instanceof Ph))return j();t={verify:Bh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){let c=a.transform;if(c instanceof qr)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Hn)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Kn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Gr)return{fieldPath:a.field.canonicalString(),increment:c.Pe};throw j()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:uC(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:j()}(n,e.precondition)),t}function fC(n,e){return n&&n.length>0?(ue(e!==void 0),n.map(t=>function(i,s){let a=i.updateTime?kt(i.updateTime):kt(s);return a.isEqual(K.min())&&(a=kt(s)),new Rh(a,i.transformResults||[])}(t,e))):[]}function pC(n,e){return{documents:[ov(n,e.path)]}}function gC(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=ov(n,i);let s=function(d){if(d.length!==0)return uv(Et.create(d,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(d){if(d.length!==0)return d.map(p=>function(w){return{field:Nr(w.field),direction:vC(w.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let c=Vh(n,e.limit);return c!==null&&(t.structuredQuery.limit=c),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function mC(n){let e=lC(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){ue(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(m){let w=cv(m);return w instanceof Et&&By(w)?w.getFilters():[w]}(t.where));let a=[];t.orderBy&&(a=function(m){return m.map(w=>function(P){return new Wn(Mr(P.field),function(S){switch(S){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(P.direction))}(w))}(t.orderBy));let c=null;t.limit&&(c=function(m){let w;return w=typeof m=="object"?m.value:m,$a(w)?null:w}(t.limit));let u=null;t.startAt&&(u=function(m){let w=!!m.before,A=m.values||[];return new jr(A,w)}(t.startAt));let d=null;return t.endAt&&(d=function(m){let w=!m.before,A=m.values||[];return new jr(A,w)}(t.endAt)),jb(e,i,a,s,c,"F",u,d)}function yC(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return j()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function cv(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Mr(t.unaryFilter.field);return Ce.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Mr(t.unaryFilter.field);return Ce.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Mr(t.unaryFilter.field);return Ce.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Mr(t.unaryFilter.field);return Ce.create(a,"!=",{nullValue:"NULL_VALUE"});default:return j()}}(n):n.fieldFilter!==void 0?function(t){return Ce.create(Mr(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return j()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return Et.create(t.compositeFilter.filters.map(r=>cv(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return j()}}(t.compositeFilter.op))}(n):j()}function vC(n){return oC[n]}function _C(n){return aC[n]}function wC(n){return cC[n]}function Nr(n){return{fieldPath:n.canonicalString()}}function Mr(n){return et.fromServerFormat(n.fieldPath)}function uv(n){return n instanceof Ce?function(t){if(t.op==="=="){if(iy(t.value))return{unaryFilter:{field:Nr(t.field),op:"IS_NAN"}};if(ry(t.value))return{unaryFilter:{field:Nr(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(iy(t.value))return{unaryFilter:{field:Nr(t.field),op:"IS_NOT_NAN"}};if(ry(t.value))return{unaryFilter:{field:Nr(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Nr(t.field),op:_C(t.op),value:t.value}}}(n):n instanceof Et?function(t){let r=t.getFilters().map(i=>uv(i));return r.length===1?r[0]:{compositeFilter:{op:wC(t.op),filters:r}}}(n):j()}function EC(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function lv(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var As=class n{constructor(e,t,r,i,s=K.min(),a=K.min(),c=ze.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=c,this.expectedCount=u}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var jh=class{constructor(e){this.ct=e}};function IC(n){let e=mC({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Sh(e,e.limit,"L"):e}var Ia=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(me(e.integerValue));else if("doubleValue"in e){let r=me(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Es(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Yt(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(_n(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?Ly(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Fy(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):j()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let s=e.fields||{};this.dt(t,53);let a="value",c=((i=(r=s[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(me(c)),this.Vt(a,t),this.Tt(s[a],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),B.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Ia.vt=new Ia;var zh=class{constructor(){this.un=new qh}addToCollectionParentIndex(e,t){return this.un.add(t),O.resolve()}getCollectionParents(e,t){return O.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return O.resolve()}deleteFieldIndex(e,t){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,t){return O.resolve()}getDocumentsMatchingTarget(e,t){return O.resolve(null)}getIndexType(e,t){return O.resolve(0)}getFieldIndexes(e,t){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,t){return O.resolve(qn.min())}getMinOffsetFromCollectionGroup(e,t){return O.resolve(qn.min())}updateCollectionGroup(e,t,r){return O.resolve()}updateIndexEntries(e,t){return O.resolve()}},qh=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new je(ve.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new je(ve.comparator)).toArray()}};var tk=new Uint8Array(0);var St=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};St.DEFAULT_COLLECTION_PERCENTILE=10,St.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,St.DEFAULT=new St(41943040,St.DEFAULT_COLLECTION_PERCENTILE,St.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),St.DISABLED=new St(-1,0,0);var Ds=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var Gh=class{constructor(){this.changes=new En(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,wt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?O.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var Wh=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var Hh=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&_s(r.mutation,i,ht.empty(),xe.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Z()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Z()){let i=Bn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=gs();return s.forEach((c,u)=>{a=a.insert(c,u.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=Bn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Z()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,c)=>{t.set(a,c)})})}computeViews(e,t,r,i){let s=Jt(),a=vs(),c=function(){return vs()}();return t.forEach((u,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof Nt)?s=s.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),_s(p.mutation,d,p.mutation.getFieldMask(),xe.now())):a.set(d.key,ht.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var m;return c.set(d,new Wh(p,(m=a.get(d))!==null&&m!==void 0?m:null))}),c))}recalculateAndSaveOverlays(e,t){let r=vs(),i=new Ee((a,c)=>a-c),s=Z();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let c of a)c.keys().forEach(u=>{let d=t.get(u);if(d===null)return;let p=r.get(u)||ht.empty();p=c.applyToLocalView(d,p),r.set(u,p);let m=(i.get(c.batchId)||Z()).add(u);i=i.insert(c.batchId,m)})}).next(()=>{let a=[],c=i.getReverseIterator();for(;c.hasNext();){let u=c.getNext(),d=u.key,p=u.value,m=Qy();p.forEach(w=>{if(!s.has(w)){let A=tv(t.get(w),r.get(w));A!==null&&m.set(w,A),s=s.add(w)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,m))}return O.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return B.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):qy(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):O.resolve(Bn()),c=-1,u=s;return a.next(d=>O.forEach(d,(p,m)=>(c<m.largestBatchId&&(c=m.largestBatchId),s.get(p)?O.resolve():this.remoteDocumentCache.getEntry(e,p).next(w=>{u=u.insert(p,w)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,u,d,Z())).next(p=>({batchId:c,changes:Ky(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(r=>{let i=gs();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,a=gs();return this.indexManager.getCollectionParents(e,s).next(c=>O.forEach(c,u=>{let d=function(m,w){return new wn(w,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((m,w)=>{a=a.insert(m,w)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((u,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,wt.newInvalidDocument(p)))});let c=gs();return a.forEach((u,d)=>{let p=s.get(u);p!==void 0&&_s(p.mutation,d,ht.empty(),xe.now()),za(t,d)&&(c=c.insert(u,d))}),c})}};var Kh=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return O.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:kt(i.createTime)}}(t)),O.resolve()}getNamedQuery(e,t){return O.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:IC(i.bundledQuery),readTime:kt(i.readTime)}}(t)),O.resolve()}};var Qh=class{constructor(){this.overlays=new Ee(B.comparator),this.Ir=new Map}getOverlay(e,t){return O.resolve(this.overlays.get(t))}getOverlays(e,t){let r=Bn();return O.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),O.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),O.resolve()}getOverlaysForCollection(e,t,r){let i=Bn(),s=t.length+1,a=new B(t.child("")),c=this.overlays.getIteratorFrom(a);for(;c.hasNext();){let u=c.getNext().value,d=u.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&u.largestBatchId>r&&i.set(u.getKey(),u)}return O.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Ee((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=Bn(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let c=Bn(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,p)=>c.set(d,p)),!(c.size()>=i)););return O.resolve(c)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new Nh(t,r));let s=this.Ir.get(t);s===void 0&&(s=Z(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}};var Yh=class{constructor(){this.sessionToken=ze.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,O.resolve()}};var Ss=class{constructor(){this.Tr=new je(be.Er),this.dr=new je(be.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new be(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new be(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new B(new ve([])),r=new be(t,e),i=new be(t,e+1),s=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new B(new ve([])),r=new be(t,e),i=new be(t,e+1),s=Z();return this.dr.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new be(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},be=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return B.comparator(e.key,t.key)||ie(e.wr,t.wr)}static Ar(e,t){return ie(e.wr,t.wr)||B.comparator(e.key,t.key)}};var Jh=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new je(be.Er)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new kh(s,t,r,i);this.mutationQueue.push(a);for(let c of i)this.br=this.br.add(new be(c.key,s)),this.indexManager.addToCollectionParentIndex(e,c.key.path.popLast());return O.resolve(a)}lookupMutationBatch(e,t){return O.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),s=i<0?0:i;return O.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new be(t,0),i=new be(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],a=>{let c=this.Dr(a.wr);s.push(c)}),O.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new je(ie);return t.forEach(i=>{let s=new be(i,0),a=new be(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],c=>{r=r.add(c.wr)})}),O.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;B.isDocumentKey(s)||(s=s.child(""));let a=new be(new B(s),0),c=new je(ie);return this.br.forEachWhile(u=>{let d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(c=c.add(u.wr)),!0)},a),O.resolve(this.Cr(c))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){ue(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return O.forEach(t.mutations,i=>{let s=new be(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new be(t,0),i=this.br.firstAfterOrEqual(r);return O.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Xh=class{constructor(e){this.Mr=e,this.docs=function(){return new Ee(B.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return O.resolve(r?r.document.mutableCopy():wt.newInvalidDocument(t))}getEntries(e,t){let r=Jt();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():wt.newInvalidDocument(i))}),O.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Jt(),a=t.path,c=new B(a.child("")),u=this.docs.getIteratorFrom(c);for(;u.hasNext();){let{key:d,value:{document:p}}=u.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||kb(Pb(p),r)<=0||(i.has(p.key)||za(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return O.resolve(s)}getAllFromCollectionGroup(e,t,r,i){j()}Or(e,t){return O.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Zh(this)}getSize(e){return O.resolve(this.size)}},Zh=class extends Gh{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),O.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var ed=class{constructor(e){this.persistence=e,this.Nr=new En(t=>Gd(t),Wd),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ss,this.targetCount=0,this.kr=Ds.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),O.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Ds(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,O.resolve()}updateTargetData(e,t){return this.Kn(t),O.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Nr.forEach((a,c)=>{c.sequenceNumber<=t&&r.get(c.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,c.targetId)),i++)}),O.waitFor(s).next(()=>i)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return O.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),O.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),O.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),O.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return O.resolve(r)}containsKey(e,t){return O.resolve(this.Br.containsKey(t))}};var td=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new My(0),this.Kr=!1,this.Kr=!0,this.$r=new Yh,this.referenceDelegate=e(this),this.Ur=new ed(this),this.indexManager=new zh,this.remoteDocumentCache=function(i){return new Xh(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new jh(t),this.Gr=new Kh(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Qh,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new Jh(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){F("MemoryPersistence","Starting transaction:",e);let i=new nd(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return O.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},nd=class extends fh{constructor(e){super(),this.currentSequenceNumber=e}},rd=class n{constructor(e){this.persistence=e,this.Jr=new Ss,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw j()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),O.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),O.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.Xr,r=>{let i=B.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,K.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return O.or([()=>O.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var id=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=Z(),i=Z();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var sd=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var od=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return fm()?8:Nb(Xe())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Yi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new sd;return this.Xi(e,t,a).next(c=>{if(s.result=c,this.zi)return this.es(e,t,a,c.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(ps()<=X.DEBUG&&F("QueryEngine","SDK will not create cache indexes for query:",Or(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),O.resolve()):(ps()<=X.DEBUG&&F("QueryEngine","Query:",Or(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(ps()<=X.DEBUG&&F("QueryEngine","The SDK decides to create cache indexes for query:",Or(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Pt(t))):O.resolve())}Yi(e,t){if(cy(t))return O.resolve(null);let r=Pt(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Sh(t,null,"F"),r=Pt(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let a=Z(...s);return this.Ji.getDocuments(e,a).next(c=>this.indexManager.getMinOffset(e,r).next(u=>{let d=this.ts(t,c);return this.ns(t,d,a,u.readTime)?this.Yi(e,Sh(t,null,"F")):this.rs(e,d,t,u)}))})))}Zi(e,t,r,i){return cy(t)||i.isEqual(K.min())?O.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let a=this.ts(t,s);return this.ns(t,a,r,i)?O.resolve(null):(ps()<=X.DEBUG&&F("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Or(t)),this.rs(e,a,t,Rb(i,-1)).next(c=>c))})}ts(e,t){let r=new je(Wy(e));return t.forEach((i,s)=>{za(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return ps()<=X.DEBUG&&F("QueryEngine","Using full collection scan to execute query:",Or(t)),this.Ji.getDocumentsMatchingQuery(e,t,qn.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var ad=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Ee(ie),this._s=new En(s=>Gd(s),Wd),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Hh(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function TC(n,e,t,r){return new ad(n,e,t,r)}function hv(n,e){return C(this,null,function*(){let t=G(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let a=[],c=[],u=Z();for(let d of i){a.push(d.batchId);for(let p of d.mutations)u=u.add(p.key)}for(let d of s){c.push(d.batchId);for(let p of d.mutations)u=u.add(p.key)}return t.localDocuments.getDocuments(r,u).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:c}))})})})}function bC(n,e){let t=G(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(c,u,d,p){let m=d.batch,w=m.keys(),A=O.resolve();return w.forEach(P=>{A=A.next(()=>p.getEntry(u,P)).next(k=>{let S=d.docVersions.get(P);ue(S!==null),k.version.compareTo(S)<0&&(m.applyToRemoteDocument(k,d),k.isValidDocument()&&(k.setReadTime(d.commitVersion),p.addEntry(k)))})}),A.next(()=>c.mutationQueue.removeMutationBatch(u,m))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(c){let u=Z();for(let d=0;d<c.mutationResults.length;++d)c.mutationResults[d].transformResults.length>0&&(u=u.add(c.batch.mutations[d].key));return u}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function dv(n){let e=G(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function CC(n,e){let t=G(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let c=[];e.targetChanges.forEach((p,m)=>{let w=i.get(m);if(!w)return;c.push(t.Ur.removeMatchingKeys(s,p.removedDocuments,m).next(()=>t.Ur.addMatchingKeys(s,p.addedDocuments,m)));let A=w.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?A=A.withResumeToken(ze.EMPTY_BYTE_STRING,K.min()).withLastLimboFreeSnapshotVersion(K.min()):p.resumeToken.approximateByteSize()>0&&(A=A.withResumeToken(p.resumeToken,r)),i=i.insert(m,A),function(k,S,U){return k.resumeToken.approximateByteSize()===0||S.snapshotVersion.toMicroseconds()-k.snapshotVersion.toMicroseconds()>=3e8?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0}(w,A,p)&&c.push(t.Ur.updateTargetData(s,A))});let u=Jt(),d=Z();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&c.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),c.push(AC(s,a,e.documentUpdates).next(p=>{u=p.Ps,d=p.Is})),!r.isEqual(K.min())){let p=t.Ur.getLastRemoteSnapshotVersion(s).next(m=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));c.push(p)}return O.waitFor(c).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,d)).next(()=>u)}).then(s=>(t.os=i,s))}function AC(n,e,t){let r=Z(),i=Z();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=Jt();return t.forEach((c,u)=>{let d=s.get(c);u.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(c)),u.isNoDocument()&&u.version.isEqual(K.min())?(e.removeEntry(c,u.readTime),a=a.insert(c,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),a=a.insert(c,u)):F("LocalStore","Ignoring outdated watch update for ",c,". Current version:",d.version," Watch version:",u.version)}),{Ps:a,Is:i}})}function DC(n,e){let t=G(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function SC(n,e){let t=G(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,O.resolve(i)):t.Ur.allocateTargetId(r).next(a=>(i=new As(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function cd(n,e,t){return C(this,null,function*(){let r=G(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!xs(a))throw a;F("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function _y(n,e,t){let r=G(n),i=K.min(),s=Z();return r.persistence.runTransaction("Execute query","readwrite",a=>function(u,d,p){let m=G(u),w=m._s.get(p);return w!==void 0?O.resolve(m.os.get(w)):m.Ur.getTargetData(d,p)}(r,a,Pt(e)).next(c=>{if(c)return i=c.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,c.targetId).next(u=>{s=u})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,t?i:K.min(),t?s:Z())).next(c=>(RC(r,qb(e),c),{documents:c,Ts:s})))}function RC(n,e,t){let r=n.us.get(e)||K.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}var Ta=class{constructor(){this.activeTargetIds=Yb()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var ud=class{constructor(){this.so=new Ta,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Ta,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var ld=class{_o(e){}shutdown(){}};var ba=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){F("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){F("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var aa=null;function th(){return aa===null?aa=function(){return 268435456+Math.round(2147483648*Math.random())}():aa++,"0x"+aa.toString(16)}var PC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var hd=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var $e="WebChannelConnection",dd=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,a){let c=th(),u=this.xo(t,r.toUriEncodedString());F("RestConnection",`Sending RPC '${t}' ${c}:`,u,i);let d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,s,a),this.No(t,u,d,i).then(p=>(F("RestConnection",`Received RPC '${t}' ${c}: `,p),p),p=>{throw Vr("RestConnection",`RPC '${t}' ${c} failed with error: `,p,"url: ",u,"request:",i),p})}Lo(t,r,i,s,a,c){return this.Mo(t,r,i,s,a)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Jr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}xo(t,r){let i=PC[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let s=th();return new Promise((a,c)=>{let u=new Ql;u.setWithCredentials(!0),u.listenOnce(Yl.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case fs.NO_ERROR:let p=u.getResponseJson();F($e,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case fs.TIMEOUT:F($e,`RPC '${e}' ${s} timed out`),c(new x(R.DEADLINE_EXCEEDED,"Request time out"));break;case fs.HTTP_ERROR:let m=u.getStatus();if(F($e,`RPC '${e}' ${s} failed with status:`,m,"response text:",u.getResponseText()),m>0){let w=u.getResponseJson();Array.isArray(w)&&(w=w[0]);let A=w?.error;if(A&&A.status&&A.message){let P=function(S){let U=S.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(U)>=0?U:R.UNKNOWN}(A.status);c(new x(P,A.message))}else c(new x(R.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new x(R.UNAVAILABLE,"Connection failed."));break;default:j()}}finally{F($e,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(i);F($e,`RPC '${e}' ${s} sending request:`,i),u.send(t,"POST",d,r,15)})}Bo(e,t,r){let i=th(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Zl(),c=Xl(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,t,r),u.encodeInitMessageHeaders=!0;let p=s.join("");F($e,`Creating RPC '${e}' stream ${i}: ${p}`,u);let m=a.createWebChannel(p,u),w=!1,A=!1,P=new hd({Io:S=>{A?F($e,`Not sending because RPC '${e}' stream ${i} is closed:`,S):(w||(F($e,`Opening RPC '${e}' stream ${i} transport.`),m.open(),w=!0),F($e,`RPC '${e}' stream ${i} sending:`,S),m.send(S))},To:()=>m.close()}),k=(S,U,q)=>{S.listen(U,L=>{try{q(L)}catch(se){setTimeout(()=>{throw se},0)}})};return k(m,kr.EventType.OPEN,()=>{A||(F($e,`RPC '${e}' stream ${i} transport opened.`),P.yo())}),k(m,kr.EventType.CLOSE,()=>{A||(A=!0,F($e,`RPC '${e}' stream ${i} transport closed`),P.So())}),k(m,kr.EventType.ERROR,S=>{A||(A=!0,Vr($e,`RPC '${e}' stream ${i} transport errored:`,S),P.So(new x(R.UNAVAILABLE,"The operation could not be completed")))}),k(m,kr.EventType.MESSAGE,S=>{var U;if(!A){let q=S.data[0];ue(!!q);let L=q,se=L.error||((U=L[0])===null||U===void 0?void 0:U.error);if(se){F($e,`RPC '${e}' stream ${i} received error:`,se);let ye=se.status,ee=function(v){let _=Te[v];if(_!==void 0)return rv(_)}(ye),E=se.message;ee===void 0&&(ee=R.INTERNAL,E="Unknown error status: "+ye+" with message "+se.message),A=!0,P.So(new x(ee,E)),m.close()}else F($e,`RPC '${e}' stream ${i} received:`,q),P.bo(q)}}),k(c,Jl.STAT_EVENT,S=>{S.stat===sa.PROXY?F($e,`RPC '${e}' stream ${i} detected buffering proxy`):S.stat===sa.NOPROXY&&F($e,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{P.wo()},0),P}};function nh(){return typeof document<"u"?document:null}function qa(n){return new Lh(n,!0)}var Ca=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&F("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Aa=class{constructor(e,t,r,i,s,a,c,u){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=c,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Ca(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return C(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return C(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return C(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(Qt(t.toString()),Qt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new x(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>C(this,null,function*(){this.state=0,this.start()}))}I_(e){return F("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(F("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},fd=class extends Aa{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=hC(this.serializer,e),r=function(s){if(!("targetChange"in s))return K.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?K.min():a.readTime?kt(a.readTime):K.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=$h(this.serializer),t.addTarget=function(s,a){let c,u=a.target;if(c=Ah(u)?{documents:pC(s,u)}:{query:gC(s,u)._t},c.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){c.resumeToken=iv(s,a.resumeToken);let d=Vh(s,a.expectedCount);d!==null&&(c.expectedCount=d)}else if(a.snapshotVersion.compareTo(K.min())>0){c.readTime=Ea(s,a.snapshotVersion.toTimestamp());let d=Vh(s,a.expectedCount);d!==null&&(c.expectedCount=d)}return c}(this.serializer,e);let r=yC(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=$h(this.serializer),t.removeTarget=e,this.a_(t)}},pd=class extends Aa{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return ue(!!e.streamToken),this.lastStreamToken=e.streamToken,ue(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ue(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=fC(e.writeResults,e.commitTime),r=kt(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=$h(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>dC(this.serializer,r))};this.a_(t)}};var gd=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new x(R.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,Uh(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new x(R.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,c])=>this.connection.Lo(e,Uh(t,r),i,a,c,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new x(R.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},md=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Qt(t),this.D_=!1):F("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var yd=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{r.enqueueAndForget(()=>C(this,null,function*(){Xn(this)&&(F("RemoteStore","Restarting streams for network reachability change."),yield function(u){return C(this,null,function*(){let d=G(u);d.L_.add(4),yield Fs(d),d.q_.set("Unknown"),d.L_.delete(4),yield Ga(d)})}(this))}))}),this.q_=new md(r,i)}};function Ga(n){return C(this,null,function*(){if(Xn(n))for(let e of n.B_)yield e(!0)})}function Fs(n){return C(this,null,function*(){for(let e of n.B_)yield e(!1)})}function fv(n,e){let t=G(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Zd(t)?Xd(t):Xr(t).r_()&&Jd(t,e))}function Yd(n,e){let t=G(n),r=Xr(t);t.N_.delete(e),r.r_()&&pv(t,e),t.N_.size===0&&(r.r_()?r.o_():Xn(t)&&t.q_.set("Unknown"))}function Jd(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(K.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Xr(n).A_(e)}function pv(n,e){n.Q_.xe(e),Xr(n).R_(e)}function Xd(n){n.Q_=new Fh({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),Xr(n).start(),n.q_.v_()}function Zd(n){return Xn(n)&&!Xr(n).n_()&&n.N_.size>0}function Xn(n){return G(n).L_.size===0}function gv(n){n.Q_=void 0}function kC(n){return C(this,null,function*(){n.q_.set("Online")})}function OC(n){return C(this,null,function*(){n.N_.forEach((e,t)=>{Jd(n,e)})})}function NC(n,e){return C(this,null,function*(){gv(n),Zd(n)?(n.q_.M_(e),Xd(n)):n.q_.set("Unknown")})}function MC(n,e,t){return C(this,null,function*(){if(n.q_.set("Online"),e instanceof _a&&e.state===2&&e.cause)try{yield function(i,s){return C(this,null,function*(){let a=s.cause;for(let c of s.targetIds)i.N_.has(c)&&(yield i.remoteSyncer.rejectListen(c,a),i.N_.delete(c),i.Q_.removeTarget(c))})}(n,e)}catch(r){F("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Da(n,r)}else if(e instanceof Fr?n.Q_.Ke(e):e instanceof va?n.Q_.He(e):n.Q_.We(e),!t.isEqual(K.min()))try{let r=yield dv(n.localStore);t.compareTo(r)>=0&&(yield function(s,a){let c=s.Q_.rt(a);return c.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){let p=s.N_.get(d);p&&s.N_.set(d,p.withResumeToken(u.resumeToken,a))}}),c.targetMismatches.forEach((u,d)=>{let p=s.N_.get(u);if(!p)return;s.N_.set(u,p.withResumeToken(ze.EMPTY_BYTE_STRING,p.snapshotVersion)),pv(s,u);let m=new As(p.target,u,d,p.sequenceNumber);Jd(s,m)}),s.remoteSyncer.applyRemoteEvent(c)}(n,t))}catch(r){F("RemoteStore","Failed to raise snapshot:",r),yield Da(n,r)}})}function Da(n,e,t){return C(this,null,function*(){if(!xs(e))throw e;n.L_.add(1),yield Fs(n),n.q_.set("Offline"),t||(t=()=>dv(n.localStore)),n.asyncQueue.enqueueRetryable(()=>C(this,null,function*(){F("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Ga(n)}))})}function mv(n,e){return e().catch(t=>Da(n,t,e))}function Wa(n){return C(this,null,function*(){let e=G(n),t=In(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;xC(e);)try{let i=yield DC(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,FC(e,i)}catch(i){yield Da(e,i)}yv(e)&&vv(e)})}function xC(n){return Xn(n)&&n.O_.length<10}function FC(n,e){n.O_.push(e);let t=In(n);t.r_()&&t.V_&&t.m_(e.mutations)}function yv(n){return Xn(n)&&!In(n).n_()&&n.O_.length>0}function vv(n){In(n).start()}function LC(n){return C(this,null,function*(){In(n).p_()})}function VC(n){return C(this,null,function*(){let e=In(n);for(let t of n.O_)e.m_(t.mutations)})}function UC(n,e,t){return C(this,null,function*(){let r=n.O_.shift(),i=Oh.from(r,e,t);yield mv(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Wa(n)})}function BC(n,e){return C(this,null,function*(){e&&In(n).V_&&(yield function(r,i){return C(this,null,function*(){if(function(a){return rC(a)&&a!==R.ABORTED}(i.code)){let s=r.O_.shift();In(r).s_(),yield mv(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Wa(r)}})}(n,e)),yv(n)&&vv(n)})}function wy(n,e){return C(this,null,function*(){let t=G(n);t.asyncQueue.verifyOperationInProgress(),F("RemoteStore","RemoteStore received new credentials");let r=Xn(t);t.L_.add(3),yield Fs(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Ga(t)})}function $C(n,e){return C(this,null,function*(){let t=G(n);e?(t.L_.delete(2),yield Ga(t)):e||(t.L_.add(2),yield Fs(t),t.q_.set("Unknown"))})}function Xr(n){return n.K_||(n.K_=function(t,r,i){let s=G(t);return s.w_(),new fd(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:kC.bind(null,n),Ro:OC.bind(null,n),mo:NC.bind(null,n),d_:MC.bind(null,n)}),n.B_.push(e=>C(this,null,function*(){e?(n.K_.s_(),Zd(n)?Xd(n):n.q_.set("Unknown")):(yield n.K_.stop(),gv(n))}))),n.K_}function In(n){return n.U_||(n.U_=function(t,r,i){let s=G(t);return s.w_(),new pd(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:LC.bind(null,n),mo:BC.bind(null,n),f_:VC.bind(null,n),g_:UC.bind(null,n)}),n.B_.push(e=>C(this,null,function*(){e?(n.U_.s_(),yield Wa(n)):(yield n.U_.stop(),n.O_.length>0&&(F("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var vd=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Ht,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let a=Date.now()+r,c=new n(e,t,a,i,s);return c.start(r),c}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new x(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function ef(n,e){if(Qt("AsyncQueue",`${e}: ${n}`),xs(n))return new x(R.UNAVAILABLE,`${e}: ${n}`);throw n}var Sa=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=gs(),this.sortedSet=new Ee(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Ra=class{constructor(){this.W_=new Ee(B.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):j():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},Hr=class n{constructor(e,t,r,i,s,a,c,u,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=c,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){let a=[];return t.forEach(c=>{a.push({type:0,doc:c})}),new n(e,t,Sa.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ja(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var _d=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},wd=class{constructor(){this.queries=Ey(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=G(t),s=i.queries;i.queries=Ey(),s.forEach((a,c)=>{for(let u of c.j_)u.onError(r)})})(this,new x(R.ABORTED,"Firestore shutting down"))}};function Ey(){return new En(n=>Gy(n),ja)}function jC(n,e){return C(this,null,function*(){let t=G(n),r=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new _d,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let c=ef(a,`Initialization of query '${Or(e.query)}' failed`);return void e.onError(c)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&tf(t)})}function zC(n,e){return C(this,null,function*(){let t=G(n),r=e.query,i=3,s=t.queries.get(r);if(s){let a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function qC(n,e){let t=G(n),r=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let c of a.j_)c.X_(i)&&(r=!0);a.z_=i}}r&&tf(t)}function GC(n,e,t){let r=G(n),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(t);r.queries.delete(e)}function tf(n){n.Y_.forEach(e=>{e.next()})}var Ed,Iy;(Iy=Ed||(Ed={})).ea="default",Iy.Cache="cache";var Id=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new Hr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=Hr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Ed.Cache}};var Pa=class{constructor(e){this.key=e}},ka=class{constructor(e){this.key=e}},Td=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Z(),this.mutatedKeys=Z(),this.Aa=Wy(e),this.Ra=new Sa(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Ra,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,a=i,c=!1,u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{let w=i.get(p),A=za(this.query,m)?m:null,P=!!w&&this.mutatedKeys.has(w.key),k=!!A&&(A.hasLocalMutations||this.mutatedKeys.has(A.key)&&A.hasCommittedMutations),S=!1;w&&A?w.data.isEqual(A.data)?P!==k&&(r.track({type:3,doc:A}),S=!0):this.ga(w,A)||(r.track({type:2,doc:A}),S=!0,(u&&this.Aa(A,u)>0||d&&this.Aa(A,d)<0)&&(c=!0)):!w&&A?(r.track({type:0,doc:A}),S=!0):w&&!A&&(r.track({type:1,doc:w}),S=!0,(u||d)&&(c=!0)),S&&(A?(a=a.add(A),s=k?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:c,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((p,m)=>function(A,P){let k=S=>{switch(S){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return j()}};return k(A)-k(P)}(p.type,m.type)||this.Aa(p.doc,m.doc)),this.pa(r),i=i!=null&&i;let c=t&&!i?this.ya():[],u=this.da.size===0&&this.current&&!i?1:0,d=u!==this.Ea;return this.Ea=u,a.length!==0||d?{snapshot:new Hr(this.query,e.Ra,s,a,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:c}:{wa:c}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Ra,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=Z(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new ka(r))}),this.da.forEach(r=>{e.has(r)||t.push(new Pa(r))}),t}ba(e){this.Ta=e.Ts,this.da=Z();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Hr.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},bd=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Cd=class{constructor(e){this.key=e,this.va=!1}},Ad=class{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new En(c=>Gy(c),ja),this.Ma=new Map,this.xa=new Set,this.Oa=new Ee(B.comparator),this.Na=new Map,this.La=new Ss,this.Ba={},this.ka=new Map,this.qa=Ds.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function WC(n,e,t=!0){return C(this,null,function*(){let r=bv(n),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield _v(r,e,t,!0),i})}function HC(n,e){return C(this,null,function*(){let t=bv(n);yield _v(t,e,!0,!1)})}function _v(n,e,t,r){return C(this,null,function*(){let i=yield SC(n.localStore,Pt(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t),c;return r&&(c=yield KC(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&fv(n.remoteStore,i),c})}function KC(n,e,t,r,i){return C(this,null,function*(){n.Ka=(m,w,A)=>function(k,S,U,q){return C(this,null,function*(){let L=S.view.ma(U);L.ns&&(L=yield _y(k.localStore,S.query,!1).then(({documents:E})=>S.view.ma(E,L)));let se=q&&q.targetChanges.get(S.targetId),ye=q&&q.targetMismatches.get(S.targetId)!=null,ee=S.view.applyChanges(L,k.isPrimaryClient,se,ye);return by(k,S.targetId,ee.wa),ee.snapshot})}(n,m,w,A);let s=yield _y(n.localStore,e,!0),a=new Td(e,s.Ts),c=a.ma(s.documents),u=Cs.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(c,n.isPrimaryClient,u);by(n,t,d.wa);let p=new bd(e,t,a);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot})}function QC(n,e,t){return C(this,null,function*(){let r=G(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(a=>!ja(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield cd(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&Yd(r.remoteStore,i.targetId),Dd(r,i.targetId)}).catch(Ms))):(Dd(r,i.targetId),yield cd(r.localStore,i.targetId,!0))})}function YC(n,e){return C(this,null,function*(){let t=G(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Yd(t.remoteStore,r.targetId))})}function JC(n,e,t){return C(this,null,function*(){let r=iA(n);try{let i=yield function(a,c){let u=G(a),d=xe.now(),p=c.reduce((A,P)=>A.add(P.key),Z()),m,w;return u.persistence.runTransaction("Locally write mutations","readwrite",A=>{let P=Jt(),k=Z();return u.cs.getEntries(A,p).next(S=>{P=S,P.forEach((U,q)=>{q.isValidDocument()||(k=k.add(U))})}).next(()=>u.localDocuments.getOverlayedDocuments(A,P)).next(S=>{m=S;let U=[];for(let q of c){let L=nC(q,m.get(q.key).overlayedDocument);L!=null&&U.push(new Nt(q.key,L,Vy(L.value.mapValue),Kt.exists(!0)))}return u.mutationQueue.addMutationBatch(A,d,U,c)}).next(S=>{w=S;let U=S.applyToLocalDocumentSet(m,k);return u.documentOverlayCache.saveOverlays(A,S.batchId,U)})}).then(()=>({batchId:w.batchId,changes:Ky(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,c,u){let d=a.Ba[a.currentUser.toKey()];d||(d=new Ee(ie)),d=d.insert(c,u),a.Ba[a.currentUser.toKey()]=d}(r,i.batchId,t),yield Ls(r,i.changes),yield Wa(r.remoteStore)}catch(i){let s=ef(i,"Failed to persist write");t.reject(s)}})}function wv(n,e){return C(this,null,function*(){let t=G(n);try{let r=yield CC(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t.Na.get(s);a&&(ue(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?ue(a.va):i.removedDocuments.size>0&&(ue(a.va),a.va=!1))}),yield Ls(t,r,e)}catch(r){yield Ms(r)}})}function Ty(n,e,t){let r=G(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((s,a)=>{let c=a.view.Z_(e);c.snapshot&&i.push(c.snapshot)}),function(a,c){let u=G(a);u.onlineState=c;let d=!1;u.queries.forEach((p,m)=>{for(let w of m.j_)w.Z_(c)&&(d=!0)}),d&&tf(u)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function XC(n,e,t){return C(this,null,function*(){let r=G(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),s=i&&i.key;if(s){let a=new Ee(B.comparator);a=a.insert(s,wt.newNoDocument(s,K.min()));let c=Z().add(s),u=new ya(K.min(),new Map,new Ee(ie),a,c);yield wv(r,u),r.Oa=r.Oa.remove(s),r.Na.delete(e),nf(r)}else yield cd(r.localStore,e,!1).then(()=>Dd(r,e,t)).catch(Ms)})}function ZC(n,e){return C(this,null,function*(){let t=G(n),r=e.batch.batchId;try{let i=yield bC(t.localStore,e);Iv(t,r,null),Ev(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Ls(t,i)}catch(i){yield Ms(i)}})}function eA(n,e,t){return C(this,null,function*(){let r=G(n);try{let i=yield function(a,c){let u=G(a);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return u.mutationQueue.lookupMutationBatch(d,c).next(m=>(ue(m!==null),p=m.keys(),u.mutationQueue.removeMutationBatch(d,m))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,p,c)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>u.localDocuments.getDocuments(d,p))})}(r.localStore,e);Iv(r,e,t),Ev(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Ls(r,i)}catch(i){yield Ms(i)}})}function Ev(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Iv(n,e,t){let r=G(n),i=r.Ba[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Dd(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||Tv(n,r)})}function Tv(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(Yd(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),nf(n))}function by(n,e,t){for(let r of t)r instanceof Pa?(n.La.addReference(r.key,e),tA(n,r)):r instanceof ka?(F("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||Tv(n,r.key)):j()}function tA(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(F("SyncEngine","New document in limbo: "+t),n.xa.add(r),nf(n))}function nf(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new B(ve.fromString(e)),r=n.qa.next();n.Na.set(r,new Cd(t)),n.Oa=n.Oa.insert(t,r),fv(n.remoteStore,new As(Pt(Hd(t.path)),r,"TargetPurposeLimboResolution",My.oe))}}function Ls(n,e,t){return C(this,null,function*(){let r=G(n),i=[],s=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((c,u)=>{a.push(r.Ka(u,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let m=d?!d.fromCache:(p=t?.targetChanges.get(u.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(u.targetId,m?"current":"not-current")}if(d){i.push(d);let m=id.Wi(u.targetId,d);s.push(m)}}))}),yield Promise.all(a),r.Ca.d_(i),yield function(u,d){return C(this,null,function*(){let p=G(u);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>O.forEach(d,w=>O.forEach(w.$i,A=>p.persistence.referenceDelegate.addReference(m,w.targetId,A)).next(()=>O.forEach(w.Ui,A=>p.persistence.referenceDelegate.removeReference(m,w.targetId,A)))))}catch(m){if(!xs(m))throw m;F("LocalStore","Failed to update sequence numbers: "+m)}for(let m of d){let w=m.targetId;if(!m.fromCache){let A=p.os.get(w),P=A.snapshotVersion,k=A.withLastLimboFreeSnapshotVersion(P);p.os=p.os.insert(w,k)}}})}(r.localStore,s))})}function nA(n,e){return C(this,null,function*(){let t=G(n);if(!t.currentUser.isEqual(e)){F("SyncEngine","User change. New user:",e.toKey());let r=yield hv(t.localStore,e);t.currentUser=e,function(s,a){s.ka.forEach(c=>{c.forEach(u=>{u.reject(new x(R.CANCELLED,a))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ls(t,r.hs)}})}function rA(n,e){let t=G(n),r=t.Na.get(e);if(r&&r.va)return Z().add(r.key);{let i=Z(),s=t.Ma.get(e);if(!s)return i;for(let a of s){let c=t.Fa.get(a);i=i.unionWith(c.view.Va)}return i}}function bv(n){let e=G(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=wv.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=rA.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=XC.bind(null,e),e.Ca.d_=qC.bind(null,e.eventManager),e.Ca.$a=GC.bind(null,e.eventManager),e}function iA(n){let e=G(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=ZC.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=eA.bind(null,e),e}var Cy=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return C(this,null,function*(){this.serializer=qa(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return TC(this.persistence,new od,t.initialUser,this.serializer)}Ga(t){return new td(rd.Zr,this.serializer)}Wa(t){return new ud}terminate(){return C(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var sA=(()=>{class n{initialize(t,r){return C(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Ty(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=nA.bind(null,this.syncEngine),yield $C(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new wd}()}createDatastore(t){let r=qa(t.databaseInfo.databaseId),i=function(a){return new dd(a)}(t.databaseInfo);return function(a,c,u,d){return new gd(a,c,u,d)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,a,c,u){return new yd(i,s,a,c,u)}(this.localStore,this.datastore,t.asyncQueue,r=>Ty(this.syncEngine,r,0),function(){return ba.D()?new ba:new ld}())}createSyncEngine(t,r){return function(s,a,c,u,d,p,m){let w=new Ad(s,a,c,u,d,p);return m&&(w.Qa=!0),w}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return C(this,null,function*(){var t,r;yield function(s){return C(this,null,function*(){let a=G(s);F("RemoteStore","RemoteStore shutting down."),a.L_.add(5),yield Fs(a),a.k_.shutdown(),a.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var Sd=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Qt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Rd=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Pe.UNAUTHENTICATED,this.clientId=ha.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,a=>C(this,null,function*(){F("FirestoreClient","Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,a=>(F("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new Ht;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>C(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=ef(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function rh(n,e){return C(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),F("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>C(this,null,function*(){r.isEqual(i)||(yield hv(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function Ay(n,e){return C(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield oA(n);F("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>wy(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>wy(e.remoteStore,i)),n._onlineComponents=e})}function oA(n){return C(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){F("FirestoreClient","Using user provided OfflineComponentProvider");try{yield rh(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===R.FAILED_PRECONDITION||i.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Vr("Error using user provided cache. Falling back to memory cache: "+t),yield rh(n,new Cy)}}else F("FirestoreClient","Using default OfflineComponentProvider"),yield rh(n,new Cy);return n._offlineComponents})}function Cv(n){return C(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(F("FirestoreClient","Using user provided OnlineComponentProvider"),yield Ay(n,n._uninitializedComponentsProvider._online)):(F("FirestoreClient","Using default OnlineComponentProvider"),yield Ay(n,new sA))),n._onlineComponents})}function aA(n){return Cv(n).then(e=>e.syncEngine)}function Dy(n){return C(this,null,function*(){let e=yield Cv(n),t=e.eventManager;return t.onListen=WC.bind(null,e.syncEngine),t.onUnlisten=QC.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=HC.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=YC.bind(null,e.syncEngine),t})}function Av(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var Sy=new Map;function Dv(n,e,t){if(!t)throw new x(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function cA(n,e,t,r){if(e===!0&&r===!0)throw new x(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Ry(n){if(!B.isDocumentKey(n))throw new x(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Py(n){if(B.isDocumentKey(n))throw new x(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Ha(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":j()}function ws(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new x(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=Ha(n);throw new x(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Oa=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new x(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new x(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Av((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new x(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new x(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new x(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Kr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Oa({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new x(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new x(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Oa(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new sh;switch(r.type){case"firstParty":return new uh(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new x(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return C(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=Sy.get(t);r&&(F("ComponentProvider","Removing Datastore"),Sy.delete(t),r.terminate())}(this),Promise.resolve()}};function Sv(n,e,t,r={}){var i;let s=(n=ws(n,Kr))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&Vr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let c,u;if(typeof r.mockUserToken=="string")c=r.mockUserToken,u=Pe.MOCK_USER;else{c=cm(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new x(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Pe(d)}n._authCredentials=new oh(new la(c,u))}}var Yn=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},tt=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vn(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},vn=class n extends Yn{constructor(e,t,r){super(e,t,Hd(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new tt(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function Rv(n,e,...t){if(n=Me(n),Dv("collection","path",e),n instanceof Kr){let r=ve.fromString(e,...t);return Py(r),new vn(n,null,r)}{if(!(n instanceof tt||n instanceof vn))throw new x(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ve.fromString(e,...t));return Py(r),new vn(n.firestore,null,r)}}function Pv(n,e,...t){if(n=Me(n),arguments.length===1&&(e=ha.newId()),Dv("doc","path",e),n instanceof Kr){let r=ve.fromString(e,...t);return Ry(r),new tt(n,null,new B(r))}{if(!(n instanceof tt||n instanceof vn))throw new x(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(ve.fromString(e,...t));return Ry(r),new tt(n.firestore,n instanceof vn?n.converter:null,new B(r))}}var Na=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Ca(this,"async_queue_retry"),this.Vu=()=>{let r=nh();r&&F("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=nh();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=nh();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new Ht;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return C(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!xs(e))throw e;F("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(a){let c=a.message||"";return a.stack&&(c=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),c}(r);throw Qt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=vd.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&j()}verifyOperationInProgress(){}wu(){return C(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function ky(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var Qr=class extends Kr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Na,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return C(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Na(e),this._firestoreClient=void 0,yield e}})}};function kv(n,e){let t=typeof n=="object"?n:rs(),r=typeof n=="string"?n:e||"(default)",i=Rl(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=om("firestore");s&&Sv(i,...s)}return i}function rf(n){if(n._terminated)throw new x(R.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||uA(n),n._firestoreClient}function uA(n){var e,t,r;let i=n._freezeSettings(),s=function(c,u,d,p){return new ph(c,u,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,Av(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Rd(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(c){let u=c?._online.build();return{_offline:c?._offline.build(u),_online:u}}(n._componentsProvider))}var Rs=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(ze.fromBase64String(e))}catch(t){throw new x(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(ze.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var Yr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new x(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new et(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var Ps=class{constructor(e){this._methodName=e}};var ks=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new x(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new x(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ie(this._lat,e._lat)||ie(this._long,e._long)}};var Os=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var lA=/^__.*__$/,Pd=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Nt(e,this.data,this.fieldMask,t,this.fieldTransforms):new Qn(e,this.data,t,this.fieldTransforms)}},Ma=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Nt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function Ov(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw j()}}var kd=class n{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Fa(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Ov(this.Cu)&&lA.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},Od=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||qa(e)}Qu(e,t,r,i=!1){return new kd({Cu:e,methodName:t,qu:r,path:et.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Nv(n){let e=n._freezeSettings(),t=qa(n._databaseId);return new Od(n._databaseId,!!e.ignoreUndefinedProperties,t)}function hA(n,e,t,r,i,s={}){let a=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);sf("Data must be an object, but it was:",a,r);let c=Mv(r,a),u,d;if(s.merge)u=new ht(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){let p=[];for(let m of s.mergeFields){let w=Nd(e,m,t);if(!a.contains(w))throw new x(R.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);Fv(p,w)||p.push(w)}u=new ht(p),d=a.fieldTransforms.filter(m=>u.covers(m.field))}else u=null,d=a.fieldTransforms;return new Pd(new Ze(c),u,d)}var xa=class n extends Ps{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function dA(n,e,t,r){let i=n.Qu(1,e,t);sf("Data must be an object, but it was:",i,r);let s=[],a=Ze.empty();Jn(r,(u,d)=>{let p=of(e,u,t);d=Me(d);let m=i.Nu(p);if(d instanceof xa)s.push(p);else{let w=Vs(d,m);w!=null&&(s.push(p),a.set(p,w))}});let c=new ht(s);return new Ma(a,c,i.fieldTransforms)}function fA(n,e,t,r,i,s){let a=n.Qu(1,e,t),c=[Nd(e,r,t)],u=[i];if(s.length%2!=0)throw new x(R.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<s.length;w+=2)c.push(Nd(e,s[w])),u.push(s[w+1]);let d=[],p=Ze.empty();for(let w=c.length-1;w>=0;--w)if(!Fv(d,c[w])){let A=c[w],P=u[w];P=Me(P);let k=a.Nu(A);if(P instanceof xa)d.push(A);else{let S=Vs(P,k);S!=null&&(d.push(A),p.set(A,S))}}let m=new ht(d);return new Ma(p,m,a.fieldTransforms)}function pA(n,e,t,r=!1){return Vs(t,n.Qu(r?4:3,e))}function Vs(n,e){if(xv(n=Me(n)))return sf("Unsupported field value:",e,n),Mv(n,e);if(n instanceof Ps)return function(r,i){if(!Ov(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let s=[],a=0;for(let c of r){let u=Vs(c,i.Lu(a));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Me(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Jb(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=xe.fromDate(r);return{timestampValue:Ea(i.serializer,s)}}if(r instanceof xe){let s=new xe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ea(i.serializer,s)}}if(r instanceof ks)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Rs)return{bytesValue:iv(i.serializer,r._byteString)};if(r instanceof tt){let s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Qd(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Os)return function(a,c){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(u=>{if(typeof u!="number")throw c.Bu("VectorValues must only contain numeric values.");return Kd(c.serializer,u)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Ha(r)}`)}(n,e)}function Mv(n,e){let t={};return xy(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Jn(n,(r,i)=>{let s=Vs(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function xv(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof xe||n instanceof ks||n instanceof Rs||n instanceof tt||n instanceof Ps||n instanceof Os)}function sf(n,e,t){if(!xv(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=Ha(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function Nd(n,e,t){if((e=Me(e))instanceof Yr)return e._internalPath;if(typeof e=="string")return of(n,e);throw Fa("Field path arguments must be of type string or ",n,!1,void 0,t)}var gA=new RegExp("[~\\*/\\[\\]]");function of(n,e,t){if(e.search(gA)>=0)throw Fa(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Yr(...e.split("."))._internalPath}catch{throw Fa(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Fa(n,e,t,r,i){let s=r&&!r.isEmpty(),a=i!==void 0,c=`Function ${e}() called with invalid data`;t&&(c+=" (via `toFirestore()`)"),c+=". ";let u="";return(s||a)&&(u+=" (found",s&&(u+=` in field ${r}`),a&&(u+=` in document ${i}`),u+=")"),new x(R.INVALID_ARGUMENT,c+n+u)}function Fv(n,e){return n.some(t=>t.isEqual(e))}var La=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new tt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new Md(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(af("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},Md=class extends La{data(){return super.data()}};function af(n,e){return typeof e=="string"?of(n,e):e instanceof Yr?e._internalPath:e._delegate._internalPath}function mA(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new x(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Ns=class{},Va=class extends Ns{};function Lv(n,e,...t){let r=[];e instanceof Ns&&r.push(e),r=r.concat(t),function(s){let a=s.filter(u=>u instanceof Fd).length,c=s.filter(u=>u instanceof xd).length;if(a>1||a>0&&c>0)throw new x(R.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var xd=class n extends Va{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return Uv(e._query,t),new Yn(e.firestore,e.converter,Dh(e._query,t))}_parse(e){let t=Nv(e.firestore);return function(s,a,c,u,d,p,m){let w;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new x(R.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Ny(m,p);let A=[];for(let P of m)A.push(Oy(u,s,P));w={arrayValue:{values:A}}}else w=Oy(u,s,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Ny(m,p),w=pA(c,a,m,p==="in"||p==="not-in");return Ce.create(d,p,w)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};var Fd=class n extends Ns{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:Et.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i,c=s.getFlattenedFilters();for(let u of c)Uv(a,u),a=Dh(a,u)}(e._query,t),new Yn(e.firestore,e.converter,Dh(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var Ld=class n extends Va{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,a){if(i.startAt!==null)throw new x(R.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new x(R.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Wn(s,a)}(e._query,this._field,this._direction);return new Yn(e.firestore,e.converter,function(i,s){let a=i.explicitOrderBy.concat([s]);return new wn(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function Vv(n,e="asc"){let t=e,r=af("orderBy",n);return Ld._create(r,t)}function Oy(n,e,t){if(typeof(t=Me(t))=="string"){if(t==="")throw new x(R.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!qy(e)&&t.indexOf("/")!==-1)throw new x(R.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(ve.fromString(t));if(!B.isDocumentKey(r))throw new x(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ny(n,new B(r))}if(t instanceof tt)return ny(n,t._key);throw new x(R.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ha(t)}.`)}function Ny(n,e){if(!Array.isArray(n)||n.length===0)throw new x(R.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Uv(n,e){let t=function(i,s){for(let a of i)for(let c of a.getFlattenedFilters())if(s.indexOf(c.op)>=0)return c.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new x(R.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new x(R.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var Vd=class{convertValue(e,t="none"){switch(Gn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return me(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(_n(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw j()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Jn(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>me(a.doubleValue));return new Os(s)}convertGeoPoint(e){return new ks(me(e.latitude),me(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=zd(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Is(e));default:return null}}convertTimestamp(e){let t=Yt(e);return new xe(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=ve.fromString(e);ue(lv(r));let i=new ga(r.get(1),r.get(3)),s=new B(r.popFirst(5));return i.isEqual(t)||Qt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function yA(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var jn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Ua=class extends La{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new Lr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(af("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},Lr=class extends Ua{data(e={}){return super.data(e)}},Ud=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new jn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new Lr(this._firestore,this._userDataWriter,r.key,r,new jn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new x(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(c=>{let u=new Lr(i._firestore,i._userDataWriter,c.doc.key,c.doc,new jn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter);return c.doc,{type:"added",doc:u,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(c=>s||c.type!==3).map(c=>{let u=new Lr(i._firestore,i._userDataWriter,c.doc.key,c.doc,new jn(i._snapshot.mutatedKeys.has(c.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return c.type!==0&&(d=a.indexOf(c.doc.key),a=a.delete(c.doc.key)),c.type!==1&&(a=a.add(c.doc),p=a.indexOf(c.doc.key)),{type:vA(c.type),doc:u,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function vA(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return j()}}var Ba=class extends Vd{constructor(e){super(),this.firestore=e}convertBytes(e){return new Rs(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new tt(this.firestore,null,t)}};function cf(n,...e){var t,r,i;n=Me(n);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||ky(e[a])||(s=e[a],a++);let c={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ky(e[a])){let m=e[a];e[a]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[a+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[a+2]=(i=m.complete)===null||i===void 0?void 0:i.bind(m)}let u,d,p;if(n instanceof tt)d=ws(n.firestore,Qr),p=Hd(n._key.path),u={next:m=>{e[a]&&e[a](wA(d,n,m))},error:e[a+1],complete:e[a+2]};else{let m=ws(n,Yn);d=ws(m.firestore,Qr),p=m._query;let w=new Ba(d);u={next:A=>{e[a]&&e[a](new Ud(d,w,m,A))},error:e[a+1],complete:e[a+2]},mA(n._query)}return function(w,A,P,k){let S=new Sd(k),U=new Id(A,S,P);return w.asyncQueue.enqueueAndForget(()=>C(this,null,function*(){return jC(yield Dy(w),U)})),()=>{S.Za(),w.asyncQueue.enqueueAndForget(()=>C(this,null,function*(){return zC(yield Dy(w),U)}))}}(rf(d),p,c,u)}function _A(n,e){return function(r,i){let s=new Ht;return r.asyncQueue.enqueueAndForget(()=>C(this,null,function*(){return JC(yield aA(r),i,s)})),s.promise}(rf(n),e)}function wA(n,e,t){let r=t.docs.get(e._key),i=new Ba(n);return new Ua(n,i,e._key,r,new jn(t.hasPendingWrites,t.fromCache),e.converter)}var Bd=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Nv(e)}set(e,t,r){this._verifyNotCommitted();let i=ih(e,this._firestore),s=yA(i.converter,t,r),a=hA(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(a.toMutation(i._key,Kt.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=ih(e,this._firestore),a;return a=typeof(t=Me(t))=="string"||t instanceof Yr?fA(this._dataReader,"WriteBatch.update",s._key,t,r,i):dA(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,Kt.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=ih(e,this._firestore);return this._mutations=this._mutations.concat(new bs(t._key,Kt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new x(R.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function ih(n,e){if((n=Me(n)).firestore!==e)throw new x(R.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Bv(n){return rf(n=ws(n,Qr)),new Bd(n,e=>_A(n,e))}(function(e,t=!0){(function(i){Jr=i})(Sr),gn(new lt("firestore",(r,{instanceIdentifier:i,options:s})=>{let a=r.getProvider("app").getImmediate(),c=new Qr(new ah(r.getProvider("auth-internal")),new hh(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new x(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ga(d.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),c._setSettings(s),c},"PUBLIC").setMultipleInstances(!0)),Re(Xm,"4.7.3",e),Re(Xm,"4.7.3","esm2017")})();var Ka=function(){return Ka=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Ka.apply(this,arguments)};var TA={includeMetadataChanges:!1};function $v(n,e){return e===void 0&&(e=TA),new nn(function(t){var r=cf(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function jv(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:Ka(Ka({},r),(t={},t[e.idField]=n.id,t))}function zv(n){return $v(n,{includeMetadataChanges:!0}).pipe(H(function(e){return e.docs}))}function qv(n,e){return e===void 0&&(e={}),zv(n).pipe(H(function(t){return t.map(function(r){return jv(r,e)})}))}var Zn=class{constructor(e){return e}},Gv="firestore",uf=class{constructor(){return ss(Gv)}};var lf=new ce("angularfire2.firestore-instances");function bA(n,e){let t=Ol(Gv,n,e);return t&&new Zn(t)}function CA(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Zn(r)}}var AA={provide:uf,deps:[[new at,lf]]},DA={provide:Zn,useFactory:bA,deps:[[new at,lf],Ln]};function Wv(n,...e){return Re("angularfire",Pr.full,"fst"),gt([DA,AA,{provide:lf,useFactory:CA(n),multi:!0,deps:[We,Sn,os,as,[new at,ra],[new at,is],...e]}])}var hf=_t(qv,!0);var df=_t(Rv,!0);var ff=_t(Pv,!0);var Hv=_t(kv,!0);var Kv=_t(Vv,!0);var pf=_t(Lv,!0);var gf=_t(Bv,!0);var SA=["*"],Us=class{},RA=(()=>{class n extends Us{constructor(t){super(),this.http=t}getSvg(t){return this.http.get(t,{responseType:"text"})}static{this.\u0275fac=function(r){return new(r||n)(Q(ki))}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac})}}return n})(),PA=new ce("SERVER_URL"),Qa=(()=>{class n{constructor(){this.loader=M(Us),this.serverUrl=M(PA,{optional:!0}),this.document=M(Be),this.iconsByUrl=new Map,this.iconsLoadingByUrl=new Map}addSvg(t,r){if(!this.iconsByUrl.has(t)){let i=this.document.createElement("DIV");i.innerHTML=r;let s=i.querySelector("svg");this.iconsByUrl.set(t,s)}}loadSvg(t,r=t){if(this.serverUrl&&t.match(/^(http(s)?):/)===null&&(t=this.serverUrl+t,r=t),this.iconsByUrl.has(r))return $(this.iconsByUrl.get(r));if(this.iconsLoadingByUrl.has(r))return this.iconsLoadingByUrl.get(r);let i=this.loader.getSvg(t).pipe(H(s=>{let a=this.document.createElement("DIV");return a.innerHTML=s,a.querySelector("svg")}),Ie(s=>this.iconsByUrl.set(r,s)),st(s=>(console.error(s),rt(s))),sn(()=>this.iconsLoadingByUrl.delete(r)),Cp());return this.iconsLoadingByUrl.set(r,i),i}getSvgByName(t){return this.iconsByUrl.has(t)?$(this.iconsByUrl.get(t)):this.iconsLoadingByUrl.has(t)?this.iconsLoadingByUrl.get(t):rt(`No svg with name '${t}' has been loaded`)}unloadSvg(t){this.iconsByUrl.has(t)&&this.iconsByUrl.delete(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=z({token:n,factory:n.\u0275fac})}}return n})();function kA(n){return n||new Qa}var OA={provide:Qa,deps:[[new at,new Gc,Qa]],useFactory:kA},Ya=class{constructor(){this.loaded=!1}},Zr=(()=>{class n{constructor(){this.element=M(ur),this.differs=M(ou),this.renderer=M(hr),this.iconReg=M(Qa),this.src=It(),this.name=It(),this.stretch=It(!1),this.applyClass=It(!1),this.svgClass=It(),this.klass=It(void 0,{alias:"class"}),this.viewBox=It(),this.svgAriaLabel=It(),this.svg=Op(0),this.svgStyle=It(),this.helper=new Ya,Ut(()=>{(this.src()||this.name())&&(this.destroy(),this.init(this.src(),this.name()))},{allowSignalWrites:!0}),Ut(()=>{let i=this.viewBox();this.svg()&&this.updateViewBox(i)}),Ut(()=>{let i=this.svgStyle()||{};this.svg()&&this.applyChanges(this.helper.differ.diff(i))}),Ut(()=>{let i=this.svg();this.applyClass()?this.setClass(this.elemSvg,null,this.klass()):this.setClass(this.elemSvg,this.klass(),null)});let t;Ut(()=>{let i=this.svg();this.setClass(this.elemSvg,t,this.svgClass()),t=this.svgClass()});let r;Ut(()=>{let i=this.svg(),s=this.element.nativeElement;this.setClass(s,r,this.klass()),this.setClass(this.elemSvg,r,this.applyClass()?this.klass():null),r=this.klass()}),Ut(()=>{let i=this.svg();this.doAria(this.svgAriaLabel())}),Ut(()=>{let i=this.svg();this.stylize(this.stretch())})}ngOnDestroy(){this.destroy()}get elemSvg(){return this.element.nativeElement.firstChild}init(t,r){if(t&&r){let i=this.iconReg.loadSvg(t,r);i&&(this.helper.icnSub=i.subscribe(s=>this.initSvg(s)))}else if(r){let i=this.iconReg.getSvgByName(r);i&&(this.helper.icnSub=i.subscribe(s=>this.initSvg(s)))}else if(t){let i=this.iconReg.loadSvg(t);i&&(this.helper.icnSub=i.subscribe(s=>this.initSvg(s)))}else this.element.nativeElement.innerHTML="",this.svg.set(0)}initSvg(t){!this.helper.loaded&&t&&this.setSvg(t)}destroy(){this.helper.icnSub?.unsubscribe(),this.helper=new Ya,this.helper.differ=this.differs.find({}).create()}setSvg(t){if(!this.helper.loaded&&t){this.helper.svg=t;let r=t.cloneNode(!0),i=this.element.nativeElement;i.innerHTML="",this.renderer.appendChild(i,r),this.helper.loaded=!0,this.copyNgContentAttribute(i,r),this.svg.update(s=>s+1)}}updateViewBox(t){if(t){let r=this.elemSvg;if(t==="auto"){let i=r.getAttribute("width"),s=r.getAttribute("height");if(s&&i){let a=`0 0 ${i} ${s}`;this.renderer.setAttribute(r,"viewBox",a),this.renderer.removeAttribute(r,"width"),this.renderer.removeAttribute(r,"height")}}else t!==""&&(this.renderer.setAttribute(r,"viewBox",t),this.renderer.removeAttribute(r,"width"),this.renderer.removeAttribute(r,"height"))}}copyNgContentAttribute(t,r){let i=t.attributes,s=i.length;for(let a=0;a<s;a+=1){let c=i.item(a);if(c&&c.name.startsWith("_ngcontent")){this.setNgContentAttribute(r,c.name);break}}}setNgContentAttribute(t,r){this.renderer.setAttribute(t,r,"");let i=t.childNodes.length;for(let s=0;s<i;s+=1){let a=t.childNodes[s];a instanceof Element&&this.setNgContentAttribute(a,r)}}stylize(t){if(this.helper.svg){let r=this.element.nativeElement.firstChild;t===!0?this.renderer.setAttribute(r,"preserveAspectRatio","none"):t===!1&&this.renderer.removeAttribute(r,"preserveAspectRatio")}}applyChanges(t){t&&(t.forEachRemovedItem(r=>this.setStyle(r.key,null)),t.forEachAddedItem(r=>this.setStyle(r.key,r.currentValue)),t.forEachChangedItem(r=>this.setStyle(r.key,r.currentValue)))}setStyle(t,r){let[i,s]=t.split(".");r=r!==null&&s?`${r}${s}`:r;let a=this.elemSvg;r!==null?this.renderer.setStyle(a,i,r):this.renderer.removeStyle(a,i)}setClass(t,r,i){if(t){if(r){let s=(Array.isArray(r)?r:r.split(" ")).filter(a=>a);for(let a of s)this.renderer.removeClass(t,a)}if(i){let s=(Array.isArray(i)?i:i.split(" ")).filter(a=>a);for(let a of s)this.renderer.addClass(t,a)}}}doAria(t){if(t!==void 0){let r=this.element.nativeElement.firstChild;r&&!r.hasAttribute("aria-label")&&(t===""?(this.renderer.setAttribute(r,"aria-hidden","true"),this.renderer.removeAttribute(r,"aria-label")):(this.renderer.removeAttribute(r,"aria-hidden"),this.renderer.setAttribute(r,"aria-label",t)))}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=de({type:n,selectors:[["svg-icon"]],inputs:{src:[1,"src"],name:[1,"name"],stretch:[1,"stretch"],applyClass:[1,"applyClass"],svgClass:[1,"svgClass"],klass:[1,"class","klass"],viewBox:[1,"viewBox"],svgAriaLabel:[1,"svgAriaLabel"],svgStyle:[1,"svgStyle"]},standalone:!0,features:[fe],ngContentSelectors:SA,decls:1,vars:0,template:function(r,i){r&1&&(an(),cn(0))},encapsulation:2,changeDetection:0})}}return n})();function Qv(n={}){return gt([OA,n.loader||{provide:Us,useClass:RA}])}var NA=["*"],Ja=class n{clicked=new Qe;onClick(e){this.clicked.emit(e)}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=de({type:n,selectors:[["app-button"]],outputs:{clicked:"clicked"},standalone:!0,features:[fe],ngContentSelectors:NA,decls:2,vars:0,consts:[[1,"button",3,"click"]],template:function(t,r){t&1&&(an(),W(0,"button",0),De("click",function(s){return r.onClick(s)}),cn(1),J())},styles:[".button[_ngcontent-%COMP%]{background-color:#133167;color:#fff;border:none;padding:6px 12px;border-radius:4px;transition:background-color .3s ease;cursor:pointer}.button[_ngcontent-%COMP%]:hover{background-color:#0f254e}"]})};var MA=["dialogRef"],xA=["*"],FA=()=>({width:"16px",height:"16px"}),Xa=class n{open;title;closed=new Qe;dialogRef;ngOnChanges(){this.dialogRef&&(this.open?this.dialogRef.nativeElement.showModal():this.dialogRef.nativeElement.close())}onClose(){this.closed.emit()}close(){this.dialogRef.nativeElement.close()}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=de({type:n,selectors:[["app-dialog"]],viewQuery:function(t,r){if(t&1&&Lp(MA,5),t&2){let i;Zc(i=eu())&&(r.dialogRef=i.first)}},inputs:{open:"open",title:"title"},outputs:{closed:"closed"},standalone:!0,features:[Ti,fe],ngContentSelectors:xA,decls:9,vars:3,consts:[["dialogRef",""],[1,"dialog",3,"close"],[1,"dialog-header"],[1,"close-button",3,"click"],["src","assets/svg/close.svg",3,"svgStyle"]],template:function(t,r){if(t&1){let i=ao();an(),W(0,"dialog",1,0),De("close",function(){return ar(i),cr(r.onClose())}),W(2,"header",2)(3,"h2"),Oe(4),J(),W(5,"button",3),De("click",function(){return ar(i),cr(r.close())}),he(6,"svg-icon",4),J()(),W(7,"section"),cn(8),J()()}t&2&&(ne(4),yt(r.title),ne(2),ge("svgStyle",dr(2,FA)))},dependencies:[Zr],styles:[".dialog[_ngcontent-%COMP%]{border:none;border-radius:8px;box-shadow:0 4px 6px #0000001a;padding:16px;max-width:900px}.dialog[_ngcontent-%COMP%]   .dialog-header[_ngcontent-%COMP%]{display:flex;margin-bottom:16px}.dialog[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{flex:1;text-align:center;margin:0;font-size:16px}.dialog[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{cursor:pointer}"]})};var LA=n=>({hidden:n}),VA=()=>({width:"18px",height:"18px",color:"white"});function UA(n,e){n&1&&he(0,"div",1)}var Za=class n{label;imageUrl;vote=new Qe;showDialog=!1;isImageLoaded=!1;onVote(e){e.stopPropagation(),this.vote.emit()}onImageLoad(){this.isImageLoaded=!0}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=de({type:n,selectors:[["app-voting-card"]],inputs:{label:"label",imageUrl:"imageUrl"},outputs:{vote:"vote"},standalone:!0,features:[fe],decls:11,vars:12,consts:[[1,"vote-card"],[1,"skeleton-loader"],[1,"vote-card-image",3,"load","ngClass","src","alt"],[1,"vote-card-label"],[3,"clicked"],[1,"dialog-button",3,"click"],["src","assets/svg/maximize.svg",3,"svgStyle"],[3,"closed","open","title"],["alt","Cat Image",1,"dialog-image",3,"src"]],template:function(t,r){t&1&&(W(0,"div",0),bt(1,UA,1,0,"div",1),W(2,"img",2),De("load",function(){return r.onImageLoad()}),J(),W(3,"span",3),Oe(4),J(),W(5,"app-button",4),De("clicked",function(s){return r.onVote(s)}),Oe(6,"Vote"),J(),W(7,"button",5),De("click",function(){return r.showDialog=!0}),he(8,"svg-icon",6),J()(),W(9,"app-dialog",7),De("closed",function(){return r.showDialog=!1}),he(10,"img",8),J()),t&2&&(ne(),Ct(r.isImageLoaded?-1:1),ne(),Fp("alt",r.label),ge("ngClass",co(9,LA,!r.isImageLoaded))("src",r.imageUrl,Rn),ne(2),yt(r.label),ne(4),ge("svgStyle",dr(11,VA)),ne(),ge("open",r.showDialog)("title",r.label),ne(),ge("src",r.imageUrl,Rn))},dependencies:[gr,Ja,Xa,Zr],styles:[".vote-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;position:relative}.vote-card[_ngcontent-%COMP%]   .vote-card-image[_ngcontent-%COMP%]{width:200px;aspect-ratio:1;object-fit:cover;border-radius:8px;border:1px solid #133167;padding:4px}.vote-card[_ngcontent-%COMP%]   .vote-card-image.hidden[_ngcontent-%COMP%]{display:none}.vote-card[_ngcontent-%COMP%]   .skeleton-loader[_ngcontent-%COMP%]{width:200px;aspect-ratio:1;border-radius:8px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 1.5s infinite}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:200% 0}to{background-position:-200% 0}}.vote-card[_ngcontent-%COMP%]   .vote-card-label[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:#0f254e}.vote-card[_ngcontent-%COMP%]   .dialog-button[_ngcontent-%COMP%]{cursor:pointer;position:absolute;top:16px;right:16px}.dialog-image[_ngcontent-%COMP%]{display:block;margin:0 auto 16px;max-height:400px;border-radius:8px}"]})};var ec=class n{firestore=M(Zn);http=M(ki);catsDataUrl="https://conseil.latelier.co/data/cats.json";catsCollection=df(this.firestore,"cats");appearancesCollection=df(this.firestore,"cat_appearances");fetchCatsData$(){return this.http.get(this.catsDataUrl).pipe(H(e=>e.images),st(()=>rt(()=>"An error occurred while fetching cats data from the remote source.")))}fetchPersistedCats$(){let e=pf(this.catsCollection);return hf(e).pipe(pt(t=>!!t),st(()=>rt(()=>new Error("An error occurred while fetching persisted cats."))))}fetchCatAppearances$(){let e=pf(this.appearancesCollection,Kv("appearedAt","desc"));return hf(e).pipe(pt(t=>!!t),st(()=>rt(()=>new Error("An error occurred while fetching cat last appearances."))))}fetchCats$(){return ro([this.fetchCatsData$(),this.fetchPersistedCats$()]).pipe(H(([e,t])=>this.mergeCats(e,t)))}mergeCats(e,t){return e.map(r=>{let i=t.find(s=>s.id===r.id);return i||{id:r.id,imageUrl:r.url,score:0,appearances:0}})}updateCats(e){return C(this,null,function*(){let t=gf(this.firestore);e.forEach(r=>{let i=ff(this.catsCollection,r.id);t.set(i,r)}),yield t.commit()})}updateCatAppearances(e){return C(this,null,function*(){let t=gf(this.firestore);e.forEach(r=>{let i=ff(this.appearancesCollection,r.catId);t.set(i,r)}),yield t.commit()})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})};var ei=class n{MAX_RECENT_HISTORY=8;catStorage=M(ec);getCatRanking$(){return this.catStorage.fetchCats$().pipe(H(e=>e.sort((t,r)=>r.score===t.score?t.appearances-r.appearances:r.score-t.score)))}selectCatOpponents$(){return ro([this.catStorage.fetchCats$(),this.catStorage.fetchCatAppearances$()]).pipe(H(([e,t])=>this.selectCatOpponents(e,t)))}selectCatOpponents(e,t){let r=this.getUnseenCats(e,t),i=this.getLeastAppeared(r);if(i.length<2){let s=r[Math.floor(Math.random()*r.length)];return[i[0],s]}return i.sort(()=>Math.random()-.5),[i[0],i[1]]}getUnseenCats(e,t){let r=t.slice(0,this.MAX_RECENT_HISTORY);return e.filter(i=>!r.some(s=>s.catId===i.id))}getLeastAppeared(e){let t=Math.min(...e.map(r=>r.appearances));return e.filter(r=>r.appearances===t)}recordVote(r){return C(this,arguments,function*({winner:e,loser:t}){try{e.score+=1,e.appearances+=1,t.appearances+=1,yield this.catStorage.updateCats([e,t]);let i=[{catId:e.id,appearedAt:new Date().toISOString()},{catId:t.id,appearedAt:new Date().toISOString()}];yield this.catStorage.updateCatAppearances(i),this.countPlayedMatches()}catch(i){throw console.error("Error recording vote:",i),new Error("Failed to register the vote. Please try again later.")}})}getPlayedMatches(){let e=localStorage.getItem("playedMatches");return Number(e??"0")}countPlayedMatches(){let e=localStorage.getItem("playedMatches");e||localStorage.setItem("playedMatches","0");let t=parseInt(e??"0",10)+1;localStorage.setItem("playedMatches",t.toString())}static \u0275fac=function(t){return new(t||n)};static \u0275prov=z({token:n,factory:n.\u0275fac,providedIn:"root"})};var BA=()=>({"width.px":14,"height.px":14}),ti=class n{router=M(Uo);item;navigate(){return C(this,null,function*(){yield this.router.navigate([this.item.route])})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=de({type:n,selectors:[["app-bottom-nav"]],inputs:{item:"item"},standalone:!0,features:[fe],decls:6,vars:4,consts:[["tabindex","0",1,"bottom-nav",3,"click","keydown.enter"],["src","assets/svg/up.svg",3,"svgStyle"],[1,"nav-button"],[1,"nav-info"]],template:function(t,r){t&1&&(W(0,"div",0),De("click",function(){return r.navigate()})("keydown.enter",function(){return r.navigate()}),he(1,"svg-icon",1),W(2,"p",2),Oe(3),J(),W(4,"span",3),Oe(5),J()()),t&2&&(ne(),ge("svgStyle",dr(3,BA)),ne(2),yt(r.item.label),ne(2),yt(r.item.info))},dependencies:[Zr],styles:[".bottom-nav[_ngcontent-%COMP%]{position:fixed;bottom:0;left:50%;transform:translate(-50%);width:33%;height:64px;padding:12px 0;cursor:pointer;border:1px solid #133167;border-radius:6px 6px 0 0;border-bottom:none;background-color:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center}.bottom-nav[_ngcontent-%COMP%]   .nav-button[_ngcontent-%COMP%]{font-size:14px;font-weight:600}.bottom-nav[_ngcontent-%COMP%]   .nav-info[_ngcontent-%COMP%]{font-size:12px;font-weight:400}"]})};var tc=class n{size="sm";theme="light";get loadingClass(){let e="la-ball-grid-pulse";return e+=this.size?` la-${this.size}`:"",e+=this.theme==="dark"?" la-dark":"",e}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=de({type:n,selectors:[["app-loading"]],inputs:{size:"size",theme:"theme"},standalone:!0,features:[fe],decls:10,vars:2,template:function(t,r){t&1&&(W(0,"div"),he(1,"div")(2,"div")(3,"div")(4,"div")(5,"div")(6,"div")(7,"div")(8,"div")(9,"div"),J()),t&2&&xp(r.loadingClass)},styles:[`.la-ball-grid-pulse[_ngcontent-%COMP%], .la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{position:relative;-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.la-ball-grid-pulse[_ngcontent-%COMP%]{display:block;font-size:0;color:#fff}.la-ball-grid-pulse.la-dark[_ngcontent-%COMP%]{color:#333}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:inline-block;float:none;background-color:currentColor;border:0 solid currentColor}.la-ball-grid-pulse[_ngcontent-%COMP%]{width:36px;height:36px}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:8px;height:8px;margin:2px;border-radius:100%;-webkit-animation-name:_ngcontent-%COMP%_ball-grid-pulse;-moz-animation-name:ball-grid-pulse;-o-animation-name:ball-grid-pulse;animation-name:_ngcontent-%COMP%_ball-grid-pulse;-webkit-animation-iteration-count:infinite;-moz-animation-iteration-count:infinite;-o-animation-iteration-count:infinite;animation-iteration-count:infinite}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(1){-webkit-animation-duration:.65s;-moz-animation-duration:.65s;-o-animation-duration:.65s;animation-duration:.65s;-webkit-animation-delay:.03s;-moz-animation-delay:.03s;-o-animation-delay:.03s;animation-delay:.03s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(2){-webkit-animation-duration:1.02s;-moz-animation-duration:1.02s;-o-animation-duration:1.02s;animation-duration:1.02s;-webkit-animation-delay:.09s;-moz-animation-delay:.09s;-o-animation-delay:.09s;animation-delay:.09s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(3){-webkit-animation-duration:1.06s;-moz-animation-duration:1.06s;-o-animation-duration:1.06s;animation-duration:1.06s;-webkit-animation-delay:-.69s;-moz-animation-delay:-.69s;-o-animation-delay:-.69s;animation-delay:-.69s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(4){-webkit-animation-duration:1.5s;-moz-animation-duration:1.5s;-o-animation-duration:1.5s;animation-duration:1.5s;-webkit-animation-delay:-.41s;-moz-animation-delay:-.41s;-o-animation-delay:-.41s;animation-delay:-.41s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(5){-webkit-animation-duration:1.6s;-moz-animation-duration:1.6s;-o-animation-duration:1.6s;animation-duration:1.6s;-webkit-animation-delay:.04s;-moz-animation-delay:.04s;-o-animation-delay:.04s;animation-delay:.04s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(6){-webkit-animation-duration:.84s;-moz-animation-duration:.84s;-o-animation-duration:.84s;animation-duration:.84s;-webkit-animation-delay:.07s;-moz-animation-delay:.07s;-o-animation-delay:.07s;animation-delay:.07s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(7){-webkit-animation-duration:.68s;-moz-animation-duration:.68s;-o-animation-duration:.68s;animation-duration:.68s;-webkit-animation-delay:-.66s;-moz-animation-delay:-.66s;-o-animation-delay:-.66s;animation-delay:-.66s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(8){-webkit-animation-duration:.93s;-moz-animation-duration:.93s;-o-animation-duration:.93s;animation-duration:.93s;-webkit-animation-delay:-.76s;-moz-animation-delay:-.76s;-o-animation-delay:-.76s;animation-delay:-.76s}.la-ball-grid-pulse[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:nth-child(9){-webkit-animation-duration:1.24s;-moz-animation-duration:1.24s;-o-animation-duration:1.24s;animation-duration:1.24s;-webkit-animation-delay:-.76s;-moz-animation-delay:-.76s;-o-animation-delay:-.76s;animation-delay:-.76s}.la-ball-grid-pulse.la-sm[_ngcontent-%COMP%]{width:18px;height:18px}.la-ball-grid-pulse.la-sm[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:4px;height:4px;margin:1px}.la-ball-grid-pulse.la-2x[_ngcontent-%COMP%]{width:72px;height:72px}.la-ball-grid-pulse.la-2x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:16px;height:16px;margin:4px}.la-ball-grid-pulse.la-3x[_ngcontent-%COMP%]{width:108px;height:108px}.la-ball-grid-pulse.la-3x[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{width:24px;height:24px;margin:6px}@-webkit-keyframes _ngcontent-%COMP%_ball-grid-pulse{0%{opacity:1;-webkit-transform:scale(1);transform:scale(1)}50%{opacity:.35;-webkit-transform:scale(.45);transform:scale(.45)}to{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}@-moz-keyframes ball-grid-pulse{0%{opacity:1;-moz-transform:scale(1);transform:scale(1)}50%{opacity:.35;-moz-transform:scale(.45);transform:scale(.45)}to{opacity:1;-moz-transform:scale(1);transform:scale(1)}}@-o-keyframes ball-grid-pulse{0%{opacity:1;-o-transform:scale(1);transform:scale(1)}50%{opacity:.35;-o-transform:scale(.45);transform:scale(.45)}to{opacity:1;-o-transform:scale(1);transform:scale(1)}}@keyframes _ngcontent-%COMP%_ball-grid-pulse{0%{opacity:1;-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1)}50%{opacity:.35;-webkit-transform:scale(.45);-moz-transform:scale(.45);-o-transform:scale(.45);transform:scale(.45)}to{opacity:1;-webkit-transform:scale(1);-moz-transform:scale(1);-o-transform:scale(1);transform:scale(1)}}





`]})};var $A=["*"];function jA(n,e){n&1&&(W(0,"div",0),he(1,"app-loading",2),J())}function zA(n,e){if(n&1&&(W(0,"div",1)(1,"h1"),Oe(2,"Une erreur est survenue."),J(),W(3,"p"),Oe(4),J()()),n&2){let t=on();ne(4),yt(t.error)}}function qA(n,e){n&1&&cn(0)}var ni=class n{loading;error;static \u0275fac=function(t){return new(t||n)};static \u0275cmp=de({type:n,selectors:[["app-state-wrapper"]],inputs:{loading:"loading",error:"error"},standalone:!0,features:[fe],ngContentSelectors:$A,decls:3,vars:1,consts:[[1,"loading-container"],[1,"error-container"],["size","2x","theme","dark",1,"loading"]],template:function(t,r){t&1&&(an(),bt(0,jA,2,0,"div",0)(1,zA,5,1,"div",1)(2,qA,1,0)),t&2&&Ct(r.loading?0:r.error?1:2)},dependencies:[tc],styles:[".loading-container[_ngcontent-%COMP%], .error-container[_ngcontent-%COMP%]{height:80vh;display:flex;justify-content:center;align-items:center}.loading-container[_ngcontent-%COMP%]   .loading[_ngcontent-%COMP%]{display:block;margin:0 auto}.error-container[_ngcontent-%COMP%]{flex-direction:column;color:#ff4d4f}.error-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.5rem;margin-bottom:.5rem}.error-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem}"]})};function GA(n,e){if(n&1){let t=ao();W(0,"app-voting-card",3),De("vote",function(){ar(t);let i=on();return cr(i.onVote({winner:i.cat1,loser:i.cat2}))}),J(),W(1,"app-voting-card",3),De("vote",function(){ar(t);let i=on();return cr(i.onVote({winner:i.cat2,loser:i.cat1}))}),J(),he(2,"app-bottom-nav",4)}if(n&2){let t=on();ge("imageUrl",t.cat1.imageUrl)("label",t.cat1.id),ne(),ge("imageUrl",t.cat2.imageUrl)("label",t.cat2.id),ne(),ge("item",t.navItem)}}var nc=class n{catService=M(ei);cat1;cat2;loading=!1;error=null;navItem={route:"/ranking",label:"Voir le classement"};destroy$=new ft;ngOnInit(){this.loadNewOpponents()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadNewOpponents(){this.loading=!0,this.error=null,this.catService.selectCatOpponents$().pipe(sr(this.destroy$)).subscribe({next:([e,t])=>{this.cat1=e,this.cat2=t,this.navItem.info=`${this.catService.getPlayedMatches()} parties jou\xE9es`},error:e=>{this.loading=!1,e instanceof Error?this.error=e.message:this.error="An unexpected error occurred. Please try again later."},complete:()=>{this.loading=!1}})}onVote(e){return C(this,null,function*(){try{yield this.catService.recordVote(e),this.loadNewOpponents()}catch(t){t instanceof Error&&(this.error=t.message)}})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=de({type:n,selectors:[["app-voting-page"]],standalone:!0,features:[fe],decls:4,vars:3,consts:[[3,"loading","error"],[1,"page-container"],[1,"page-content","content"],[3,"vote","imageUrl","label"],[3,"item"]],template:function(t,r){t&1&&(W(0,"app-state-wrapper",0)(1,"section",1)(2,"div",2),bt(3,GA,3,5),J()()()),t&2&&(ge("loading",r.loading)("error",r.error),ne(3),Ct(!r.loading&&r.cat1&&r.cat2?3:-1))},dependencies:[Za,ti,ni],styles:[".content[_ngcontent-%COMP%]{display:flex}.content[_ngcontent-%COMP%]   app-voting-card[_ngcontent-%COMP%]{flex:1;display:flex;justify-content:center;align-items:center}.content[_ngcontent-%COMP%]   app-voting-card[_ngcontent-%COMP%]:first-child{border-right:1px dashed #133167}"]})};var WA=n=>({hidden:n});function HA(n,e){n&1&&he(0,"div",2)}var rc=class n{rank;label;imageUrl;score;variant;isImageLoaded=!1;onImageLoad(){this.isImageLoaded=!0}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=de({type:n,selectors:[["app-ranking-card"]],inputs:{rank:"rank",label:"label",imageUrl:"imageUrl",score:"score",variant:"variant"},standalone:!0,features:[fe],decls:9,vars:10,consts:[[1,"ranking-card",3,"ngClass"],[1,"ranking-card-rank"],[1,"skeleton-loader"],[1,"ranking-card-image",3,"load","src","alt","ngClass"],[1,"ranking-card-label"],[1,"ranking-card-score"]],template:function(t,r){t&1&&(W(0,"div",0)(1,"div",1),Oe(2),J(),bt(3,HA,1,0,"div",2),W(4,"img",3),De("load",function(){return r.onImageLoad()}),J(),W(5,"div",4),Oe(6),J(),W(7,"div",5),Oe(8),J()()),t&2&&(ge("ngClass",r.variant),ne(2),tu("#",r.rank,""),ne(),Ct(r.isImageLoaded?-1:3),ne(),ge("src",r.imageUrl,Rn)("alt",r.label)("ngClass",co(8,WA,!r.isImageLoaded)),ne(2),yt(r.label),ne(2),tu("Score: ",r.score," pts"))},dependencies:[gr],styles:[".ranking-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:6px;padding:16px;box-shadow:0 2px 4px #0000001a;color:#133167;border:1px solid #133167;border-radius:8px}.ranking-card[_ngcontent-%COMP%]   .ranking-card-rank[_ngcontent-%COMP%]{font-size:14px;font-weight:700}.ranking-card.first[_ngcontent-%COMP%], .ranking-card.second[_ngcontent-%COMP%], .ranking-card.third[_ngcontent-%COMP%]{color:#fff}.ranking-card.first[_ngcontent-%COMP%]   .ranking-card-image[_ngcontent-%COMP%], .ranking-card.second[_ngcontent-%COMP%]   .ranking-card-image[_ngcontent-%COMP%], .ranking-card.third[_ngcontent-%COMP%]   .ranking-card-image[_ngcontent-%COMP%]{border-color:#fff}.ranking-card.first[_ngcontent-%COMP%]{min-height:220px;background-color:#011a3b}.ranking-card.second[_ngcontent-%COMP%]{min-height:200px;background-color:#41526c}.ranking-card.third[_ngcontent-%COMP%]{min-height:180px;background-color:#808b9d}.ranking-card[_ngcontent-%COMP%]   .ranking-card-image[_ngcontent-%COMP%]{width:82px;aspect-ratio:1/1;object-fit:cover;border:1px solid #133167;border-radius:4px}.ranking-card[_ngcontent-%COMP%]   .ranking-card-image.hidden[_ngcontent-%COMP%]{display:none}.ranking-card[_ngcontent-%COMP%]   .skeleton-loader[_ngcontent-%COMP%]{width:82px;aspect-ratio:1/1;border-radius:4px;background:linear-gradient(90deg,#f0f0f0 25%,#e0e0e0,#f0f0f0 75%);background-size:200% 100%;animation:_ngcontent-%COMP%_shimmer 1.5s infinite}@keyframes _ngcontent-%COMP%_shimmer{0%{background-position:200% 0}to{background-position:-200% 0}}.ranking-card[_ngcontent-%COMP%]   .ranking-card-label[_ngcontent-%COMP%]{font-size:14px;font-weight:700}.ranking-card[_ngcontent-%COMP%]   .ranking-card-score[_ngcontent-%COMP%]{font-size:12px;font-style:italic}"]})};var Yv=(n,e)=>e.id,KA=(n,e,t)=>({first:n,second:e,third:t});function QA(n,e){if(n&1&&he(0,"app-ranking-card",4),n&2){let t=e.$implicit,r=e.$index;ge("label",t.id)("rank",r+1)("imageUrl",t.imageUrl)("score",t.score)("ngClass",Vp(6,KA,r===0,r===1,r===2))("variant",r===0?"first":r===1?"second":"third")}}function YA(n,e){if(n&1&&he(0,"app-ranking-card",6),n&2){let t=e.$implicit,r=e.$index;ge("label",t.id)("rank",r+4)("imageUrl",t.imageUrl)("score",t.score)}}function JA(n,e){if(n&1&&(W(0,"div",3),Jc(1,QA,1,10,"app-ranking-card",4,Yv),nu(3,"slice"),J(),W(4,"div",5),Jc(5,YA,1,4,"app-ranking-card",6,Yv),nu(7,"slice"),he(8,"app-bottom-nav",7),J()),n&2){let t=on();ne(),Xc(Bp(3,1,t.cats,0,3)),ne(4),Xc(Up(7,5,t.cats,3)),ne(3),ge("item",t.navItem)}}var ic=class n{catService=M(ei);cats;loading=!1;error=null;navItem={route:"/voting",label:"Retourner au vote"};destroy$=new ft;ngOnInit(){this.loadRanking()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadRanking(){this.loading=!0,this.catService.getCatRanking$().pipe(sr(this.destroy$)).subscribe({next:e=>{this.cats=e,this.loading=!1,this.navItem.info=`${this.catService.getPlayedMatches()} parties jou\xE9es`},error:e=>{this.loading=!1,e instanceof Error?this.error=e.message:this.error="An unexpected error occurred. Please try again later."}})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=de({type:n,selectors:[["app-ranking-page"]],standalone:!0,features:[fe],decls:4,vars:3,consts:[[3,"loading","error"],[1,"page-container"],[1,"page-content","content"],[1,"top-ranking"],[3,"label","rank","imageUrl","score","ngClass","variant"],[1,"other-ranking"],[3,"label","rank","imageUrl","score"],[3,"item"]],template:function(t,r){t&1&&(W(0,"app-state-wrapper",0)(1,"section",1)(2,"div",2),bt(3,JA,9,8),J()()()),t&2&&(ge("loading",r.loading)("error",r.error),ne(3),Ct(!r.loading&&r.cats.length?3:-1))},dependencies:[Xp,gr,ti,rc,ni],styles:[".content[_ngcontent-%COMP%]   .top-ranking[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .other-ranking[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;gap:16px}.content[_ngcontent-%COMP%]   .top-ranking[_ngcontent-%COMP%]{align-items:flex-end;margin-bottom:32px}.content[_ngcontent-%COMP%]   .top-ranking[_ngcontent-%COMP%]   app-ranking-card[_ngcontent-%COMP%]{box-sizing:border-box;flex:1 1 30%;min-width:220px}.content[_ngcontent-%COMP%]   .top-ranking[_ngcontent-%COMP%]   app-ranking-card.first[_ngcontent-%COMP%]{order:2}.content[_ngcontent-%COMP%]   .top-ranking[_ngcontent-%COMP%]   app-ranking-card.second[_ngcontent-%COMP%]{order:1}.content[_ngcontent-%COMP%]   .top-ranking[_ngcontent-%COMP%]   app-ranking-card.third[_ngcontent-%COMP%]{order:3}@media (max-width: 780px){.content[_ngcontent-%COMP%]   .top-ranking[_ngcontent-%COMP%]   app-ranking-card[_ngcontent-%COMP%]{flex:1 1 100%}.content[_ngcontent-%COMP%]   .top-ranking[_ngcontent-%COMP%]   app-ranking-card.first[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .top-ranking[_ngcontent-%COMP%]   app-ranking-card.second[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .top-ranking[_ngcontent-%COMP%]   app-ranking-card.third[_ngcontent-%COMP%]{order:initial}}.content[_ngcontent-%COMP%]   .other-ranking[_ngcontent-%COMP%]   app-ranking-card[_ngcontent-%COMP%]{flex:1 1 calc(25% - 12px);min-width:160px;box-sizing:border-box}"]})};var Jv=[{path:"",pathMatch:"full",redirectTo:"voting"},{path:"voting",component:nc},{path:"ranking",component:ic},{path:"**",loadComponent:()=>import("./chunk-FASHPD6S.js").then(n=>n.NotFoundPageComponent)}];var Xv={production:!0,firebase:{apiKey:"AIzaSyDc1PksS7zr0DX9xMmdJpCKSK6uxnfWOrc",authDomain:"catmash-37c0c.firebaseapp.com",projectId:"catmash-37c0c",storageBucket:"catmash-37c0c.firebasestorage.app",messagingSenderId:"457408874219",appId:"1:457408874219:web:2964f6270a8980d153e0ae"},remoteApiUrl:"https://conseil.latelier.co/data/cats.json"};var Zv={providers:[jp({eventCoalescing:!0}),tm(Jv),lg(),Pm(()=>km(Xv.firebase)),Wv(()=>Hv()),Qv(),{provide:Pn,useClass:lu}]};var sc=class n{brandLogo="assets/img/cat_brand.png";static \u0275fac=function(t){return new(t||n)};static \u0275cmp=de({type:n,selectors:[["app-header"]],standalone:!0,features:[fe],decls:5,vars:1,consts:[[1,"header"],[1,"header-brand"],["alt","CatMash Logo",1,"header-logo",3,"src"],[1,"header-title"]],template:function(t,r){t&1&&(W(0,"header",0)(1,"div",1),he(2,"img",2),W(3,"span",3),Oe(4,"CATMASH"),J()()()),t&2&&(ne(2),ge("src",r.brandLogo,Rn))},styles:[".header[_ngcontent-%COMP%]{height:70px;display:flex;justify-content:center;align-items:center}.header[_ngcontent-%COMP%]   .header-brand[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:4px;font-size:12px;font-weight:700}.header[_ngcontent-%COMP%]   .header-brand[_ngcontent-%COMP%]   .header-logo[_ngcontent-%COMP%]{width:40px}"]})};var oc=class n{static \u0275fac=function(t){return new(t||n)};static \u0275cmp=de({type:n,selectors:[["app-root"]],standalone:!0,features:[fe],decls:4,vars:0,consts:[[1,"app-root"],[1,"app-container"]],template:function(t,r){t&1&&(W(0,"div",0),he(1,"app-header"),W(2,"div",1),he(3,"router-outlet"),J()())},dependencies:[sc,nl],styles:[".app-root[_ngcontent-%COMP%]{min-height:100vh;display:flex;flex-direction:column}.app-root[_ngcontent-%COMP%]   .app-header[_ngcontent-%COMP%]{height:70px}.app-root[_ngcontent-%COMP%]   .app-container[_ngcontent-%COMP%]{min-height:calc(100vh - 70px)}"]})};vg(oc,Zv).catch(n=>console.error(n));
