import{$ as xf,$a as zf,A as As,Aa as Bf,B as wt,Ba as $f,C as st,D as sn,E as Za,F as Ln,G as Nf,H as Vn,I as Ze,Ia as Wr,J as eu,Ja as Ns,K as Of,Ka as jf,L as tu,M as nu,Ma as hu,N as He,O as kf,P as ve,Q as fe,R as W,Ra as Os,S as Mf,Sa as du,T as ae,U as ru,Ua as ks,V as Q,W as F,X as ot,Y as Gr,Z as Ds,_ as Ss,_a as Hr,a as V,aa as Et,ab as Ms,b as _e,ba as Ff,bb as fu,c as D,ca as Un,cb as pu,d as Df,da as et,db as xs,e as Ga,ea as iu,eb as gu,f as Lt,g as Wa,gb as Kr,h as Ha,ha as su,hb as qf,i as rn,ia as on,j as Ge,ja as bs,k as Sf,ka as an,l as bf,la as xe,m as Vt,ma as ou,n as Ka,na as Cs,o as Qa,oa as Lf,p as Ya,pa as au,q as Fe,qa as Vf,r as z,ra as at,s as _t,sa as uu,t as Cf,u as Rf,ua as Bn,v as K,va as cu,w as Ja,wa as Rs,x as We,xa as Uf,y as Pf,ya as Ps,z as Xa,za as lu}from"./chunk-CKQT6GPN.js";var Qf=null;function $n(){return Qf}function Yf(n){Qf??=n}var Fs=class{};var Le=new ae(""),Jf=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>F(Nv),providedIn:"platform"})}}return n})();var Nv=(()=>{class n extends Jf{constructor(){super(),this._doc=F(Le),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return $n().getBaseHref(this._doc)}onPopState(t){let r=$n().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=$n().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>new n,providedIn:"platform"})}}return n})();function Xf(n,e){if(n.length==0)return e;if(e.length==0)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,t==2?n+e.substring(1):t==1?n+e:n+"/"+e}function Gf(n){let e=n.match(/#|\?|$/),t=e&&e.index||n.length,r=t-(n[t-1]==="/"?1:0);return n.slice(0,r)+n.slice(t)}function un(n){return n&&n[0]!=="?"?"?"+n:n}var Ls=(()=>{class n{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>F(Zf),providedIn:"root"})}}return n})(),Ov=new ae(""),Zf=(()=>{class n extends Ls{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??F(Le).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Xf(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+un(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){let a=this.prepareExternalUrl(i+un(s));this._platformLocation.pushState(t,r,a)}replaceState(t,r,i,s){let a=this.prepareExternalUrl(i+un(s));this._platformLocation.replaceState(t,r,a)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(Q(Jf),Q(Ov,8))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var Qr=(()=>{class n{constructor(t){this._subject=new an,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=xv(Gf(Wf(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+un(r))}normalize(t){return n.stripTrailingSlash(Mv(this._basePath,Wf(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+un(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+un(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=un}static{this.joinWithSlash=Xf}static{this.stripTrailingSlash=Gf}static{this.\u0275fac=function(r){return new(r||n)(Q(Ls))}}static{this.\u0275prov=W({token:n,factory:()=>kv(),providedIn:"root"})}}return n})();function kv(){return new Qr(Q(Ls))}function Mv(n,e){if(!n||!e.startsWith(n))return e;let t=e.substring(n.length);return t===""||["/",";","?","#"].includes(t[0])?t:e}function Wf(n){return n.replace(/\/index.html$/,"")}function xv(n){if(new RegExp("^(https?:)?//").test(n)){let[,t]=n.split(/\/\/[^\/]+/);return t}return n}function Vs(n,e){e=encodeURIComponent(e);for(let t of n.split(";")){let r=t.indexOf("="),[i,s]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}var mu=/\s+/,Hf=[],YD=(()=>{class n{constructor(t,r){this._ngEl=t,this._renderer=r,this.initialClasses=Hf,this.stateMap=new Map}set klass(t){this.initialClasses=t!=null?t.trim().split(mu):Hf}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split(mu):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split(mu).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static{this.\u0275fac=function(r){return new(r||n)(Rs(Cs),Rs(Ps))}}static{this.\u0275dir=Ss({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return n})();function Fv(n,e){return new fe(2100,!1)}var JD=(()=>{class n{transform(t,r,i){if(t==null)return null;if(!this.supports(t))throw Fv(n,t);return t.slice(r,i)}supports(t){return typeof t=="string"||Array.isArray(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275pipe=xf({name:"slice",type:n,pure:!1,standalone:!0})}}return n})();var ep="browser",Lv="server";function Us(n){return n===Lv}var jn=class{};var Jr=class{},$s=class{},It=class n{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?typeof e=="string"?this.lazyInit=()=>{this.headers=new Map,e.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),s=i.toLowerCase(),a=t.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(a):this.headers.set(s,[a])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();let t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){let t=new n;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){let t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(e.name,t);let i=(e.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let s=e.value;if(!s)this.headers.delete(t),this.normalizedNames.delete(t);else{let a=this.headers.get(t);if(!a)return;a=a.filter(u=>s.indexOf(u)===-1),a.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,a)}break}}setHeaderEntries(e,t){let r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}};var wu=class{encodeKey(e){return tp(e)}encodeValue(e){return tp(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}};function Uv(n,e){let t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{let s=i.indexOf("="),[a,u]=s==-1?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],c=t.get(a)||[];c.push(u),t.set(a,c)}),t}var Bv=/%(\d[a-f0-9])/gi,$v={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function tp(n){return encodeURIComponent(n).replace(Bv,(e,t)=>$v[t]??e)}function Bs(n){return`${n}`}var Bt=class n{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new wu,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=Uv(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{let r=e.fromObject[t],i=Array.isArray(r)?r.map(Bs):[Bs(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();let t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){let t=[];return Object.keys(e).forEach(r=>{let i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{let t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>e!=="").join("&")}clone(e){let t=new n({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":let t=(e.op==="a"?this.map.get(e.param):void 0)||[];t.push(Bs(e.value)),this.map.set(e.param,t);break;case"d":if(e.value!==void 0){let r=this.map.get(e.param)||[],i=r.indexOf(Bs(e.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}else{this.map.delete(e.param);break}}}),this.cloneFrom=this.updates=null)}};var Eu=class{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}};function jv(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function np(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function rp(n){return typeof Blob<"u"&&n instanceof Blob}function ip(n){return typeof FormData<"u"&&n instanceof FormData}function zv(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var Yr=class n{constructor(e,t,r,i){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase();let s;if(jv(this.method)||i?(this.body=r!==void 0?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params),this.transferCache=s.transferCache),this.headers??=new It,this.context??=new Eu,!this.params)this.params=new Bt,this.urlWithParams=t;else{let a=this.params.toString();if(a.length===0)this.urlWithParams=t;else{let u=t.indexOf("?"),c=u===-1?"?":u<t.length-1?"&":"";this.urlWithParams=t+c+a}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||np(this.body)||rp(this.body)||ip(this.body)||zv(this.body)?this.body:this.body instanceof Bt?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||ip(this.body)?null:rp(this.body)?this.body.type||null:np(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof Bt?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(e={}){let t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=e.transferCache??this.transferCache,a=e.body!==void 0?e.body:this.body,u=e.withCredentials??this.withCredentials,c=e.reportProgress??this.reportProgress,d=e.headers||this.headers,p=e.params||this.params,m=e.context??this.context;return e.setHeaders!==void 0&&(d=Object.keys(e.setHeaders).reduce((w,S)=>w.set(S,e.setHeaders[S]),d)),e.setParams&&(p=Object.keys(e.setParams).reduce((w,S)=>w.set(S,e.setParams[S]),p)),new n(t,r,a,{params:p,headers:d,context:m,reportProgress:c,responseType:i,withCredentials:u,transferCache:s})}},$t=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}($t||{}),Xr=class{constructor(e,t=200,r="OK"){this.headers=e.headers||new It,this.status=e.status!==void 0?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}},js=class n extends Xr{constructor(e={}){super(e),this.type=$t.ResponseHeader}clone(e={}){return new n({headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Zr=class n extends Xr{constructor(e={}){super(e),this.type=$t.Response,this.body=e.body!==void 0?e.body:null}clone(e={}){return new n({body:e.body!==void 0?e.body:this.body,headers:e.headers||this.headers,status:e.status!==void 0?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}},Ut=class extends Xr{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${e.url||"(unknown url)"}`:this.message=`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}},up=200,qv=204;function _u(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var Au=(()=>{class n{constructor(t){this.handler=t}request(t,r,i={}){let s;if(t instanceof Yr)s=t;else{let c;i.headers instanceof It?c=i.headers:c=new It(i.headers);let d;i.params&&(i.params instanceof Bt?d=i.params:d=new Bt({fromObject:i.params})),s=new Yr(t,r,i.body!==void 0?i.body:null,{headers:c,context:i.context,params:d,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}let a=z(s).pipe(sn(c=>this.handler.handle(c)));if(t instanceof Yr||i.observe==="events")return a;let u=a.pipe(wt(c=>c instanceof Zr));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return u.pipe(K(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return u.pipe(K(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return u.pipe(K(c=>{if(c.body!==null&&typeof c.body!="string")throw new Error("Response is not a string.");return c.body}));case"json":default:return u.pipe(K(c=>c.body))}case"response":return u;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:new Bt().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,_u(i,r))}post(t,r,i={}){return this.request("POST",t,_u(i,r))}put(t,r,i={}){return this.request("PUT",t,_u(i,r))}static{this.\u0275fac=function(r){return new(r||n)(Q(Jr))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})(),Gv=/^\)\]\}',?\n/,Wv="X-Request-URL";function sp(n){if(n.url)return n.url;let e=Wv.toLocaleLowerCase();return n.headers.get(e)}var Hv=(()=>{class n{constructor(){this.fetchImpl=F(Iu,{optional:!0})?.fetch??((...t)=>globalThis.fetch(...t)),this.ngZone=F(xe)}handle(t){return new Lt(r=>{let i=new AbortController;return this.doRequest(t,i.signal,r).then(Tu,s=>r.error(new Ut({error:s}))),()=>i.abort()})}doRequest(t,r,i){return D(this,null,function*(){let s=this.createRequestInit(t),a;try{let S=this.ngZone.runOutsideAngular(()=>this.fetchImpl(t.urlWithParams,V({signal:r},s)));Kv(S),i.next({type:$t.Sent}),a=yield S}catch(S){i.error(new Ut({error:S,status:S.status??0,statusText:S.statusText,url:t.urlWithParams,headers:S.headers}));return}let u=new It(a.headers),c=a.statusText,d=sp(a)??t.urlWithParams,p=a.status,m=null;if(t.reportProgress&&i.next(new js({headers:u,status:p,statusText:c,url:d})),a.body){let S=a.headers.get("content-length"),P=[],N=a.body.getReader(),C=0,U,j,L=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>D(this,null,function*(){for(;;){let{done:le,value:X}=yield N.read();if(le)break;if(P.push(X),C+=X.length,t.reportProgress){j=t.responseType==="text"?(j??"")+(U??=new TextDecoder).decode(X,{stream:!0}):void 0;let E=()=>i.next({type:$t.DownloadProgress,total:S?+S:void 0,loaded:C,partialText:j});L?L.run(E):E()}}}));let ne=this.concatChunks(P,C);try{let le=a.headers.get("Content-Type")??"";m=this.parseBody(t,ne,le)}catch(le){i.error(new Ut({error:le,headers:new It(a.headers),status:a.status,statusText:a.statusText,url:sp(a)??t.urlWithParams}));return}}p===0&&(p=m?up:0),p>=200&&p<300?(i.next(new Zr({body:m,headers:u,status:p,statusText:c,url:d})),i.complete()):i.error(new Ut({error:m,headers:u,status:p,statusText:c,url:d}))})}parseBody(t,r,i){switch(t.responseType){case"json":let s=new TextDecoder().decode(r).replace(Gv,"");return s===""?null:JSON.parse(s);case"text":return new TextDecoder().decode(r);case"blob":return new Blob([r],{type:i});case"arraybuffer":return r.buffer}}createRequestInit(t){let r={},i=t.withCredentials?"include":void 0;if(t.headers.forEach((s,a)=>r[s]=a.join(",")),t.headers.has("Accept")||(r.Accept="application/json, text/plain, */*"),!t.headers.has("Content-Type")){let s=t.detectContentTypeHeader();s!==null&&(r["Content-Type"]=s)}return{body:t.serializeBody(),method:t.method,headers:r,credentials:i}}concatChunks(t,r){let i=new Uint8Array(r),s=0;for(let a of t)i.set(a,s),s+=a.length;return i}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})(),Iu=class{};function Tu(){}function Kv(n){n.then(Tu,Tu)}function Qv(n,e){return e(n)}function Yv(n,e,t){return(r,i)=>et(t,()=>e(r,s=>n(s,i)))}var cp=new ae(""),Jv=new ae(""),Xv=new ae("",{providedIn:"root",factory:()=>!0});var op=(()=>{class n extends Jr{constructor(t,r){super(),this.backend=t,this.injector=r,this.chain=null,this.pendingTasks=F(bs),this.contributeToStability=F(Xv)}handle(t){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(cp),...this.injector.get(Jv,[])]));this.chain=r.reduceRight((i,s)=>Yv(i,s,this.injector),Qv)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(Vn(()=>this.pendingTasks.remove(r)))}else return this.chain(t,r=>this.backend.handle(r))}static{this.\u0275fac=function(r){return new(r||n)(Q($s),Q(Un))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})();var Zv=/^\)\]\}',?\n/;function e_(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}var ap=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new fe(-2800,!1);let r=this.xhrFactory;return(r.\u0275loadImpl?Fe(r.\u0275loadImpl()):z(null)).pipe(He(()=>new Lt(s=>{let a=r.build();if(a.open(t.method,t.urlWithParams),t.withCredentials&&(a.withCredentials=!0),t.headers.forEach((N,C)=>a.setRequestHeader(N,C.join(","))),t.headers.has("Accept")||a.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){let N=t.detectContentTypeHeader();N!==null&&a.setRequestHeader("Content-Type",N)}if(t.responseType){let N=t.responseType.toLowerCase();a.responseType=N!=="json"?N:"text"}let u=t.serializeBody(),c=null,d=()=>{if(c!==null)return c;let N=a.statusText||"OK",C=new It(a.getAllResponseHeaders()),U=e_(a)||t.url;return c=new js({headers:C,status:a.status,statusText:N,url:U}),c},p=()=>{let{headers:N,status:C,statusText:U,url:j}=d(),L=null;C!==qv&&(L=typeof a.response>"u"?a.responseText:a.response),C===0&&(C=L?up:0);let ne=C>=200&&C<300;if(t.responseType==="json"&&typeof L=="string"){let le=L;L=L.replace(Zv,"");try{L=L!==""?JSON.parse(L):null}catch(X){L=le,ne&&(ne=!1,L={error:X,text:L})}}ne?(s.next(new Zr({body:L,headers:N,status:C,statusText:U,url:j||void 0})),s.complete()):s.error(new Ut({error:L,headers:N,status:C,statusText:U,url:j||void 0}))},m=N=>{let{url:C}=d(),U=new Ut({error:N,status:a.status||0,statusText:a.statusText||"Unknown Error",url:C||void 0});s.error(U)},w=!1,S=N=>{w||(s.next(d()),w=!0);let C={type:$t.DownloadProgress,loaded:N.loaded};N.lengthComputable&&(C.total=N.total),t.responseType==="text"&&a.responseText&&(C.partialText=a.responseText),s.next(C)},P=N=>{let C={type:$t.UploadProgress,loaded:N.loaded};N.lengthComputable&&(C.total=N.total),s.next(C)};return a.addEventListener("load",p),a.addEventListener("error",m),a.addEventListener("timeout",m),a.addEventListener("abort",m),t.reportProgress&&(a.addEventListener("progress",S),u!==null&&a.upload&&a.upload.addEventListener("progress",P)),a.send(u),s.next({type:$t.Sent}),()=>{a.removeEventListener("error",m),a.removeEventListener("abort",m),a.removeEventListener("load",p),a.removeEventListener("timeout",m),t.reportProgress&&(a.removeEventListener("progress",S),u!==null&&a.upload&&a.upload.removeEventListener("progress",P)),a.readyState!==a.DONE&&a.abort()}})))}static{this.\u0275fac=function(r){return new(r||n)(Q(jn))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})(),lp=new ae(""),t_="XSRF-TOKEN",n_=new ae("",{providedIn:"root",factory:()=>t_}),r_="X-XSRF-TOKEN",i_=new ae("",{providedIn:"root",factory:()=>r_}),zs=class{},s_=(()=>{class n{constructor(t,r,i){this.doc=t,this.platform=r,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=Vs(t,this.cookieName),this.lastCookieString=t),this.lastToken}static{this.\u0275fac=function(r){return new(r||n)(Q(Le),Q(at),Q(n_))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})();function o_(n,e){let t=n.url.toLowerCase();if(!F(lp)||n.method==="GET"||n.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return e(n);let r=F(zs).getToken(),i=F(i_);return r!=null&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,r)})),e(n)}function hS(...n){let e=[Au,ap,op,{provide:Jr,useExisting:op},{provide:$s,useFactory:()=>F(Hv,{optional:!0})??F(ap)},{provide:cp,useValue:o_,multi:!0},{provide:lp,useValue:!0},{provide:zs,useClass:s_}];for(let t of n)e.push(...t.\u0275providers);return Et(e)}var bu=class extends Fs{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Cu=class n extends bu{static makeCurrent(){Yf(new n)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=u_();return t==null?null:c_(t)}resetBaseElement(){ei=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return Vs(document.cookie,e)}},ei=null;function u_(){return ei=ei||document.querySelector("base"),ei?ei.getAttribute("href"):null}function c_(n){return new URL(n,document.baseURI).pathname}var l_=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})(),Ru=new ae(""),pp=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new fe(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||n)(Q(Ru),Q(xe))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})(),qs=class{constructor(e){this._doc=e}},Du="ng-app-id",gp=(()=>{class n{constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Us(s),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${Du}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let s=i.get(t);return s.usage+=r,s.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===t)return i.delete(r),s.removeAttribute(Du),s;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=r,this.platformIsServer&&a.setAttribute(Du,this.appId),t.appendChild(a),a}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),s=this.styleRef,a=s.get(r)?.elements;a?a.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||n)(Q(Le),Q(au),Q(uu,8),Q(at))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})(),Su={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Nu=/%COMP%/g,mp="%COMP%",h_=`_nghost-${mp}`,d_=`_ngcontent-${mp}`,f_=!0,p_=new ae("",{providedIn:"root",factory:()=>f_});function g_(n){return d_.replace(Nu,n)}function m_(n){return h_.replace(Nu,n)}function yp(n,e){return e.map(t=>t.replace(Nu,n))}var hp=(()=>{class n{constructor(t,r,i,s,a,u,c,d=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=a,this.platformId=u,this.ngZone=c,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=Us(u),this.defaultRenderer=new ti(t,a,c,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Gr.ShadowDom&&(r=_e(V({},r),{encapsulation:Gr.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof Gs?i.applyToHost(t):i instanceof ni&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,s=i.get(r.id);if(!s){let a=this.doc,u=this.ngZone,c=this.eventManager,d=this.sharedStylesHost,p=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(r.encapsulation){case Gr.Emulated:s=new Gs(c,d,r,this.appId,p,a,u,m);break;case Gr.ShadowDom:return new Pu(c,d,t,r,a,u,this.nonce,m);default:s=new ni(c,d,r,p,a,u,m);break}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||n)(Q(pp),Q(gp),Q(au),Q(p_),Q(Le),Q(at),Q(xe),Q(uu))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})(),ti=class{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Su[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(dp(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(dp(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){t.remove()}selectRootElement(e,t){let r=typeof e=="string"?this.doc.querySelector(e):e;if(!r)throw new fe(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;let s=Su[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){let i=Su[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(Bn.DashCase|Bn.Important)?e.style.setProperty(t,r,i&Bn.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&Bn.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e!=null&&(e[t]=r)}setValue(e,t){e.nodeValue=t}listen(e,t,r){if(typeof e=="string"&&(e=$n().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function dp(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var Pu=class extends ti{constructor(e,t,r,i,s,a,u,c){super(e,s,a,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=yp(i.id,i.styles);for(let p of d){let m=document.createElement("style");u&&m.setAttribute("nonce",u),m.textContent=p,this.shadowRoot.appendChild(m)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},ni=class extends ti{constructor(e,t,r,i,s,a,u,c){super(e,s,a,u),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?yp(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},Gs=class extends ni{constructor(e,t,r,i,s,a,u,c){let d=i+"-"+r.id;super(e,t,r,s,a,u,c,d),this.contentAttr=g_(d),this.hostAttr=m_(d)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}},y_=(()=>{class n extends qs{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||n)(Q(Le))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})(),fp=["alt","control","meta","shift"],v_={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},__={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},w_=(()=>{class n extends qs{constructor(t){super(t)}supports(t){return n.parseEventName(t)!=null}addEventListener(t,r,i){let s=n.parseEventName(r),a=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>$n().onAndCancel(t,s.domEventName,a))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let s=n._normalizeKey(r.pop()),a="",u=r.indexOf("code");if(u>-1&&(r.splice(u,1),a="code."),fp.forEach(d=>{let p=r.indexOf(d);p>-1&&(r.splice(p,1),a+=d+".")}),a+=s,r.length!=0||s.length===0)return null;let c={};return c.domEventName=i,c.fullKey=a,c}static matchEventFullKeyCode(t,r){let i=v_[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),fp.forEach(a=>{if(a!==i){let u=__[a];u(t)&&(s+=a+".")}}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||n)(Q(Le))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac})}}return n})();function qS(n,e,t){return qf(V({rootComponent:n,platformRef:t?.platformRef},E_(e)))}function E_(n){return{appProviders:[...S_,...n?.providers??[]],platformProviders:D_}}function I_(){Cu.makeCurrent()}function T_(){return new ou}function A_(){return Lf(document),document}var D_=[{provide:at,useValue:ep},{provide:Vf,useValue:I_,multi:!0},{provide:Le,useFactory:A_,deps:[]}];var S_=[{provide:Ff,useValue:"root"},{provide:ou,useFactory:T_,deps:[]},{provide:Ru,useClass:y_,multi:!0,deps:[Le,xe,at]},{provide:Ru,useClass:w_,multi:!0,deps:[Le]},hp,gp,pp,{provide:Uf,useExisting:hp},{provide:jn,useClass:l_,deps:[]},[]];var vp=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(r){return new(r||n)(Q(Le))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var wp=function(n){let e=[],t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},C_=function(n){let e=[],t=0,r=0;for(;t<n.length;){let i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){let s=n[t++],a=n[t++],u=n[t++],c=((i&7)<<18|(s&63)<<12|(a&63)<<6|u&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{let s=n[t++],a=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|a&63)}}return e.join("")},Ep={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();let t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){let s=n[i],a=i+1<n.length,u=a?n[i+1]:0,c=i+2<n.length,d=c?n[i+2]:0,p=s>>2,m=(s&3)<<4|u>>4,w=(u&15)<<2|d>>6,S=d&63;c||(S=64,a||(w=64)),r.push(t[p],t[m],t[w],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(wp(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):C_(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();let t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){let s=t[n.charAt(i++)],u=i<n.length?t[n.charAt(i)]:0;++i;let d=i<n.length?t[n.charAt(i)]:64;++i;let m=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||u==null||d==null||m==null)throw new ku;let w=s<<2|u>>4;if(r.push(w),d!==64){let S=u<<4&240|d>>2;if(r.push(S),m!==64){let P=d<<6&192|m;r.push(P)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}},ku=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}},R_=function(n){let e=wp(n);return Ep.encodeByteArray(e,!0)},ri=function(n){return R_(n).replace(/\./g,"")},xu=function(n){try{return Ep.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function P_(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}var N_=()=>P_().__FIREBASE_DEFAULTS__,O_=()=>{if(typeof process>"u"||typeof process.env>"u")return;let n=process.env.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},k_=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}let e=n&&xu(n[1]);return e&&JSON.parse(e)},Hs=()=>{try{return N_()||O_()||k_()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},Ip=n=>{var e,t;return(t=(e=Hs())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},Tp=n=>{let e=Ip(n);if(!e)return;let t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);let r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},Fu=()=>{var n;return(n=Hs())===null||n===void 0?void 0:n.config},Ap=n=>{var e;return(e=Hs())===null||e===void 0?void 0:e[`_${n}`]};var Ws=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}};function Dp(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");let a=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[ri(JSON.stringify(t)),ri(JSON.stringify(a)),""].join(".")}function Ue(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Sp(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ue())}function M_(){var n;let e=(n=Hs())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function bp(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Cp(){let n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function Rp(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Pp(){return!M_()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Lu(){try{return typeof indexedDB=="object"}catch{return!1}}function Np(){return new Promise((n,e)=>{try{let t=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}var x_="FirebaseError",Ke=class n extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=x_,Object.setPrototypeOf(this,n.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Tt.prototype.create)}},Tt=class{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],a=s?F_(s,r):"Error",u=`${this.serviceName}: ${a} (${i}).`;return new Ke(i,u,r)}};function F_(n,e){return n.replace(L_,(t,r)=>{let i=e[r];return i!=null?String(i):`<${r}?>`})}var L_=/\{\$([^}]+)}/g;function zn(n,e){if(n===e)return!0;let t=Object.keys(n),r=Object.keys(e);for(let i of t){if(!r.includes(i))return!1;let s=n[i],a=e[i];if(_p(s)&&_p(a)){if(!zn(s,a))return!1}else if(s!==a)return!1}for(let i of r)if(!t.includes(i))return!1;return!0}function _p(n){return n!==null&&typeof n=="object"}function Vu(n){let e=[];for(let[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Op(n,e){let t=new Mu(n,e);return t.subscribe.bind(t)}var Mu=class{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");V_(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=Ou),i.error===void 0&&(i.error=Ou),i.complete===void 0&&(i.complete=Ou);let s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function V_(n,e){if(typeof n!="object"||n===null)return!1;for(let t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Ou(){}var WS=4*60*60*1e3;function Te(n){return n&&n._delegate?n._delegate:n}var Qe=class{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};var ln="[DEFAULT]";var Uu=class{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let r=new Ws;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{let i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let r=this.normalizeInstanceIdentifier(e?.identifier),i=(t=e?.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(B_(e))try{this.getOrInitializeService({instanceIdentifier:ln})}catch{}for(let[t,r]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(t);try{let s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=ln){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){return D(this,null,function*(){let e=Array.from(this.instances.values());yield Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])})}isComponentSet(){return this.component!=null}isInitialized(e=ln){return this.instances.has(e)}getOptions(e=ln){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[s,a]of this.instancesDeferred.entries()){let u=this.normalizeInstanceIdentifier(s);r===u&&a.resolve(i)}return i}onInit(e,t){var r;let i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);let a=this.instances.get(i);return a&&e(a,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:U_(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ln){return this.component?this.component.multipleInstances?e:ln:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function U_(n){return n===ln?void 0:n}function B_(n){return n.instantiationMode==="EAGER"}var Ks=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new Uu(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}};var $_=[],Y=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(Y||{}),j_={debug:Y.DEBUG,verbose:Y.VERBOSE,info:Y.INFO,warn:Y.WARN,error:Y.ERROR,silent:Y.SILENT},z_=Y.INFO,q_={[Y.DEBUG]:"log",[Y.VERBOSE]:"log",[Y.INFO]:"info",[Y.WARN]:"warn",[Y.ERROR]:"error"},G_=(n,e,...t)=>{if(e<n.logLevel)return;let r=new Date().toISOString(),i=q_[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)},jt=class{constructor(e){this.name=e,this._logLevel=z_,this._logHandler=G_,this._userLogHandler=null,$_.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Y))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?j_[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Y.DEBUG,...e),this._logHandler(this,Y.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Y.VERBOSE,...e),this._logHandler(this,Y.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Y.INFO,...e),this._logHandler(this,Y.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Y.WARN,...e),this._logHandler(this,Y.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Y.ERROR,...e),this._logHandler(this,Y.ERROR,...e)}};var W_=(n,e)=>e.some(t=>n instanceof t),kp,Mp;function H_(){return kp||(kp=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function K_(){return Mp||(Mp=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}var xp=new WeakMap,$u=new WeakMap,Fp=new WeakMap,Bu=new WeakMap,zu=new WeakMap;function Q_(n){let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",a)},s=()=>{t(ut(n.result)),i()},a=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",a)});return e.then(t=>{t instanceof IDBCursor&&xp.set(t,n)}).catch(()=>{}),zu.set(e,n),e}function Y_(n){if($u.has(n))return;let e=new Promise((t,r)=>{let i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",a),n.removeEventListener("abort",a)},s=()=>{t(),i()},a=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",a),n.addEventListener("abort",a)});$u.set(n,e)}var ju={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return $u.get(n);if(e==="objectStoreNames")return n.objectStoreNames||Fp.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return ut(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Lp(n){ju=n(ju)}function J_(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){let r=n.call(Qs(this),e,...t);return Fp.set(r,e.sort?e.sort():[e]),ut(r)}:K_().includes(n)?function(...e){return n.apply(Qs(this),e),ut(xp.get(this))}:function(...e){return ut(n.apply(Qs(this),e))}}function X_(n){return typeof n=="function"?J_(n):(n instanceof IDBTransaction&&Y_(n),W_(n,H_())?new Proxy(n,ju):n)}function ut(n){if(n instanceof IDBRequest)return Q_(n);if(Bu.has(n))return Bu.get(n);let e=X_(n);return e!==n&&(Bu.set(n,e),zu.set(e,n)),e}var Qs=n=>zu.get(n);function Up(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){let a=indexedDB.open(n,e),u=ut(a);return r&&a.addEventListener("upgradeneeded",c=>{r(ut(a.result),c.oldVersion,c.newVersion,ut(a.transaction),c)}),t&&a.addEventListener("blocked",c=>t(c.oldVersion,c.newVersion,c)),u.then(c=>{s&&c.addEventListener("close",()=>s()),i&&c.addEventListener("versionchange",d=>i(d.oldVersion,d.newVersion,d))}).catch(()=>{}),u}var Z_=["get","getKey","getAll","getAllKeys","count"],ew=["put","add","delete","clear"],qu=new Map;function Vp(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(qu.get(e))return qu.get(e);let t=e.replace(/FromIndex$/,""),r=e!==t,i=ew.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||Z_.includes(t)))return;let s=function(a,...u){return D(this,null,function*(){let c=this.transaction(a,i?"readwrite":"readonly"),d=c.store;return r&&(d=d.index(u.shift())),(yield Promise.all([d[t](...u),i&&c.done]))[0]})};return qu.set(e,s),s}Lp(n=>_e(V({},n),{get:(e,t,r)=>Vp(e,t)||n.get(e,t,r),has:(e,t)=>!!Vp(e,t)||n.has(e,t)}));var Wu=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(tw(t)){let r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}};function tw(n){let e=n.getComponent();return e?.type==="VERSION"}var Hu="@firebase/app",Bp="0.10.13";var At=new jt("@firebase/app"),nw="@firebase/app-compat",rw="@firebase/analytics-compat",iw="@firebase/analytics",sw="@firebase/app-check-compat",ow="@firebase/app-check",aw="@firebase/auth",uw="@firebase/auth-compat",cw="@firebase/database",lw="@firebase/data-connect",hw="@firebase/database-compat",dw="@firebase/functions",fw="@firebase/functions-compat",pw="@firebase/installations",gw="@firebase/installations-compat",mw="@firebase/messaging",yw="@firebase/messaging-compat",vw="@firebase/performance",_w="@firebase/performance-compat",ww="@firebase/remote-config",Ew="@firebase/remote-config-compat",Iw="@firebase/storage",Tw="@firebase/storage-compat",Aw="@firebase/firestore",Dw="@firebase/vertexai-preview",Sw="@firebase/firestore-compat",bw="firebase",Cw="10.14.1";var Ku="[DEFAULT]",Rw={[Hu]:"fire-core",[nw]:"fire-core-compat",[iw]:"fire-analytics",[rw]:"fire-analytics-compat",[ow]:"fire-app-check",[sw]:"fire-app-check-compat",[aw]:"fire-auth",[uw]:"fire-auth-compat",[cw]:"fire-rtdb",[lw]:"fire-data-connect",[hw]:"fire-rtdb-compat",[dw]:"fire-fn",[fw]:"fire-fn-compat",[pw]:"fire-iid",[gw]:"fire-iid-compat",[mw]:"fire-fcm",[yw]:"fire-fcm-compat",[vw]:"fire-perf",[_w]:"fire-perf-compat",[ww]:"fire-rc",[Ew]:"fire-rc-compat",[Iw]:"fire-gcs",[Tw]:"fire-gcs-compat",[Aw]:"fire-fst",[Sw]:"fire-fst-compat",[Dw]:"fire-vertex","fire-js":"fire-js",[bw]:"fire-js-all"};var ii=new Map,Pw=new Map,Qu=new Map;function $p(n,e){try{n.container.addComponent(e)}catch(t){At.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function qt(n){let e=n.name;if(Qu.has(e))return At.debug(`There were multiple attempts to register component ${e}.`),!1;Qu.set(e,n);for(let t of ii.values())$p(t,n);for(let t of Pw.values())$p(t,n);return!0}function Zu(n,e){let t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function qn(n){return n.settings!==void 0}var Nw={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},zt=new Tt("app","Firebase",Nw);var Yu=class{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Qe("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw zt.create("app-deleted",{appName:this._name})}};var Gn=Cw;function ec(n,e={}){let t=n;typeof e!="object"&&(e={name:e});let r=Object.assign({name:Ku,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw zt.create("bad-app-name",{appName:String(i)});if(t||(t=Fu()),!t)throw zt.create("no-options");let s=ii.get(i);if(s){if(zn(t,s.options)&&zn(r,s.config))return s;throw zt.create("duplicate-app",{appName:i})}let a=new Ks(i);for(let c of Qu.values())a.addComponent(c);let u=new Yu(t,r,a);return ii.set(i,u),u}function oi(n=Ku){let e=ii.get(n);if(!e&&n===Ku&&Fu())return ec();if(!e)throw zt.create("no-app",{appName:n});return e}function Ys(){return Array.from(ii.values())}function we(n,e,t){var r;let i=(r=Rw[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);let s=i.match(/\s|\//),a=e.match(/\s|\//);if(s||a){let u=[`Unable to register library "${i}" with version "${e}":`];s&&u.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&u.push("and"),a&&u.push(`version name "${e}" contains illegal characters (whitespace or "/")`),At.warn(u.join(" "));return}qt(new Qe(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}var Ow="firebase-heartbeat-database",kw=1,si="firebase-heartbeat-store",Gu=null;function Gp(){return Gu||(Gu=Up(Ow,kw,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(si)}catch(t){console.warn(t)}}}}).catch(n=>{throw zt.create("idb-open",{originalErrorMessage:n.message})})),Gu}function Mw(n){return D(this,null,function*(){try{let t=(yield Gp()).transaction(si),r=yield t.objectStore(si).get(Wp(n));return yield t.done,r}catch(e){if(e instanceof Ke)At.warn(e.message);else{let t=zt.create("idb-get",{originalErrorMessage:e?.message});At.warn(t.message)}}})}function jp(n,e){return D(this,null,function*(){try{let r=(yield Gp()).transaction(si,"readwrite");yield r.objectStore(si).put(e,Wp(n)),yield r.done}catch(t){if(t instanceof Ke)At.warn(t.message);else{let r=zt.create("idb-set",{originalErrorMessage:t?.message});At.warn(r.message)}}})}function Wp(n){return`${n.name}!${n.options.appId}`}var xw=1024,Fw=30*24*60*60*1e3,Ju=class{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new Xu(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){return D(this,null,function*(){var e,t;try{let i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=zp();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=yield this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(a=>a.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(a=>{let u=new Date(a.date).valueOf();return Date.now()-u<=Fw}),this._storage.overwrite(this._heartbeatsCache))}catch(r){At.warn(r)}})}getHeartbeatsHeader(){return D(this,null,function*(){var e;try{if(this._heartbeatsCache===null&&(yield this._heartbeatsCachePromise),((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";let t=zp(),{heartbeatsToSend:r,unsentEntries:i}=Lw(this._heartbeatsCache.heartbeats),s=ri(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,yield this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return At.warn(t),""}})}};function zp(){return new Date().toISOString().substring(0,10)}function Lw(n,e=xw){let t=[],r=n.slice();for(let i of n){let s=t.find(a=>a.agent===i.agent);if(s){if(s.dates.push(i.date),qp(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),qp(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}var Xu=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return D(this,null,function*(){return Lu()?Np().then(()=>!0).catch(()=>!1):!1})}read(){return D(this,null,function*(){if(yield this._canUseIndexedDBPromise){let t=yield Mw(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}})}overwrite(e){return D(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return jp(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return})}add(e){return D(this,null,function*(){var t;if(yield this._canUseIndexedDBPromise){let i=yield this.read();return jp(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return})}};function qp(n){return ri(JSON.stringify({version:2,heartbeats:n})).length}function Vw(n){qt(new Qe("platform-logger",e=>new Wu(e),"PRIVATE")),qt(new Qe("heartbeat",e=>new Ju(e),"PRIVATE")),we(Hu,Bp,n),we(Hu,Bp,"esm2017"),we("fire-js","")}Vw("");var Uw="firebase",Bw="10.14.1";we(Uw,Bw,"app");var Hn=new Hr("ANGULARFIRE2_VERSION");function nc(n,e,t){if(e){if(e.length===1)return e[0];let s=e.filter(a=>a.app===t);if(s.length===1)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}var ui=(n,e)=>{let t=e?[e]:Ys(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(a=>{r.includes(a)||r.push(a)})}),r},ai=class{constructor(){return ui($w)}},$w="app-check";function Wn(){}var Js=class{zone;delegate;constructor(e,t=bf){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){let i=this.zone,s=function(a){i.runGuarded(()=>{e.apply(this,[a])})};return this.delegate.schedule(s,t,r)}},tc=class{zone;task=null;constructor(e){this.zone=e}call(e,t){let r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Wn,{},Wn,Wn)),t.pipe(ve({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},ci=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new Js(Zone.current)),this.insideAngular=t.run(()=>new Js(Zone.current,Sf)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(Q(xe))};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Xs(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function jw(n){return Xs().ngZone.runOutsideAngular(()=>n())}function hn(n){return Xs().ngZone.run(()=>n())}function zw(n){return qw(Xs())(n)}function qw(n){return function(t){return t=t.lift(new tc(n.ngZone)),t.pipe(Ya(n.outsideAngular),Qa(n.insideAngular))}}var Gw=(n,e)=>function(){let r=arguments;return e&&setTimeout(()=>{e.state==="scheduled"&&e.invoke()},10),hn(()=>n.apply(void 0,r))},tt=(n,e)=>function(){let t,r=arguments;for(let s=0;s<arguments.length;s++)typeof r[s]=="function"&&(e&&(t||=hn(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Wn,{},Wn,Wn))),r[s]=Gw(r[s],t));let i=jw(()=>n.apply(this,r));if(!e)if(i instanceof Lt){let s=Xs();return i.pipe(Ya(s.outsideAngular),Qa(s.insideAngular))}else return hn(()=>i);return i instanceof Lt?i.pipe(zw):i instanceof Promise?hn(()=>new Promise((s,a)=>i.then(u=>hn(()=>s(u)),u=>hn(()=>a(u))))):typeof i=="function"&&t?function(){return setTimeout(()=>{t&&t.state==="scheduled"&&t.invoke()},10),i.apply(this,arguments)}:hn(()=>i)};var dn=class{constructor(e){return e}},li=class{constructor(){return Ys()}};function Ww(n){return n&&n.length===1?n[0]:new dn(oi())}var rc=new ae("angularfire2._apps"),Hw={provide:dn,useFactory:Ww,deps:[[new ot,rc]]},Kw={provide:li,deps:[[new ot,rc]]};function Qw(n){return(e,t)=>{let r=t.get(at);we("angularfire",Hn.full,"core"),we("angularfire",Hn.full,"app"),we("angular",zf.full,r.toString());let i=e.runOutsideAngular(()=>n(t));return new dn(i)}}function Ob(n,...e){return Et([Hw,Kw,{provide:rc,useFactory:Qw(n),multi:!0,deps:[xe,on,ci,...e]}])}var kb=tt(ec,!0);function eg(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}var tg=eg,ng=new Tt("auth","Firebase",eg());var no=new jt("@firebase/auth");function Jw(n,...e){no.logLevel<=Y.WARN&&no.warn(`Auth (${Gn}): ${n}`,...e)}function eo(n,...e){no.logLevel<=Y.ERROR&&no.error(`Auth (${Gn}): ${n}`,...e)}function Hp(n,...e){throw gc(n,...e)}function pc(n,...e){return gc(n,...e)}function rg(n,e,t){let r=Object.assign(Object.assign({},tg()),{[e]:t});return new Tt("auth","Firebase",r).create(e,{appName:n.name})}function to(n){return rg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function gc(n,...e){if(typeof n!="string"){let t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return ng.create(n,...e)}function re(n,e,...t){if(!n)throw gc(e,...t)}function hi(n){let e="INTERNAL ASSERTION FAILED: "+n;throw eo(e),new Error(e)}function ro(n,e){n||hi(e)}function Xw(){return Kp()==="http:"||Kp()==="https:"}function Kp(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}function Zw(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Xw()||Cp()||"connection"in navigator)?navigator.onLine:!0}function eE(){if(typeof navigator>"u")return null;let n=navigator;return n.languages&&n.languages[0]||n.language||null}var pn=class{constructor(e,t){this.shortDelay=e,this.longDelay=t,ro(t>e,"Short delay should be less than long delay!"),this.isMobile=Sp()||Rp()}get(){return Zw()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};function tE(n,e){ro(n.emulator,"Emulator should always be set here");let{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}var io=class{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;hi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;hi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;hi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};var nE={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};var rE=new pn(3e4,6e4);function ig(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}function uo(s,a,u,c){return D(this,arguments,function*(n,e,t,r,i={}){return sg(n,i,()=>D(this,null,function*(){let d={},p={};r&&(e==="GET"?p=r:d={body:JSON.stringify(r)});let m=Vu(Object.assign({key:n.config.apiKey},p)).slice(1),w=yield n._getAdditionalHeaders();w["Content-Type"]="application/json",n.languageCode&&(w["X-Firebase-Locale"]=n.languageCode);let S=Object.assign({method:e,headers:w},d);return bp()||(S.referrerPolicy="no-referrer"),io.fetch()(og(n,n.config.apiHost,t,m),S)}))})}function sg(n,e,t){return D(this,null,function*(){n._canInitEmulator=!1;let r=Object.assign(Object.assign({},nE),e);try{let i=new oc(n),s=yield Promise.race([t(),i.promise]);i.clearNetworkTimeout();let a=yield s.json();if("needConfirmation"in a)throw Zs(n,"account-exists-with-different-credential",a);if(s.ok&&!("errorMessage"in a))return a;{let u=s.ok?a.errorMessage:a.error.message,[c,d]=u.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Zs(n,"credential-already-in-use",a);if(c==="EMAIL_EXISTS")throw Zs(n,"email-already-in-use",a);if(c==="USER_DISABLED")throw Zs(n,"user-disabled",a);let p=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw rg(n,p,d);Hp(n,p)}}catch(i){if(i instanceof Ke)throw i;Hp(n,"network-request-failed",{message:String(i)})}})}function og(n,e,t,r){let i=`${e}${t}?${r}`;return n.config.emulator?tE(n.config,i):`${n.config.apiScheme}://${i}`}var oc=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(pc(this.auth,"network-request-failed")),rE.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Zs(n,e,t){let r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);let i=pc(n,e,r);return i.customData._tokenResponse=t,i}function iE(n,e){return D(this,null,function*(){return uo(n,"POST","/v1/accounts:delete",e)})}function ag(n,e){return D(this,null,function*(){return uo(n,"POST","/v1/accounts:lookup",e)})}function di(n){if(n)try{let e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}function mc(n,e=!1){return D(this,null,function*(){let t=Te(n),r=yield t.getIdToken(e),i=ug(r);re(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");let s=typeof i.firebase=="object"?i.firebase:void 0,a=s?.sign_in_provider;return{claims:i,token:r,authTime:di(ic(i.auth_time)),issuedAtTime:di(ic(i.iat)),expirationTime:di(ic(i.exp)),signInProvider:a||null,signInSecondFactor:s?.sign_in_second_factor||null}})}function ic(n){return Number(n)*1e3}function ug(n){let[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return eo("JWT malformed, contained fewer than 3 sections"),null;try{let i=xu(t);return i?JSON.parse(i):(eo("Failed to decode base64 JWT payload"),null)}catch(i){return eo("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Qp(n){let e=ug(n);return re(e,"internal-error"),re(typeof e.exp<"u","internal-error"),re(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}function ac(n,e,t=!1){return D(this,null,function*(){if(t)return e;try{return yield e}catch(r){throw r instanceof Ke&&sE(r)&&n.auth.currentUser===n&&(yield n.auth.signOut()),r}})}function sE({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}var uc=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;let i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(()=>D(this,null,function*(){yield this.iteration()}),t)}iteration(){return D(this,null,function*(){try{yield this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()})}};var pi=class{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=di(this.lastLoginAt),this.creationTime=di(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};function so(n){return D(this,null,function*(){var e;let t=n.auth,r=yield n.getIdToken(),i=yield ac(n,ag(t,{idToken:r}));re(i?.users.length,t,"internal-error");let s=i.users[0];n._notifyReloadListener(s);let a=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?cg(s.providerUserInfo):[],u=oE(n.providerData,a),c=n.isAnonymous,d=!(n.email&&s.passwordHash)&&!u?.length,p=c?d:!1,m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:u,metadata:new pi(s.createdAt,s.lastLoginAt),isAnonymous:p};Object.assign(n,m)})}function yc(n){return D(this,null,function*(){let e=Te(n);yield so(e),yield e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)})}function oE(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function cg(n){return n.map(e=>{var{providerId:t}=e,r=Ka(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}function aE(n,e){return D(this,null,function*(){let t=yield sg(n,{},()=>D(this,null,function*(){let r=Vu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,a=og(n,i,"/v1/token",`key=${s}`),u=yield n._getAdditionalHeaders();return u["Content-Type"]="application/x-www-form-urlencoded",io.fetch()(a,{method:"POST",headers:u,body:r})}));return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}})}function uE(n,e){return D(this,null,function*(){return uo(n,"POST","/v2/accounts:revokeToken",ig(n,e))})}var fi=class n{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){re(e.idToken,"internal-error"),re(typeof e.idToken<"u","internal-error"),re(typeof e.refreshToken<"u","internal-error");let t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Qp(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){re(e.length!==0,"internal-error");let t=Qp(e);this.updateTokensAndExpiration(e,null,t)}getToken(e,t=!1){return D(this,null,function*(){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(re(this.refreshToken,e,"user-token-expired"),this.refreshToken?(yield this.refresh(e,this.refreshToken),this.accessToken):null)})}clearRefreshToken(){this.refreshToken=null}refresh(e,t){return D(this,null,function*(){let{accessToken:r,refreshToken:i,expiresIn:s}=yield aE(e,t);this.updateTokensAndExpiration(r,i,Number(s))})}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){let{refreshToken:r,accessToken:i,expirationTime:s}=t,a=new n;return r&&(re(typeof r=="string","internal-error",{appName:e}),a.refreshToken=r),i&&(re(typeof i=="string","internal-error",{appName:e}),a.accessToken=i),s&&(re(typeof s=="number","internal-error",{appName:e}),a.expirationTime=s),a}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new n,this.toJSON())}_performRefresh(){return hi("not implemented")}};function Gt(n,e){re(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}var gi=class n{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Ka(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new uc(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new pi(s.createdAt||void 0,s.lastLoginAt||void 0)}getIdToken(e){return D(this,null,function*(){let t=yield ac(this,this.stsTokenManager.getToken(this.auth,e));return re(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,yield this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t})}getIdTokenResult(e){return mc(this,e)}reload(){return yc(this)}_assign(e){this!==e&&(re(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new n(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){re(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(e,t=!1){return D(this,null,function*(){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&(yield so(this)),yield this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)})}delete(){return D(this,null,function*(){if(qn(this.auth.app))return Promise.reject(to(this.auth));let e=yield this.getIdToken();return yield ac(this,iE(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()})}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,a,u,c,d,p;let m=(r=t.displayName)!==null&&r!==void 0?r:void 0,w=(i=t.email)!==null&&i!==void 0?i:void 0,S=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,P=(a=t.photoURL)!==null&&a!==void 0?a:void 0,N=(u=t.tenantId)!==null&&u!==void 0?u:void 0,C=(c=t._redirectEventId)!==null&&c!==void 0?c:void 0,U=(d=t.createdAt)!==null&&d!==void 0?d:void 0,j=(p=t.lastLoginAt)!==null&&p!==void 0?p:void 0,{uid:L,emailVerified:ne,isAnonymous:le,providerData:X,stsTokenManager:E}=t;re(L&&E,e,"internal-error");let g=fi.fromJSON(this.name,E);re(typeof L=="string",e,"internal-error"),Gt(m,e.name),Gt(w,e.name),re(typeof ne=="boolean",e,"internal-error"),re(typeof le=="boolean",e,"internal-error"),Gt(S,e.name),Gt(P,e.name),Gt(N,e.name),Gt(C,e.name),Gt(U,e.name),Gt(j,e.name);let v=new n({uid:L,auth:e,email:w,emailVerified:ne,displayName:m,isAnonymous:le,photoURL:P,phoneNumber:S,tenantId:N,stsTokenManager:g,createdAt:U,lastLoginAt:j});return X&&Array.isArray(X)&&(v.providerData=X.map(_=>Object.assign({},_))),C&&(v._redirectEventId=C),v}static _fromIdTokenResponse(e,t,r=!1){return D(this,null,function*(){let i=new fi;i.updateFromServerResponse(t);let s=new n({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return yield so(s),s})}static _fromGetAccountInfoResponse(e,t,r){return D(this,null,function*(){let i=t.users[0];re(i.localId!==void 0,"internal-error");let s=i.providerUserInfo!==void 0?cg(i.providerUserInfo):[],a=!(i.email&&i.passwordHash)&&!s?.length,u=new fi;u.updateFromIdToken(r);let c=new n({uid:i.localId,auth:e,stsTokenManager:u,isAnonymous:a}),d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new pi(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!s?.length};return Object.assign(c,d),c})}};var Yp=new Map;function fn(n){ro(n instanceof Function,"Expected a class definition");let e=Yp.get(n);return e?(ro(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,Yp.set(n,e),e)}var cE=(()=>{class n{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return D(this,null,function*(){return!0})}_set(t,r){return D(this,null,function*(){this.storage[t]=r})}_get(t){return D(this,null,function*(){let r=this.storage[t];return r===void 0?null:r})}_remove(t){return D(this,null,function*(){delete this.storage[t]})}_addListener(t,r){}_removeListener(t,r){}}return n.type="NONE",n})(),cc=cE;function sc(n,e,t){return`firebase:${n}:${e}:${t}`}var oo=class n{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;let{config:i,name:s}=this.auth;this.fullUserKey=sc(this.userKey,i.apiKey,s),this.fullPersistenceKey=sc("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}getCurrentUser(){return D(this,null,function*(){let e=yield this.persistence._get(this.fullUserKey);return e?gi._fromJSON(this.auth,e):null})}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(e){return D(this,null,function*(){if(this.persistence===e)return;let t=yield this.getCurrentUser();if(yield this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)})}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(e,t,r="authUser"){return D(this,null,function*(){if(!t.length)return new n(fn(cc),e,r);let i=(yield Promise.all(t.map(d=>D(this,null,function*(){if(yield d._isAvailable())return d})))).filter(d=>d),s=i[0]||fn(cc),a=sc(r,e.config.apiKey,e.name),u=null;for(let d of t)try{let p=yield d._get(a);if(p){let m=gi._fromJSON(e,p);d!==s&&(u=m),s=d;break}}catch{}let c=i.filter(d=>d._shouldAllowMigration);return!s._shouldAllowMigration||!c.length?new n(s,e,r):(s=c[0],u&&(yield s._set(a,u.toJSON())),yield Promise.all(t.map(d=>D(this,null,function*(){if(d!==s)try{yield d._remove(a)}catch{}}))),new n(s,e,r))})}};function Jp(n){let e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(fE(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(lE(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(gE(e))return"Blackberry";if(mE(e))return"Webos";if(hE(e))return"Safari";if((e.includes("chrome/")||dE(e))&&!e.includes("edge/"))return"Chrome";if(pE(e))return"Android";{let t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if(r?.length===2)return r[1]}return"Other"}function lE(n=Ue()){return/firefox\//i.test(n)}function hE(n=Ue()){let e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function dE(n=Ue()){return/crios\//i.test(n)}function fE(n=Ue()){return/iemobile/i.test(n)}function pE(n=Ue()){return/android/i.test(n)}function gE(n=Ue()){return/blackberry/i.test(n)}function mE(n=Ue()){return/webos/i.test(n)}function lg(n,e=[]){let t;switch(n){case"Browser":t=Jp(Ue());break;case"Worker":t=`${Jp(Ue())}-${n}`;break;default:t=n}let r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Gn}/${r}`}var lc=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let r=s=>new Promise((a,u)=>{try{let c=e(s);a(c)}catch(c){u(c)}});r.onAbort=t,this.queue.push(r);let i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}runMiddleware(e){return D(this,null,function*(){if(this.auth.currentUser===e)return;let t=[];try{for(let r of this.queue)yield r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(let i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r?.message})}})}};function yE(t){return D(this,arguments,function*(n,e={}){return uo(n,"GET","/v2/passwordPolicy",ig(n,e))})}var vE=6,hc=class{constructor(e){var t,r,i,s;let a=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=a.minPasswordLength)!==null&&t!==void 0?t:vE,a.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=a.maxPasswordLength),a.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=a.containsLowercaseCharacter),a.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=a.containsUppercaseCharacter),a.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=a.containsNumericCharacter),a.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=a.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,a,u;let c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(t=c.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsLowercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(s=c.containsUppercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(a=c.containsNumericCharacter)!==null&&a!==void 0?a:!0),c.isValid&&(c.isValid=(u=c.containsNonAlphanumericCharacter)!==null&&u!==void 0?u:!0),c}validatePasswordLengthOptions(e,t){let r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}};var dc=class{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ao(this),this.idTokenSubscription=new ao(this),this.beforeStateQueue=new lc(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ng,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=fn(t)),this._initializationPromise=this.queue(()=>D(this,null,function*(){var r,i;if(!this._deleted&&(this.persistenceManager=yield oo.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{yield this._popupRedirectResolver._initialize(this)}catch{}yield this.initializeCurrentUser(t),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){return D(this,null,function*(){if(this._deleted)return;let e=yield this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),yield this.currentUser.getIdToken();return}yield this._updateCurrentUser(e,!0)}})}initializeCurrentUserFromIdToken(e){return D(this,null,function*(){try{let t=yield ag(this,{idToken:e}),r=yield gi._fromGetAccountInfoResponse(this,t,e);yield this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),yield this.directlySetCurrentUser(null)}})}initializeCurrentUser(e){return D(this,null,function*(){var t;if(qn(this.app)){let a=this.app.settings.authIdToken;return a?new Promise(u=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(a).then(u,u))}):this.directlySetCurrentUser(null)}let r=yield this.assertedPersistence.getCurrentUser(),i=r,s=!1;if(e&&this.config.authDomain){yield this.getOrInitRedirectPersistenceManager();let a=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,u=i?._redirectEventId,c=yield this.tryRedirectSignIn(e);(!a||a===u)&&c?.user&&(i=c.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{yield this.beforeStateQueue.runMiddleware(i)}catch(a){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(a))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return re(this._popupRedirectResolver,this,"argument-error"),yield this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)})}tryRedirectSignIn(e){return D(this,null,function*(){let t=null;try{t=yield this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{yield this._setRedirectUser(null)}return t})}reloadAndSetCurrentUserOrClear(e){return D(this,null,function*(){try{yield so(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)})}useDeviceLanguage(){this.languageCode=eE()}_delete(){return D(this,null,function*(){this._deleted=!0})}updateCurrentUser(e){return D(this,null,function*(){if(qn(this.app))return Promise.reject(to(this));let t=e?Te(e):null;return t&&re(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))})}_updateCurrentUser(e,t=!1){return D(this,null,function*(){if(!this._deleted)return e&&re(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||(yield this.beforeStateQueue.runMiddleware(e)),this.queue(()=>D(this,null,function*(){yield this.directlySetCurrentUser(e),this.notifyAuthListeners()}))})}signOut(){return D(this,null,function*(){return qn(this.app)?Promise.reject(to(this)):(yield this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&(yield this._setRedirectUser(null)),this._updateCurrentUser(null,!0))})}setPersistence(e){return qn(this.app)?Promise.reject(to(this)):this.queue(()=>D(this,null,function*(){yield this.assertedPersistence.setPersistence(fn(e))}))}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(e){return D(this,null,function*(){this._getPasswordPolicyInternal()||(yield this._updatePasswordPolicy());let t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)})}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){return D(this,null,function*(){let e=yield yE(this),t=new hc(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Tt("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{let r=this.onAuthStateChanged(()=>{r(),e()},t)}})}revokeAccessToken(e){return D(this,null,function*(){if(this.currentUser){let t=yield this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),yield uE(this,r)}})}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}_setRedirectUser(e,t){return D(this,null,function*(){let r=yield this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)})}getOrInitRedirectPersistenceManager(e){return D(this,null,function*(){if(!this.redirectPersistenceManager){let t=e&&fn(e)||this._popupRedirectResolver;re(t,this,"argument-error"),this.redirectPersistenceManager=yield oo.create(this,[fn(t._redirectPersistence)],"redirectUser"),this.redirectUser=yield this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager})}_redirectUserForId(e){return D(this,null,function*(){var t,r;return this._isInitialized&&(yield this.queue(()=>D(this,null,function*(){}))),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null})}_persistUserIfCurrent(e){return D(this,null,function*(){if(e===this.currentUser)return this.queue(()=>D(this,null,function*(){return this.directlySetCurrentUser(e)}))})}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};let s=typeof t=="function"?t:t.next.bind(t),a=!1,u=this._isInitialized?Promise.resolve():this._initializationPromise;if(re(u,this,"internal-error"),u.then(()=>{a||s(this.currentUser)}),typeof t=="function"){let c=e.addObserver(t,r,i);return()=>{a=!0,c()}}else{let c=e.addObserver(t);return()=>{a=!0,c()}}}directlySetCurrentUser(e){return D(this,null,function*(){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?yield this.assertedPersistence.setCurrentUser(e):yield this.assertedPersistence.removeCurrentUser()})}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return re(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=lg(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){return D(this,null,function*(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let r=yield(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader();r&&(t["X-Firebase-Client"]=r);let i=yield this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t})}_getAppCheckToken(){return D(this,null,function*(){var e;let t=yield(e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken();return t?.error&&Jw(`Error while retrieving App Check token: ${t.error}`),t?.token})}};function _E(n){return Te(n)}var ao=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=Op(t=>this.observer=t)}get next(){return re(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};var wE={loadJS(){return D(this,null,function*(){throw new Error("Unable to load external scripts")})},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function EE(n){wE=n}function IE(n){return`__${n}${Math.floor(Math.random()*1e6)}`}function TE(n,e){let t=e?.persistence||[],r=(Array.isArray(t)?t:[t]).map(fn);e?.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e?.popupRedirectResolver)}var Gb=IE("rcb"),Wb=new pn(3e4,6e4);var Hb=new pn(2e3,1e4);var Kb=10*60*1e3;var Qb=new pn(3e4,6e4);var Yb=new pn(5e3,15e3);var Jb=encodeURIComponent("fac");var Xp="@firebase/auth",Zp="1.7.9";var fc=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}getToken(e){return D(this,null,function*(){return this.assertAuthConfigured(),yield this.auth._initializationPromise,this.auth.currentUser?{accessToken:yield this.auth.currentUser.getIdToken(e)}:null})}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(r=>{e(r?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){re(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};function AE(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function DE(n){qt(new Qe("auth",(e,{options:t})=>{let r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:u}=r.options;re(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});let c={apiKey:a,authDomain:u,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:lg(n)},d=new dc(r,i,s,c);return TE(d,t),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),qt(new Qe("auth-internal",e=>{let t=_E(e.getProvider("auth").getImmediate());return(r=>new fc(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),we(Xp,Zp,AE(n)),we(Xp,Zp,"esm2017")}var SE=5*60,Xb=Ap("authIdTokenMaxAge")||SE;function bE(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}EE({loadJS(n){return new Promise((e,t)=>{let r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{let s=pc("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",bE().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});DE("Browser");var SI="auth";var co=class{constructor(){return ui(SI)}};var hg=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dg={};var Wt,vc;(function(){var n;function e(E,g){function v(){}v.prototype=g.prototype,E.D=g.prototype,E.prototype=new v,E.prototype.constructor=E,E.C=function(_,I,A){for(var y=Array(arguments.length-2),mt=2;mt<arguments.length;mt++)y[mt-2]=arguments[mt];return g.prototype[I].apply(_,y)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(E,g,v){v||(v=0);var _=Array(16);if(typeof g=="string")for(var I=0;16>I;++I)_[I]=g.charCodeAt(v++)|g.charCodeAt(v++)<<8|g.charCodeAt(v++)<<16|g.charCodeAt(v++)<<24;else for(I=0;16>I;++I)_[I]=g[v++]|g[v++]<<8|g[v++]<<16|g[v++]<<24;g=E.g[0],v=E.g[1],I=E.g[2];var A=E.g[3],y=g+(A^v&(I^A))+_[0]+3614090360&4294967295;g=v+(y<<7&4294967295|y>>>25),y=A+(I^g&(v^I))+_[1]+3905402710&4294967295,A=g+(y<<12&4294967295|y>>>20),y=I+(v^A&(g^v))+_[2]+606105819&4294967295,I=A+(y<<17&4294967295|y>>>15),y=v+(g^I&(A^g))+_[3]+3250441966&4294967295,v=I+(y<<22&4294967295|y>>>10),y=g+(A^v&(I^A))+_[4]+4118548399&4294967295,g=v+(y<<7&4294967295|y>>>25),y=A+(I^g&(v^I))+_[5]+1200080426&4294967295,A=g+(y<<12&4294967295|y>>>20),y=I+(v^A&(g^v))+_[6]+2821735955&4294967295,I=A+(y<<17&4294967295|y>>>15),y=v+(g^I&(A^g))+_[7]+4249261313&4294967295,v=I+(y<<22&4294967295|y>>>10),y=g+(A^v&(I^A))+_[8]+1770035416&4294967295,g=v+(y<<7&4294967295|y>>>25),y=A+(I^g&(v^I))+_[9]+2336552879&4294967295,A=g+(y<<12&4294967295|y>>>20),y=I+(v^A&(g^v))+_[10]+4294925233&4294967295,I=A+(y<<17&4294967295|y>>>15),y=v+(g^I&(A^g))+_[11]+2304563134&4294967295,v=I+(y<<22&4294967295|y>>>10),y=g+(A^v&(I^A))+_[12]+1804603682&4294967295,g=v+(y<<7&4294967295|y>>>25),y=A+(I^g&(v^I))+_[13]+4254626195&4294967295,A=g+(y<<12&4294967295|y>>>20),y=I+(v^A&(g^v))+_[14]+2792965006&4294967295,I=A+(y<<17&4294967295|y>>>15),y=v+(g^I&(A^g))+_[15]+1236535329&4294967295,v=I+(y<<22&4294967295|y>>>10),y=g+(I^A&(v^I))+_[1]+4129170786&4294967295,g=v+(y<<5&4294967295|y>>>27),y=A+(v^I&(g^v))+_[6]+3225465664&4294967295,A=g+(y<<9&4294967295|y>>>23),y=I+(g^v&(A^g))+_[11]+643717713&4294967295,I=A+(y<<14&4294967295|y>>>18),y=v+(A^g&(I^A))+_[0]+3921069994&4294967295,v=I+(y<<20&4294967295|y>>>12),y=g+(I^A&(v^I))+_[5]+3593408605&4294967295,g=v+(y<<5&4294967295|y>>>27),y=A+(v^I&(g^v))+_[10]+38016083&4294967295,A=g+(y<<9&4294967295|y>>>23),y=I+(g^v&(A^g))+_[15]+3634488961&4294967295,I=A+(y<<14&4294967295|y>>>18),y=v+(A^g&(I^A))+_[4]+3889429448&4294967295,v=I+(y<<20&4294967295|y>>>12),y=g+(I^A&(v^I))+_[9]+568446438&4294967295,g=v+(y<<5&4294967295|y>>>27),y=A+(v^I&(g^v))+_[14]+3275163606&4294967295,A=g+(y<<9&4294967295|y>>>23),y=I+(g^v&(A^g))+_[3]+4107603335&4294967295,I=A+(y<<14&4294967295|y>>>18),y=v+(A^g&(I^A))+_[8]+1163531501&4294967295,v=I+(y<<20&4294967295|y>>>12),y=g+(I^A&(v^I))+_[13]+2850285829&4294967295,g=v+(y<<5&4294967295|y>>>27),y=A+(v^I&(g^v))+_[2]+4243563512&4294967295,A=g+(y<<9&4294967295|y>>>23),y=I+(g^v&(A^g))+_[7]+1735328473&4294967295,I=A+(y<<14&4294967295|y>>>18),y=v+(A^g&(I^A))+_[12]+2368359562&4294967295,v=I+(y<<20&4294967295|y>>>12),y=g+(v^I^A)+_[5]+4294588738&4294967295,g=v+(y<<4&4294967295|y>>>28),y=A+(g^v^I)+_[8]+2272392833&4294967295,A=g+(y<<11&4294967295|y>>>21),y=I+(A^g^v)+_[11]+1839030562&4294967295,I=A+(y<<16&4294967295|y>>>16),y=v+(I^A^g)+_[14]+4259657740&4294967295,v=I+(y<<23&4294967295|y>>>9),y=g+(v^I^A)+_[1]+2763975236&4294967295,g=v+(y<<4&4294967295|y>>>28),y=A+(g^v^I)+_[4]+1272893353&4294967295,A=g+(y<<11&4294967295|y>>>21),y=I+(A^g^v)+_[7]+4139469664&4294967295,I=A+(y<<16&4294967295|y>>>16),y=v+(I^A^g)+_[10]+3200236656&4294967295,v=I+(y<<23&4294967295|y>>>9),y=g+(v^I^A)+_[13]+681279174&4294967295,g=v+(y<<4&4294967295|y>>>28),y=A+(g^v^I)+_[0]+3936430074&4294967295,A=g+(y<<11&4294967295|y>>>21),y=I+(A^g^v)+_[3]+3572445317&4294967295,I=A+(y<<16&4294967295|y>>>16),y=v+(I^A^g)+_[6]+76029189&4294967295,v=I+(y<<23&4294967295|y>>>9),y=g+(v^I^A)+_[9]+3654602809&4294967295,g=v+(y<<4&4294967295|y>>>28),y=A+(g^v^I)+_[12]+3873151461&4294967295,A=g+(y<<11&4294967295|y>>>21),y=I+(A^g^v)+_[15]+530742520&4294967295,I=A+(y<<16&4294967295|y>>>16),y=v+(I^A^g)+_[2]+3299628645&4294967295,v=I+(y<<23&4294967295|y>>>9),y=g+(I^(v|~A))+_[0]+4096336452&4294967295,g=v+(y<<6&4294967295|y>>>26),y=A+(v^(g|~I))+_[7]+1126891415&4294967295,A=g+(y<<10&4294967295|y>>>22),y=I+(g^(A|~v))+_[14]+2878612391&4294967295,I=A+(y<<15&4294967295|y>>>17),y=v+(A^(I|~g))+_[5]+4237533241&4294967295,v=I+(y<<21&4294967295|y>>>11),y=g+(I^(v|~A))+_[12]+1700485571&4294967295,g=v+(y<<6&4294967295|y>>>26),y=A+(v^(g|~I))+_[3]+2399980690&4294967295,A=g+(y<<10&4294967295|y>>>22),y=I+(g^(A|~v))+_[10]+4293915773&4294967295,I=A+(y<<15&4294967295|y>>>17),y=v+(A^(I|~g))+_[1]+2240044497&4294967295,v=I+(y<<21&4294967295|y>>>11),y=g+(I^(v|~A))+_[8]+1873313359&4294967295,g=v+(y<<6&4294967295|y>>>26),y=A+(v^(g|~I))+_[15]+4264355552&4294967295,A=g+(y<<10&4294967295|y>>>22),y=I+(g^(A|~v))+_[6]+2734768916&4294967295,I=A+(y<<15&4294967295|y>>>17),y=v+(A^(I|~g))+_[13]+1309151649&4294967295,v=I+(y<<21&4294967295|y>>>11),y=g+(I^(v|~A))+_[4]+4149444226&4294967295,g=v+(y<<6&4294967295|y>>>26),y=A+(v^(g|~I))+_[11]+3174756917&4294967295,A=g+(y<<10&4294967295|y>>>22),y=I+(g^(A|~v))+_[2]+718787259&4294967295,I=A+(y<<15&4294967295|y>>>17),y=v+(A^(I|~g))+_[9]+3951481745&4294967295,E.g[0]=E.g[0]+g&4294967295,E.g[1]=E.g[1]+(I+(y<<21&4294967295|y>>>11))&4294967295,E.g[2]=E.g[2]+I&4294967295,E.g[3]=E.g[3]+A&4294967295}r.prototype.u=function(E,g){g===void 0&&(g=E.length);for(var v=g-this.blockSize,_=this.B,I=this.h,A=0;A<g;){if(I==0)for(;A<=v;)i(this,E,A),A+=this.blockSize;if(typeof E=="string"){for(;A<g;)if(_[I++]=E.charCodeAt(A++),I==this.blockSize){i(this,_),I=0;break}}else for(;A<g;)if(_[I++]=E[A++],I==this.blockSize){i(this,_),I=0;break}}this.h=I,this.o+=g},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var g=1;g<E.length-8;++g)E[g]=0;var v=8*this.o;for(g=E.length-8;g<E.length;++g)E[g]=v&255,v/=256;for(this.u(E),E=Array(16),g=v=0;4>g;++g)for(var _=0;32>_;_+=8)E[v++]=this.g[g]>>>_&255;return E};function s(E,g){var v=u;return Object.prototype.hasOwnProperty.call(v,E)?v[E]:v[E]=g(E)}function a(E,g){this.h=g;for(var v=[],_=!0,I=E.length-1;0<=I;I--){var A=E[I]|0;_&&A==g||(v[I]=A,_=!1)}this.g=v}var u={};function c(E){return-128<=E&&128>E?s(E,function(g){return new a([g|0],0>g?-1:0)}):new a([E|0],0>E?-1:0)}function d(E){if(isNaN(E)||!isFinite(E))return m;if(0>E)return C(d(-E));for(var g=[],v=1,_=0;E>=v;_++)g[_]=E/v|0,v*=4294967296;return new a(g,0)}function p(E,g){if(E.length==0)throw Error("number format error: empty string");if(g=g||10,2>g||36<g)throw Error("radix out of range: "+g);if(E.charAt(0)=="-")return C(p(E.substring(1),g));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var v=d(Math.pow(g,8)),_=m,I=0;I<E.length;I+=8){var A=Math.min(8,E.length-I),y=parseInt(E.substring(I,I+A),g);8>A?(A=d(Math.pow(g,A)),_=_.j(A).add(d(y))):(_=_.j(v),_=_.add(d(y)))}return _}var m=c(0),w=c(1),S=c(16777216);n=a.prototype,n.m=function(){if(N(this))return-C(this).m();for(var E=0,g=1,v=0;v<this.g.length;v++){var _=this.i(v);E+=(0<=_?_:4294967296+_)*g,g*=4294967296}return E},n.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(P(this))return"0";if(N(this))return"-"+C(this).toString(E);for(var g=d(Math.pow(E,6)),v=this,_="";;){var I=ne(v,g).g;v=U(v,I.j(g));var A=((0<v.g.length?v.g[0]:v.h)>>>0).toString(E);if(v=I,P(v))return A+_;for(;6>A.length;)A="0"+A;_=A+_}},n.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function P(E){if(E.h!=0)return!1;for(var g=0;g<E.g.length;g++)if(E.g[g]!=0)return!1;return!0}function N(E){return E.h==-1}n.l=function(E){return E=U(this,E),N(E)?-1:P(E)?0:1};function C(E){for(var g=E.g.length,v=[],_=0;_<g;_++)v[_]=~E.g[_];return new a(v,~E.h).add(w)}n.abs=function(){return N(this)?C(this):this},n.add=function(E){for(var g=Math.max(this.g.length,E.g.length),v=[],_=0,I=0;I<=g;I++){var A=_+(this.i(I)&65535)+(E.i(I)&65535),y=(A>>>16)+(this.i(I)>>>16)+(E.i(I)>>>16);_=y>>>16,A&=65535,y&=65535,v[I]=y<<16|A}return new a(v,v[v.length-1]&-2147483648?-1:0)};function U(E,g){return E.add(C(g))}n.j=function(E){if(P(this)||P(E))return m;if(N(this))return N(E)?C(this).j(C(E)):C(C(this).j(E));if(N(E))return C(this.j(C(E)));if(0>this.l(S)&&0>E.l(S))return d(this.m()*E.m());for(var g=this.g.length+E.g.length,v=[],_=0;_<2*g;_++)v[_]=0;for(_=0;_<this.g.length;_++)for(var I=0;I<E.g.length;I++){var A=this.i(_)>>>16,y=this.i(_)&65535,mt=E.i(I)>>>16,Sr=E.i(I)&65535;v[2*_+2*I]+=y*Sr,j(v,2*_+2*I),v[2*_+2*I+1]+=A*Sr,j(v,2*_+2*I+1),v[2*_+2*I+1]+=y*mt,j(v,2*_+2*I+1),v[2*_+2*I+2]+=A*mt,j(v,2*_+2*I+2)}for(_=0;_<g;_++)v[_]=v[2*_+1]<<16|v[2*_];for(_=g;_<2*g;_++)v[_]=0;return new a(v,0)};function j(E,g){for(;(E[g]&65535)!=E[g];)E[g+1]+=E[g]>>>16,E[g]&=65535,g++}function L(E,g){this.g=E,this.h=g}function ne(E,g){if(P(g))throw Error("division by zero");if(P(E))return new L(m,m);if(N(E))return g=ne(C(E),g),new L(C(g.g),C(g.h));if(N(g))return g=ne(E,C(g)),new L(C(g.g),g.h);if(30<E.g.length){if(N(E)||N(g))throw Error("slowDivide_ only works with positive integers.");for(var v=w,_=g;0>=_.l(E);)v=le(v),_=le(_);var I=X(v,1),A=X(_,1);for(_=X(_,2),v=X(v,2);!P(_);){var y=A.add(_);0>=y.l(E)&&(I=I.add(v),A=y),_=X(_,1),v=X(v,1)}return g=U(E,I.j(g)),new L(I,g)}for(I=m;0<=E.l(g);){for(v=Math.max(1,Math.floor(E.m()/g.m())),_=Math.ceil(Math.log(v)/Math.LN2),_=48>=_?1:Math.pow(2,_-48),A=d(v),y=A.j(g);N(y)||0<y.l(E);)v-=_,A=d(v),y=A.j(g);P(A)&&(A=w),I=I.add(A),E=U(E,y)}return new L(I,E)}n.A=function(E){return ne(this,E).h},n.and=function(E){for(var g=Math.max(this.g.length,E.g.length),v=[],_=0;_<g;_++)v[_]=this.i(_)&E.i(_);return new a(v,this.h&E.h)},n.or=function(E){for(var g=Math.max(this.g.length,E.g.length),v=[],_=0;_<g;_++)v[_]=this.i(_)|E.i(_);return new a(v,this.h|E.h)},n.xor=function(E){for(var g=Math.max(this.g.length,E.g.length),v=[],_=0;_<g;_++)v[_]=this.i(_)^E.i(_);return new a(v,this.h^E.h)};function le(E){for(var g=E.g.length+1,v=[],_=0;_<g;_++)v[_]=E.i(_)<<1|E.i(_-1)>>>31;return new a(v,E.h)}function X(E,g){var v=g>>5;g%=32;for(var _=E.g.length-v,I=[],A=0;A<_;A++)I[A]=0<g?E.i(A+v)>>>g|E.i(A+v+1)<<32-g:E.i(A+v);return new a(I,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,vc=dg.Md5=r,a.prototype.add=a.prototype.add,a.prototype.multiply=a.prototype.j,a.prototype.modulo=a.prototype.A,a.prototype.compare=a.prototype.l,a.prototype.toNumber=a.prototype.m,a.prototype.toString=a.prototype.toString,a.prototype.getBits=a.prototype.i,a.fromNumber=d,a.fromString=p,Wt=dg.Integer=a}).apply(typeof hg<"u"?hg:typeof self<"u"?self:typeof window<"u"?window:{});var lo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Dt={};var _c,bI,Kn,wc,mi,ho,Ec,Ic,Tc;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(o,l,h){return o==Array.prototype||o==Object.prototype||(o[l]=h.value),o};function t(o){o=[typeof globalThis=="object"&&globalThis,o,typeof window=="object"&&window,typeof self=="object"&&self,typeof lo=="object"&&lo];for(var l=0;l<o.length;++l){var h=o[l];if(h&&h.Math==Math)return h}throw Error("Cannot find global object")}var r=t(this);function i(o,l){if(l)e:{var h=r;o=o.split(".");for(var f=0;f<o.length-1;f++){var T=o[f];if(!(T in h))break e;h=h[T]}o=o[o.length-1],f=h[o],l=l(f),l!=f&&l!=null&&e(h,o,{configurable:!0,writable:!0,value:l})}}function s(o,l){o instanceof String&&(o+="");var h=0,f=!1,T={next:function(){if(!f&&h<o.length){var b=h++;return{value:l(b,o[b]),done:!1}}return f=!0,{done:!0,value:void 0}}};return T[Symbol.iterator]=function(){return T},T}i("Array.prototype.values",function(o){return o||function(){return s(this,function(l,h){return h})}});var a=a||{},u=this||self;function c(o){var l=typeof o;return l=l!="object"?l:o?Array.isArray(o)?"array":l:"null",l=="array"||l=="object"&&typeof o.length=="number"}function d(o){var l=typeof o;return l=="object"&&o!=null||l=="function"}function p(o,l,h){return o.call.apply(o.bind,arguments)}function m(o,l,h){if(!o)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var T=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(T,f),o.apply(l,T)}}return function(){return o.apply(l,arguments)}}function w(o,l,h){return w=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?p:m,w.apply(null,arguments)}function S(o,l){var h=Array.prototype.slice.call(arguments,1);return function(){var f=h.slice();return f.push.apply(f,arguments),o.apply(this,f)}}function P(o,l){function h(){}h.prototype=l.prototype,o.aa=l.prototype,o.prototype=new h,o.prototype.constructor=o,o.Qb=function(f,T,b){for(var k=Array(arguments.length-2),oe=2;oe<arguments.length;oe++)k[oe-2]=arguments[oe];return l.prototype[T].apply(f,k)}}function N(o){let l=o.length;if(0<l){let h=Array(l);for(let f=0;f<l;f++)h[f]=o[f];return h}return[]}function C(o,l){for(let h=1;h<arguments.length;h++){let f=arguments[h];if(c(f)){let T=o.length||0,b=f.length||0;o.length=T+b;for(let k=0;k<b;k++)o[T+k]=f[k]}else o.push(f)}}class U{constructor(l,h){this.i=l,this.j=h,this.h=0,this.g=null}get(){let l;return 0<this.h?(this.h--,l=this.g,this.g=l.next,l.next=null):l=this.i(),l}}function j(o){return/^[\s\xa0]*$/.test(o)}function L(){var o=u.navigator;return o&&(o=o.userAgent)?o:""}function ne(o){return ne[" "](o),o}ne[" "]=function(){};var le=L().indexOf("Gecko")!=-1&&!(L().toLowerCase().indexOf("webkit")!=-1&&L().indexOf("Edge")==-1)&&!(L().indexOf("Trident")!=-1||L().indexOf("MSIE")!=-1)&&L().indexOf("Edge")==-1;function X(o,l,h){for(let f in o)l.call(h,o[f],f,o)}function E(o,l){for(let h in o)l.call(void 0,o[h],h,o)}function g(o){let l={};for(let h in o)l[h]=o[h];return l}let v="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _(o,l){let h,f;for(let T=1;T<arguments.length;T++){f=arguments[T];for(h in f)o[h]=f[h];for(let b=0;b<v.length;b++)h=v[b],Object.prototype.hasOwnProperty.call(f,h)&&(o[h]=f[h])}}function I(o){var l=1;o=o.split(":");let h=[];for(;0<l&&o.length;)h.push(o.shift()),l--;return o.length&&h.push(o.join(":")),h}function A(o){u.setTimeout(()=>{throw o},0)}function y(){var o=wa;let l=null;return o.g&&(l=o.g,o.g=o.g.next,o.g||(o.h=null),l.next=null),l}class mt{constructor(){this.h=this.g=null}add(l,h){let f=Sr.get();f.set(l,h),this.h?this.h.next=f:this.g=f,this.h=f}}var Sr=new U(()=>new Gy,o=>o.reset());class Gy{constructor(){this.next=this.g=this.h=null}set(l,h){this.h=l,this.g=h,this.next=null}reset(){this.next=this.g=this.h=null}}let br,Cr=!1,wa=new mt,Td=()=>{let o=u.Promise.resolve(void 0);br=()=>{o.then(Wy)}};var Wy=()=>{for(var o;o=y();){try{o.h.call(o.g)}catch(h){A(h)}var l=Sr;l.j(o),100>l.h&&(l.h++,o.next=l.g,l.g=o)}Cr=!1};function kt(){this.s=this.s,this.C=this.C}kt.prototype.s=!1,kt.prototype.ma=function(){this.s||(this.s=!0,this.N())},kt.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Se(o,l){this.type=o,this.g=this.target=l,this.defaultPrevented=!1}Se.prototype.h=function(){this.defaultPrevented=!0};var Hy=function(){if(!u.addEventListener||!Object.defineProperty)return!1;var o=!1,l=Object.defineProperty({},"passive",{get:function(){o=!0}});try{let h=()=>{};u.addEventListener("test",h,l),u.removeEventListener("test",h,l)}catch{}return o}();function Rr(o,l){if(Se.call(this,o?o.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,o){var h=this.type=o.type,f=o.changedTouches&&o.changedTouches.length?o.changedTouches[0]:null;if(this.target=o.target||o.srcElement,this.g=l,l=o.relatedTarget){if(le){e:{try{ne(l.nodeName);var T=!0;break e}catch{}T=!1}T||(l=null)}}else h=="mouseover"?l=o.fromElement:h=="mouseout"&&(l=o.toElement);this.relatedTarget=l,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=o.clientX!==void 0?o.clientX:o.pageX,this.clientY=o.clientY!==void 0?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=o.button,this.key=o.key||"",this.ctrlKey=o.ctrlKey,this.altKey=o.altKey,this.shiftKey=o.shiftKey,this.metaKey=o.metaKey,this.pointerId=o.pointerId||0,this.pointerType=typeof o.pointerType=="string"?o.pointerType:Ky[o.pointerType]||"",this.state=o.state,this.i=o,o.defaultPrevented&&Rr.aa.h.call(this)}}P(Rr,Se);var Ky={2:"touch",3:"pen",4:"mouse"};Rr.prototype.h=function(){Rr.aa.h.call(this);var o=this.i;o.preventDefault?o.preventDefault():o.returnValue=!1};var Pr="closure_listenable_"+(1e6*Math.random()|0),Qy=0;function Yy(o,l,h,f,T){this.listener=o,this.proxy=null,this.src=l,this.type=h,this.capture=!!f,this.ha=T,this.key=++Qy,this.da=this.fa=!1}function as(o){o.da=!0,o.listener=null,o.proxy=null,o.src=null,o.ha=null}function us(o){this.src=o,this.g={},this.h=0}us.prototype.add=function(o,l,h,f,T){var b=o.toString();o=this.g[b],o||(o=this.g[b]=[],this.h++);var k=Ia(o,l,f,T);return-1<k?(l=o[k],h||(l.fa=!1)):(l=new Yy(l,this.src,b,!!f,T),l.fa=h,o.push(l)),l};function Ea(o,l){var h=l.type;if(h in o.g){var f=o.g[h],T=Array.prototype.indexOf.call(f,l,void 0),b;(b=0<=T)&&Array.prototype.splice.call(f,T,1),b&&(as(l),o.g[h].length==0&&(delete o.g[h],o.h--))}}function Ia(o,l,h,f){for(var T=0;T<o.length;++T){var b=o[T];if(!b.da&&b.listener==l&&b.capture==!!h&&b.ha==f)return T}return-1}var Ta="closure_lm_"+(1e6*Math.random()|0),Aa={};function Ad(o,l,h,f,T){if(f&&f.once)return Sd(o,l,h,f,T);if(Array.isArray(l)){for(var b=0;b<l.length;b++)Ad(o,l[b],h,f,T);return null}return h=Ca(h),o&&o[Pr]?o.K(l,h,d(f)?!!f.capture:!!f,T):Dd(o,l,h,!1,f,T)}function Dd(o,l,h,f,T,b){if(!l)throw Error("Invalid event type");var k=d(T)?!!T.capture:!!T,oe=Sa(o);if(oe||(o[Ta]=oe=new us(o)),h=oe.add(l,h,f,k,b),h.proxy)return h;if(f=Jy(),h.proxy=f,f.src=o,f.listener=h,o.addEventListener)Hy||(T=k),T===void 0&&(T=!1),o.addEventListener(l.toString(),f,T);else if(o.attachEvent)o.attachEvent(Cd(l.toString()),f);else if(o.addListener&&o.removeListener)o.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.");return h}function Jy(){function o(h){return l.call(o.src,o.listener,h)}let l=Xy;return o}function Sd(o,l,h,f,T){if(Array.isArray(l)){for(var b=0;b<l.length;b++)Sd(o,l[b],h,f,T);return null}return h=Ca(h),o&&o[Pr]?o.L(l,h,d(f)?!!f.capture:!!f,T):Dd(o,l,h,!0,f,T)}function bd(o,l,h,f,T){if(Array.isArray(l))for(var b=0;b<l.length;b++)bd(o,l[b],h,f,T);else f=d(f)?!!f.capture:!!f,h=Ca(h),o&&o[Pr]?(o=o.i,l=String(l).toString(),l in o.g&&(b=o.g[l],h=Ia(b,h,f,T),-1<h&&(as(b[h]),Array.prototype.splice.call(b,h,1),b.length==0&&(delete o.g[l],o.h--)))):o&&(o=Sa(o))&&(l=o.g[l.toString()],o=-1,l&&(o=Ia(l,h,f,T)),(h=-1<o?l[o]:null)&&Da(h))}function Da(o){if(typeof o!="number"&&o&&!o.da){var l=o.src;if(l&&l[Pr])Ea(l.i,o);else{var h=o.type,f=o.proxy;l.removeEventListener?l.removeEventListener(h,f,o.capture):l.detachEvent?l.detachEvent(Cd(h),f):l.addListener&&l.removeListener&&l.removeListener(f),(h=Sa(l))?(Ea(h,o),h.h==0&&(h.src=null,l[Ta]=null)):as(o)}}}function Cd(o){return o in Aa?Aa[o]:Aa[o]="on"+o}function Xy(o,l){if(o.da)o=!0;else{l=new Rr(l,this);var h=o.listener,f=o.ha||o.src;o.fa&&Da(o),o=h.call(f,l)}return o}function Sa(o){return o=o[Ta],o instanceof us?o:null}var ba="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ca(o){return typeof o=="function"?o:(o[ba]||(o[ba]=function(l){return o.handleEvent(l)}),o[ba])}function be(){kt.call(this),this.i=new us(this),this.M=this,this.F=null}P(be,kt),be.prototype[Pr]=!0,be.prototype.removeEventListener=function(o,l,h,f){bd(this,o,l,h,f)};function ke(o,l){var h,f=o.F;if(f)for(h=[];f;f=f.F)h.push(f);if(o=o.M,f=l.type||l,typeof l=="string")l=new Se(l,o);else if(l instanceof Se)l.target=l.target||o;else{var T=l;l=new Se(f,o),_(l,T)}if(T=!0,h)for(var b=h.length-1;0<=b;b--){var k=l.g=h[b];T=cs(k,f,!0,l)&&T}if(k=l.g=o,T=cs(k,f,!0,l)&&T,T=cs(k,f,!1,l)&&T,h)for(b=0;b<h.length;b++)k=l.g=h[b],T=cs(k,f,!1,l)&&T}be.prototype.N=function(){if(be.aa.N.call(this),this.i){var o=this.i,l;for(l in o.g){for(var h=o.g[l],f=0;f<h.length;f++)as(h[f]);delete o.g[l],o.h--}}this.F=null},be.prototype.K=function(o,l,h,f){return this.i.add(String(o),l,!1,h,f)},be.prototype.L=function(o,l,h,f){return this.i.add(String(o),l,!0,h,f)};function cs(o,l,h,f){if(l=o.i.g[String(l)],!l)return!0;l=l.concat();for(var T=!0,b=0;b<l.length;++b){var k=l[b];if(k&&!k.da&&k.capture==h){var oe=k.listener,Ie=k.ha||k.src;k.fa&&Ea(o.i,k),T=oe.call(Ie,f)!==!1&&T}}return T&&!f.defaultPrevented}function Rd(o,l,h){if(typeof o=="function")h&&(o=w(o,h));else if(o&&typeof o.handleEvent=="function")o=w(o.handleEvent,o);else throw Error("Invalid listener argument");return 2147483647<Number(l)?-1:u.setTimeout(o,l||0)}function Pd(o){o.g=Rd(()=>{o.g=null,o.i&&(o.i=!1,Pd(o))},o.l);let l=o.h;o.h=null,o.m.apply(null,l)}class Zy extends kt{constructor(l,h){super(),this.m=l,this.l=h,this.h=null,this.i=!1,this.g=null}j(l){this.h=arguments,this.g?this.i=!0:Pd(this)}N(){super.N(),this.g&&(u.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Nr(o){kt.call(this),this.h=o,this.g={}}P(Nr,kt);var Nd=[];function Od(o){X(o.g,function(l,h){this.g.hasOwnProperty(h)&&Da(l)},o),o.g={}}Nr.prototype.N=function(){Nr.aa.N.call(this),Od(this)},Nr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ra=u.JSON.stringify,ev=u.JSON.parse,tv=class{stringify(o){return u.JSON.stringify(o,void 0)}parse(o){return u.JSON.parse(o,void 0)}};function Pa(){}Pa.prototype.h=null;function kd(o){return o.h||(o.h=o.i())}function Md(){}var Or={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Na(){Se.call(this,"d")}P(Na,Se);function Oa(){Se.call(this,"c")}P(Oa,Se);var Zt={},xd=null;function ls(){return xd=xd||new be}Zt.La="serverreachability";function Fd(o){Se.call(this,Zt.La,o)}P(Fd,Se);function kr(o){let l=ls();ke(l,new Fd(l))}Zt.STAT_EVENT="statevent";function Ld(o,l){Se.call(this,Zt.STAT_EVENT,o),this.stat=l}P(Ld,Se);function Me(o){let l=ls();ke(l,new Ld(l,o))}Zt.Ma="timingevent";function Vd(o,l){Se.call(this,Zt.Ma,o),this.size=l}P(Vd,Se);function Mr(o,l){if(typeof o!="function")throw Error("Fn must not be null and must be a function");return u.setTimeout(function(){o()},l)}function xr(){this.g=!0}xr.prototype.xa=function(){this.g=!1};function nv(o,l,h,f,T,b){o.info(function(){if(o.g)if(b)for(var k="",oe=b.split("&"),Ie=0;Ie<oe.length;Ie++){var ee=oe[Ie].split("=");if(1<ee.length){var Ce=ee[0];ee=ee[1];var Re=Ce.split("_");k=2<=Re.length&&Re[1]=="type"?k+(Ce+"="+ee+"&"):k+(Ce+"=redacted&")}}else k=null;else k=b;return"XMLHTTP REQ ("+f+") [attempt "+T+"]: "+l+`
`+h+`
`+k})}function rv(o,l,h,f,T,b,k){o.info(function(){return"XMLHTTP RESP ("+f+") [ attempt "+T+"]: "+l+`
`+h+`
`+b+" "+k})}function kn(o,l,h,f){o.info(function(){return"XMLHTTP TEXT ("+l+"): "+sv(o,h)+(f?" "+f:"")})}function iv(o,l){o.info(function(){return"TIMEOUT: "+l})}xr.prototype.info=function(){};function sv(o,l){if(!o.g)return l;if(!l)return null;try{var h=JSON.parse(l);if(h){for(o=0;o<h.length;o++)if(Array.isArray(h[o])){var f=h[o];if(!(2>f.length)){var T=f[1];if(Array.isArray(T)&&!(1>T.length)){var b=T[0];if(b!="noop"&&b!="stop"&&b!="close")for(var k=1;k<T.length;k++)T[k]=""}}}}return Ra(h)}catch{return l}}var hs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ud={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ka;function ds(){}P(ds,Pa),ds.prototype.g=function(){return new XMLHttpRequest},ds.prototype.i=function(){return{}},ka=new ds;function Mt(o,l,h,f){this.j=o,this.i=l,this.l=h,this.R=f||1,this.U=new Nr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Bd}function Bd(){this.i=null,this.g="",this.h=!1}var $d={},Ma={};function xa(o,l,h){o.L=1,o.v=ms(yt(l)),o.m=h,o.P=!0,jd(o,null)}function jd(o,l){o.F=Date.now(),fs(o),o.A=yt(o.v);var h=o.A,f=o.R;Array.isArray(f)||(f=[String(f)]),nf(h.i,"t",f),o.C=0,h=o.j.J,o.h=new Bd,o.g=Ef(o.j,h?l:null,!o.m),0<o.O&&(o.M=new Zy(w(o.Y,o,o.g),o.O)),l=o.U,h=o.g,f=o.ca;var T="readystatechange";Array.isArray(T)||(T&&(Nd[0]=T.toString()),T=Nd);for(var b=0;b<T.length;b++){var k=Ad(h,T[b],f||l.handleEvent,!1,l.h||l);if(!k)break;l.g[k.key]=k}l=o.H?g(o.H):{},o.m?(o.u||(o.u="POST"),l["Content-Type"]="application/x-www-form-urlencoded",o.g.ea(o.A,o.u,o.m,l)):(o.u="GET",o.g.ea(o.A,o.u,null,l)),kr(),nv(o.i,o.u,o.A,o.l,o.R,o.m)}Mt.prototype.ca=function(o){o=o.target;let l=this.M;l&&vt(o)==3?l.j():this.Y(o)},Mt.prototype.Y=function(o){try{if(o==this.g)e:{let Re=vt(this.g);var l=this.g.Ba();let Fn=this.g.Z();if(!(3>Re)&&(Re!=3||this.g&&(this.h.h||this.g.oa()||lf(this.g)))){this.J||Re!=4||l==7||(l==8||0>=Fn?kr(3):kr(2)),Fa(this);var h=this.g.Z();this.X=h;t:if(zd(this)){var f=lf(this.g);o="";var T=f.length,b=vt(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){en(this),Fr(this);var k="";break t}this.h.i=new u.TextDecoder}for(l=0;l<T;l++)this.h.h=!0,o+=this.h.i.decode(f[l],{stream:!(b&&l==T-1)});f.length=0,this.h.g+=o,this.C=0,k=this.h.g}else k=this.g.oa();if(this.o=h==200,rv(this.i,this.u,this.A,this.l,this.R,Re,h),this.o){if(this.T&&!this.K){t:{if(this.g){var oe,Ie=this.g;if((oe=Ie.g?Ie.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!j(oe)){var ee=oe;break t}}ee=null}if(h=ee)kn(this.i,this.l,h,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,La(this,h);else{this.o=!1,this.s=3,Me(12),en(this),Fr(this);break e}}if(this.P){h=!0;let Xe;for(;!this.J&&this.C<k.length;)if(Xe=ov(this,k),Xe==Ma){Re==4&&(this.s=4,Me(14),h=!1),kn(this.i,this.l,null,"[Incomplete Response]");break}else if(Xe==$d){this.s=4,Me(15),kn(this.i,this.l,k,"[Invalid Chunk]"),h=!1;break}else kn(this.i,this.l,Xe,null),La(this,Xe);if(zd(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Re!=4||k.length!=0||this.h.h||(this.s=1,Me(16),h=!1),this.o=this.o&&h,!h)kn(this.i,this.l,k,"[Invalid Chunked Response]"),en(this),Fr(this);else if(0<k.length&&!this.W){this.W=!0;var Ce=this.j;Ce.g==this&&Ce.ba&&!Ce.M&&(Ce.j.info("Great, no buffering proxy detected. Bytes received: "+k.length),za(Ce),Ce.M=!0,Me(11))}}else kn(this.i,this.l,k,null),La(this,k);Re==4&&en(this),this.o&&!this.J&&(Re==4?yf(this.j,this):(this.o=!1,fs(this)))}else Tv(this.g),h==400&&0<k.indexOf("Unknown SID")?(this.s=3,Me(12)):(this.s=0,Me(13)),en(this),Fr(this)}}}catch{}finally{}};function zd(o){return o.g?o.u=="GET"&&o.L!=2&&o.j.Ca:!1}function ov(o,l){var h=o.C,f=l.indexOf(`
`,h);return f==-1?Ma:(h=Number(l.substring(h,f)),isNaN(h)?$d:(f+=1,f+h>l.length?Ma:(l=l.slice(f,f+h),o.C=f+h,l)))}Mt.prototype.cancel=function(){this.J=!0,en(this)};function fs(o){o.S=Date.now()+o.I,qd(o,o.I)}function qd(o,l){if(o.B!=null)throw Error("WatchDog timer not null");o.B=Mr(w(o.ba,o),l)}function Fa(o){o.B&&(u.clearTimeout(o.B),o.B=null)}Mt.prototype.ba=function(){this.B=null;let o=Date.now();0<=o-this.S?(iv(this.i,this.A),this.L!=2&&(kr(),Me(17)),en(this),this.s=2,Fr(this)):qd(this,this.S-o)};function Fr(o){o.j.G==0||o.J||yf(o.j,o)}function en(o){Fa(o);var l=o.M;l&&typeof l.ma=="function"&&l.ma(),o.M=null,Od(o.U),o.g&&(l=o.g,o.g=null,l.abort(),l.ma())}function La(o,l){try{var h=o.j;if(h.G!=0&&(h.g==o||Va(h.h,o))){if(!o.K&&Va(h.h,o)&&h.G==3){try{var f=h.Da.g.parse(l)}catch{f=null}if(Array.isArray(f)&&f.length==3){var T=f;if(T[0]==0){e:if(!h.u){if(h.g)if(h.g.F+3e3<o.F)Es(h),_s(h);else break e;ja(h),Me(18)}}else h.za=T[1],0<h.za-h.T&&37500>T[2]&&h.F&&h.v==0&&!h.C&&(h.C=Mr(w(h.Za,h),6e3));if(1>=Hd(h.h)&&h.ca){try{h.ca()}catch{}h.ca=void 0}}else nn(h,11)}else if((o.K||h.g==o)&&Es(h),!j(l))for(T=h.Da.g.parse(l),l=0;l<T.length;l++){let ee=T[l];if(h.T=ee[0],ee=ee[1],h.G==2)if(ee[0]=="c"){h.K=ee[1],h.ia=ee[2];let Ce=ee[3];Ce!=null&&(h.la=Ce,h.j.info("VER="+h.la));let Re=ee[4];Re!=null&&(h.Aa=Re,h.j.info("SVER="+h.Aa));let Fn=ee[5];Fn!=null&&typeof Fn=="number"&&0<Fn&&(f=1.5*Fn,h.L=f,h.j.info("backChannelRequestTimeoutMs_="+f)),f=h;let Xe=o.g;if(Xe){let Ts=Xe.g?Xe.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ts){var b=f.h;b.g||Ts.indexOf("spdy")==-1&&Ts.indexOf("quic")==-1&&Ts.indexOf("h2")==-1||(b.j=b.l,b.g=new Set,b.h&&(Ua(b,b.h),b.h=null))}if(f.D){let qa=Xe.g?Xe.g.getResponseHeader("X-HTTP-Session-Id"):null;qa&&(f.ya=qa,ue(f.I,f.D,qa))}}h.G=3,h.l&&h.l.ua(),h.ba&&(h.R=Date.now()-o.F,h.j.info("Handshake RTT: "+h.R+"ms")),f=h;var k=o;if(f.qa=wf(f,f.J?f.ia:null,f.W),k.K){Kd(f.h,k);var oe=k,Ie=f.L;Ie&&(oe.I=Ie),oe.B&&(Fa(oe),fs(oe)),f.g=k}else gf(f);0<h.i.length&&ws(h)}else ee[0]!="stop"&&ee[0]!="close"||nn(h,7);else h.G==3&&(ee[0]=="stop"||ee[0]=="close"?ee[0]=="stop"?nn(h,7):$a(h):ee[0]!="noop"&&h.l&&h.l.ta(ee),h.v=0)}}kr(4)}catch{}}var av=class{constructor(o,l){this.g=o,this.map=l}};function Gd(o){this.l=o||10,u.PerformanceNavigationTiming?(o=u.performance.getEntriesByType("navigation"),o=0<o.length&&(o[0].nextHopProtocol=="hq"||o[0].nextHopProtocol=="h2")):o=!!(u.chrome&&u.chrome.loadTimes&&u.chrome.loadTimes()&&u.chrome.loadTimes().wasFetchedViaSpdy),this.j=o?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Wd(o){return o.h?!0:o.g?o.g.size>=o.j:!1}function Hd(o){return o.h?1:o.g?o.g.size:0}function Va(o,l){return o.h?o.h==l:o.g?o.g.has(l):!1}function Ua(o,l){o.g?o.g.add(l):o.h=l}function Kd(o,l){o.h&&o.h==l?o.h=null:o.g&&o.g.has(l)&&o.g.delete(l)}Gd.prototype.cancel=function(){if(this.i=Qd(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let o of this.g.values())o.cancel();this.g.clear()}};function Qd(o){if(o.h!=null)return o.i.concat(o.h.D);if(o.g!=null&&o.g.size!==0){let l=o.i;for(let h of o.g.values())l=l.concat(h.D);return l}return N(o.i)}function uv(o){if(o.V&&typeof o.V=="function")return o.V();if(typeof Map<"u"&&o instanceof Map||typeof Set<"u"&&o instanceof Set)return Array.from(o.values());if(typeof o=="string")return o.split("");if(c(o)){for(var l=[],h=o.length,f=0;f<h;f++)l.push(o[f]);return l}l=[],h=0;for(f in o)l[h++]=o[f];return l}function cv(o){if(o.na&&typeof o.na=="function")return o.na();if(!o.V||typeof o.V!="function"){if(typeof Map<"u"&&o instanceof Map)return Array.from(o.keys());if(!(typeof Set<"u"&&o instanceof Set)){if(c(o)||typeof o=="string"){var l=[];o=o.length;for(var h=0;h<o;h++)l.push(h);return l}l=[],h=0;for(let f in o)l[h++]=f;return l}}}function Yd(o,l){if(o.forEach&&typeof o.forEach=="function")o.forEach(l,void 0);else if(c(o)||typeof o=="string")Array.prototype.forEach.call(o,l,void 0);else for(var h=cv(o),f=uv(o),T=f.length,b=0;b<T;b++)l.call(void 0,f[b],h&&h[b],o)}var Jd=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function lv(o,l){if(o){o=o.split("&");for(var h=0;h<o.length;h++){var f=o[h].indexOf("="),T=null;if(0<=f){var b=o[h].substring(0,f);T=o[h].substring(f+1)}else b=o[h];l(b,T?decodeURIComponent(T.replace(/\+/g," ")):"")}}}function tn(o){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,o instanceof tn){this.h=o.h,ps(this,o.j),this.o=o.o,this.g=o.g,gs(this,o.s),this.l=o.l;var l=o.i,h=new Ur;h.i=l.i,l.g&&(h.g=new Map(l.g),h.h=l.h),Xd(this,h),this.m=o.m}else o&&(l=String(o).match(Jd))?(this.h=!1,ps(this,l[1]||"",!0),this.o=Lr(l[2]||""),this.g=Lr(l[3]||"",!0),gs(this,l[4]),this.l=Lr(l[5]||"",!0),Xd(this,l[6]||"",!0),this.m=Lr(l[7]||"")):(this.h=!1,this.i=new Ur(null,this.h))}tn.prototype.toString=function(){var o=[],l=this.j;l&&o.push(Vr(l,Zd,!0),":");var h=this.g;return(h||l=="file")&&(o.push("//"),(l=this.o)&&o.push(Vr(l,Zd,!0),"@"),o.push(encodeURIComponent(String(h)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),h=this.s,h!=null&&o.push(":",String(h))),(h=this.l)&&(this.g&&h.charAt(0)!="/"&&o.push("/"),o.push(Vr(h,h.charAt(0)=="/"?fv:dv,!0))),(h=this.i.toString())&&o.push("?",h),(h=this.m)&&o.push("#",Vr(h,gv)),o.join("")};function yt(o){return new tn(o)}function ps(o,l,h){o.j=h?Lr(l,!0):l,o.j&&(o.j=o.j.replace(/:$/,""))}function gs(o,l){if(l){if(l=Number(l),isNaN(l)||0>l)throw Error("Bad port number "+l);o.s=l}else o.s=null}function Xd(o,l,h){l instanceof Ur?(o.i=l,mv(o.i,o.h)):(h||(l=Vr(l,pv)),o.i=new Ur(l,o.h))}function ue(o,l,h){o.i.set(l,h)}function ms(o){return ue(o,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),o}function Lr(o,l){return o?l?decodeURI(o.replace(/%25/g,"%2525")):decodeURIComponent(o):""}function Vr(o,l,h){return typeof o=="string"?(o=encodeURI(o).replace(l,hv),h&&(o=o.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),o):null}function hv(o){return o=o.charCodeAt(0),"%"+(o>>4&15).toString(16)+(o&15).toString(16)}var Zd=/[#\/\?@]/g,dv=/[#\?:]/g,fv=/[#\?]/g,pv=/[#\?@]/g,gv=/#/g;function Ur(o,l){this.h=this.g=null,this.i=o||null,this.j=!!l}function xt(o){o.g||(o.g=new Map,o.h=0,o.i&&lv(o.i,function(l,h){o.add(decodeURIComponent(l.replace(/\+/g," ")),h)}))}n=Ur.prototype,n.add=function(o,l){xt(this),this.i=null,o=Mn(this,o);var h=this.g.get(o);return h||this.g.set(o,h=[]),h.push(l),this.h+=1,this};function ef(o,l){xt(o),l=Mn(o,l),o.g.has(l)&&(o.i=null,o.h-=o.g.get(l).length,o.g.delete(l))}function tf(o,l){return xt(o),l=Mn(o,l),o.g.has(l)}n.forEach=function(o,l){xt(this),this.g.forEach(function(h,f){h.forEach(function(T){o.call(l,T,f,this)},this)},this)},n.na=function(){xt(this);let o=Array.from(this.g.values()),l=Array.from(this.g.keys()),h=[];for(let f=0;f<l.length;f++){let T=o[f];for(let b=0;b<T.length;b++)h.push(l[f])}return h},n.V=function(o){xt(this);let l=[];if(typeof o=="string")tf(this,o)&&(l=l.concat(this.g.get(Mn(this,o))));else{o=Array.from(this.g.values());for(let h=0;h<o.length;h++)l=l.concat(o[h])}return l},n.set=function(o,l){return xt(this),this.i=null,o=Mn(this,o),tf(this,o)&&(this.h-=this.g.get(o).length),this.g.set(o,[l]),this.h+=1,this},n.get=function(o,l){return o?(o=this.V(o),0<o.length?String(o[0]):l):l};function nf(o,l,h){ef(o,l),0<h.length&&(o.i=null,o.g.set(Mn(o,l),N(h)),o.h+=h.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let o=[],l=Array.from(this.g.keys());for(var h=0;h<l.length;h++){var f=l[h];let b=encodeURIComponent(String(f)),k=this.V(f);for(f=0;f<k.length;f++){var T=b;k[f]!==""&&(T+="="+encodeURIComponent(String(k[f]))),o.push(T)}}return this.i=o.join("&")};function Mn(o,l){return l=String(l),o.j&&(l=l.toLowerCase()),l}function mv(o,l){l&&!o.j&&(xt(o),o.i=null,o.g.forEach(function(h,f){var T=f.toLowerCase();f!=T&&(ef(this,f),nf(this,T,h))},o)),o.j=l}function yv(o,l){let h=new xr;if(u.Image){let f=new Image;f.onload=S(Ft,h,"TestLoadImage: loaded",!0,l,f),f.onerror=S(Ft,h,"TestLoadImage: error",!1,l,f),f.onabort=S(Ft,h,"TestLoadImage: abort",!1,l,f),f.ontimeout=S(Ft,h,"TestLoadImage: timeout",!1,l,f),u.setTimeout(function(){f.ontimeout&&f.ontimeout()},1e4),f.src=o}else l(!1)}function vv(o,l){let h=new xr,f=new AbortController,T=setTimeout(()=>{f.abort(),Ft(h,"TestPingServer: timeout",!1,l)},1e4);fetch(o,{signal:f.signal}).then(b=>{clearTimeout(T),b.ok?Ft(h,"TestPingServer: ok",!0,l):Ft(h,"TestPingServer: server error",!1,l)}).catch(()=>{clearTimeout(T),Ft(h,"TestPingServer: error",!1,l)})}function Ft(o,l,h,f,T){try{T&&(T.onload=null,T.onerror=null,T.onabort=null,T.ontimeout=null),f(h)}catch{}}function _v(){this.g=new tv}function wv(o,l,h){let f=h||"";try{Yd(o,function(T,b){let k=T;d(T)&&(k=Ra(T)),l.push(f+b+"="+encodeURIComponent(k))})}catch(T){throw l.push(f+"type="+encodeURIComponent("_badmap")),T}}function Br(o){this.l=o.Ub||null,this.j=o.eb||!1}P(Br,Pa),Br.prototype.g=function(){return new ys(this.l,this.j)},Br.prototype.i=function(o){return function(){return o}}({});function ys(o,l){be.call(this),this.D=o,this.o=l,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}P(ys,be),n=ys.prototype,n.open=function(o,l){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=o,this.A=l,this.readyState=1,jr(this)},n.send=function(o){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let l={headers:this.u,method:this.B,credentials:this.m,cache:void 0};o&&(l.body=o),(this.D||u).fetch(new Request(this.A,l)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,$r(this)),this.readyState=0},n.Sa=function(o){if(this.g&&(this.l=o,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=o.headers,this.readyState=2,jr(this)),this.g&&(this.readyState=3,jr(this),this.g)))if(this.responseType==="arraybuffer")o.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof u.ReadableStream<"u"&&"body"in o){if(this.j=o.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;rf(this)}else o.text().then(this.Ra.bind(this),this.ga.bind(this))};function rf(o){o.j.read().then(o.Pa.bind(o)).catch(o.ga.bind(o))}n.Pa=function(o){if(this.g){if(this.o&&o.value)this.response.push(o.value);else if(!this.o){var l=o.value?o.value:new Uint8Array(0);(l=this.v.decode(l,{stream:!o.done}))&&(this.response=this.responseText+=l)}o.done?$r(this):jr(this),this.readyState==3&&rf(this)}},n.Ra=function(o){this.g&&(this.response=this.responseText=o,$r(this))},n.Qa=function(o){this.g&&(this.response=o,$r(this))},n.ga=function(){this.g&&$r(this)};function $r(o){o.readyState=4,o.l=null,o.j=null,o.v=null,jr(o)}n.setRequestHeader=function(o,l){this.u.append(o,l)},n.getResponseHeader=function(o){return this.h&&this.h.get(o.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let o=[],l=this.h.entries();for(var h=l.next();!h.done;)h=h.value,o.push(h[0]+": "+h[1]),h=l.next();return o.join(`\r
`)};function jr(o){o.onreadystatechange&&o.onreadystatechange.call(o)}Object.defineProperty(ys.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(o){this.m=o?"include":"same-origin"}});function sf(o){let l="";return X(o,function(h,f){l+=f,l+=":",l+=h,l+=`\r
`}),l}function Ba(o,l,h){e:{for(f in h){var f=!1;break e}f=!0}f||(h=sf(h),typeof o=="string"?h!=null&&encodeURIComponent(String(h)):ue(o,l,h))}function de(o){be.call(this),this.headers=new Map,this.o=o||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}P(de,be);var Ev=/^https?$/i,Iv=["POST","PUT"];n=de.prototype,n.Ha=function(o){this.J=o},n.ea=function(o,l,h,f){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+o);l=l?l.toUpperCase():"GET",this.D=o,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ka.g(),this.v=this.o?kd(this.o):kd(ka),this.g.onreadystatechange=w(this.Ea,this);try{this.B=!0,this.g.open(l,String(o),!0),this.B=!1}catch(b){of(this,b);return}if(o=h||"",h=new Map(this.headers),f)if(Object.getPrototypeOf(f)===Object.prototype)for(var T in f)h.set(T,f[T]);else if(typeof f.keys=="function"&&typeof f.get=="function")for(let b of f.keys())h.set(b,f.get(b));else throw Error("Unknown input type for opt_headers: "+String(f));f=Array.from(h.keys()).find(b=>b.toLowerCase()=="content-type"),T=u.FormData&&o instanceof u.FormData,!(0<=Array.prototype.indexOf.call(Iv,l,void 0))||f||T||h.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[b,k]of h)this.g.setRequestHeader(b,k);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{cf(this),this.u=!0,this.g.send(o),this.u=!1}catch(b){of(this,b)}};function of(o,l){o.h=!1,o.g&&(o.j=!0,o.g.abort(),o.j=!1),o.l=l,o.m=5,af(o),vs(o)}function af(o){o.A||(o.A=!0,ke(o,"complete"),ke(o,"error"))}n.abort=function(o){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=o||7,ke(this,"complete"),ke(this,"abort"),vs(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),vs(this,!0)),de.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?uf(this):this.bb())},n.bb=function(){uf(this)};function uf(o){if(o.h&&typeof a<"u"&&(!o.v[1]||vt(o)!=4||o.Z()!=2)){if(o.u&&vt(o)==4)Rd(o.Ea,0,o);else if(ke(o,"readystatechange"),vt(o)==4){o.h=!1;try{let k=o.Z();e:switch(k){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var l=!0;break e;default:l=!1}var h;if(!(h=l)){var f;if(f=k===0){var T=String(o.D).match(Jd)[1]||null;!T&&u.self&&u.self.location&&(T=u.self.location.protocol.slice(0,-1)),f=!Ev.test(T?T.toLowerCase():"")}h=f}if(h)ke(o,"complete"),ke(o,"success");else{o.m=6;try{var b=2<vt(o)?o.g.statusText:""}catch{b=""}o.l=b+" ["+o.Z()+"]",af(o)}}finally{vs(o)}}}}function vs(o,l){if(o.g){cf(o);let h=o.g,f=o.v[0]?()=>{}:null;o.g=null,o.v=null,l||ke(o,"ready");try{h.onreadystatechange=f}catch{}}}function cf(o){o.I&&(u.clearTimeout(o.I),o.I=null)}n.isActive=function(){return!!this.g};function vt(o){return o.g?o.g.readyState:0}n.Z=function(){try{return 2<vt(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(o){if(this.g){var l=this.g.responseText;return o&&l.indexOf(o)==0&&(l=l.substring(o.length)),ev(l)}};function lf(o){try{if(!o.g)return null;if("response"in o.g)return o.g.response;switch(o.H){case"":case"text":return o.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in o.g)return o.g.mozResponseArrayBuffer}return null}catch{return null}}function Tv(o){let l={};o=(o.g&&2<=vt(o)&&o.g.getAllResponseHeaders()||"").split(`\r
`);for(let f=0;f<o.length;f++){if(j(o[f]))continue;var h=I(o[f]);let T=h[0];if(h=h[1],typeof h!="string")continue;h=h.trim();let b=l[T]||[];l[T]=b,b.push(h)}E(l,function(f){return f.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function zr(o,l,h){return h&&h.internalChannelParams&&h.internalChannelParams[o]||l}function hf(o){this.Aa=0,this.i=[],this.j=new xr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=zr("failFast",!1,o),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=zr("baseRetryDelayMs",5e3,o),this.cb=zr("retryDelaySeedMs",1e4,o),this.Wa=zr("forwardChannelMaxRetries",2,o),this.wa=zr("forwardChannelRequestTimeoutMs",2e4,o),this.pa=o&&o.xmlHttpFactory||void 0,this.Xa=o&&o.Tb||void 0,this.Ca=o&&o.useFetchStreams||!1,this.L=void 0,this.J=o&&o.supportsCrossDomainXhr||!1,this.K="",this.h=new Gd(o&&o.concurrentRequestLimit),this.Da=new _v,this.P=o&&o.fastHandshake||!1,this.O=o&&o.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=o&&o.Rb||!1,o&&o.xa&&this.j.xa(),o&&o.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&o&&o.detectBufferingProxy||!1,this.ja=void 0,o&&o.longPollingTimeout&&0<o.longPollingTimeout&&(this.ja=o.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=hf.prototype,n.la=8,n.G=1,n.connect=function(o,l,h,f){Me(0),this.W=o,this.H=l||{},h&&f!==void 0&&(this.H.OSID=h,this.H.OAID=f),this.F=this.X,this.I=wf(this,null,this.W),ws(this)};function $a(o){if(df(o),o.G==3){var l=o.U++,h=yt(o.I);if(ue(h,"SID",o.K),ue(h,"RID",l),ue(h,"TYPE","terminate"),qr(o,h),l=new Mt(o,o.j,l),l.L=2,l.v=ms(yt(h)),h=!1,u.navigator&&u.navigator.sendBeacon)try{h=u.navigator.sendBeacon(l.v.toString(),"")}catch{}!h&&u.Image&&(new Image().src=l.v,h=!0),h||(l.g=Ef(l.j,null),l.g.ea(l.v)),l.F=Date.now(),fs(l)}_f(o)}function _s(o){o.g&&(za(o),o.g.cancel(),o.g=null)}function df(o){_s(o),o.u&&(u.clearTimeout(o.u),o.u=null),Es(o),o.h.cancel(),o.s&&(typeof o.s=="number"&&u.clearTimeout(o.s),o.s=null)}function ws(o){if(!Wd(o.h)&&!o.s){o.s=!0;var l=o.Ga;br||Td(),Cr||(br(),Cr=!0),wa.add(l,o),o.B=0}}function Av(o,l){return Hd(o.h)>=o.h.j-(o.s?1:0)?!1:o.s?(o.i=l.D.concat(o.i),!0):o.G==1||o.G==2||o.B>=(o.Va?0:o.Wa)?!1:(o.s=Mr(w(o.Ga,o,l),vf(o,o.B)),o.B++,!0)}n.Ga=function(o){if(this.s)if(this.s=null,this.G==1){if(!o){this.U=Math.floor(1e5*Math.random()),o=this.U++;let T=new Mt(this,this.j,o),b=this.o;if(this.S&&(b?(b=g(b),_(b,this.S)):b=this.S),this.m!==null||this.O||(T.H=b,b=null),this.P)e:{for(var l=0,h=0;h<this.i.length;h++){t:{var f=this.i[h];if("__data__"in f.map&&(f=f.map.__data__,typeof f=="string")){f=f.length;break t}f=void 0}if(f===void 0)break;if(l+=f,4096<l){l=h;break e}if(l===4096||h===this.i.length-1){l=h+1;break e}}l=1e3}else l=1e3;l=pf(this,T,l),h=yt(this.I),ue(h,"RID",o),ue(h,"CVER",22),this.D&&ue(h,"X-HTTP-Session-Id",this.D),qr(this,h),b&&(this.O?l="headers="+encodeURIComponent(String(sf(b)))+"&"+l:this.m&&Ba(h,this.m,b)),Ua(this.h,T),this.Ua&&ue(h,"TYPE","init"),this.P?(ue(h,"$req",l),ue(h,"SID","null"),T.T=!0,xa(T,h,null)):xa(T,h,l),this.G=2}}else this.G==3&&(o?ff(this,o):this.i.length==0||Wd(this.h)||ff(this))};function ff(o,l){var h;l?h=l.l:h=o.U++;let f=yt(o.I);ue(f,"SID",o.K),ue(f,"RID",h),ue(f,"AID",o.T),qr(o,f),o.m&&o.o&&Ba(f,o.m,o.o),h=new Mt(o,o.j,h,o.B+1),o.m===null&&(h.H=o.o),l&&(o.i=l.D.concat(o.i)),l=pf(o,h,1e3),h.I=Math.round(.5*o.wa)+Math.round(.5*o.wa*Math.random()),Ua(o.h,h),xa(h,f,l)}function qr(o,l){o.H&&X(o.H,function(h,f){ue(l,f,h)}),o.l&&Yd({},function(h,f){ue(l,f,h)})}function pf(o,l,h){h=Math.min(o.i.length,h);var f=o.l?w(o.l.Na,o.l,o):null;e:{var T=o.i;let b=-1;for(;;){let k=["count="+h];b==-1?0<h?(b=T[0].g,k.push("ofs="+b)):b=0:k.push("ofs="+b);let oe=!0;for(let Ie=0;Ie<h;Ie++){let ee=T[Ie].g,Ce=T[Ie].map;if(ee-=b,0>ee)b=Math.max(0,T[Ie].g-100),oe=!1;else try{wv(Ce,k,"req"+ee+"_")}catch{f&&f(Ce)}}if(oe){f=k.join("&");break e}}}return o=o.i.splice(0,h),l.D=o,f}function gf(o){if(!o.g&&!o.u){o.Y=1;var l=o.Fa;br||Td(),Cr||(br(),Cr=!0),wa.add(l,o),o.v=0}}function ja(o){return o.g||o.u||3<=o.v?!1:(o.Y++,o.u=Mr(w(o.Fa,o),vf(o,o.v)),o.v++,!0)}n.Fa=function(){if(this.u=null,mf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var o=2*this.R;this.j.info("BP detection timer enabled: "+o),this.A=Mr(w(this.ab,this),o)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Me(10),_s(this),mf(this))};function za(o){o.A!=null&&(u.clearTimeout(o.A),o.A=null)}function mf(o){o.g=new Mt(o,o.j,"rpc",o.Y),o.m===null&&(o.g.H=o.o),o.g.O=0;var l=yt(o.qa);ue(l,"RID","rpc"),ue(l,"SID",o.K),ue(l,"AID",o.T),ue(l,"CI",o.F?"0":"1"),!o.F&&o.ja&&ue(l,"TO",o.ja),ue(l,"TYPE","xmlhttp"),qr(o,l),o.m&&o.o&&Ba(l,o.m,o.o),o.L&&(o.g.I=o.L);var h=o.g;o=o.ia,h.L=1,h.v=ms(yt(l)),h.m=null,h.P=!0,jd(h,o)}n.Za=function(){this.C!=null&&(this.C=null,_s(this),ja(this),Me(19))};function Es(o){o.C!=null&&(u.clearTimeout(o.C),o.C=null)}function yf(o,l){var h=null;if(o.g==l){Es(o),za(o),o.g=null;var f=2}else if(Va(o.h,l))h=l.D,Kd(o.h,l),f=1;else return;if(o.G!=0){if(l.o)if(f==1){h=l.m?l.m.length:0,l=Date.now()-l.F;var T=o.B;f=ls(),ke(f,new Vd(f,h)),ws(o)}else gf(o);else if(T=l.s,T==3||T==0&&0<l.X||!(f==1&&Av(o,l)||f==2&&ja(o)))switch(h&&0<h.length&&(l=o.h,l.i=l.i.concat(h)),T){case 1:nn(o,5);break;case 4:nn(o,10);break;case 3:nn(o,6);break;default:nn(o,2)}}}function vf(o,l){let h=o.Ta+Math.floor(Math.random()*o.cb);return o.isActive()||(h*=2),h*l}function nn(o,l){if(o.j.info("Error code "+l),l==2){var h=w(o.fb,o),f=o.Xa;let T=!f;f=new tn(f||"//www.google.com/images/cleardot.gif"),u.location&&u.location.protocol=="http"||ps(f,"https"),ms(f),T?yv(f.toString(),h):vv(f.toString(),h)}else Me(2);o.G=0,o.l&&o.l.sa(l),_f(o),df(o)}n.fb=function(o){o?(this.j.info("Successfully pinged google.com"),Me(2)):(this.j.info("Failed to ping google.com"),Me(1))};function _f(o){if(o.G=0,o.ka=[],o.l){let l=Qd(o.h);(l.length!=0||o.i.length!=0)&&(C(o.ka,l),C(o.ka,o.i),o.h.i.length=0,N(o.i),o.i.length=0),o.l.ra()}}function wf(o,l,h){var f=h instanceof tn?yt(h):new tn(h);if(f.g!="")l&&(f.g=l+"."+f.g),gs(f,f.s);else{var T=u.location;f=T.protocol,l=l?l+"."+T.hostname:T.hostname,T=+T.port;var b=new tn(null);f&&ps(b,f),l&&(b.g=l),T&&gs(b,T),h&&(b.l=h),f=b}return h=o.D,l=o.ya,h&&l&&ue(f,h,l),ue(f,"VER",o.la),qr(o,f),f}function Ef(o,l,h){if(l&&!o.J)throw Error("Can't create secondary domain capable XhrIo object.");return l=o.Ca&&!o.pa?new de(new Br({eb:h})):new de(o.pa),l.Ha(o.J),l}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function If(){}n=If.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Is(){}Is.prototype.g=function(o,l){return new Ve(o,l)};function Ve(o,l){be.call(this),this.g=new hf(l),this.l=o,this.h=l&&l.messageUrlParams||null,o=l&&l.messageHeaders||null,l&&l.clientProtocolHeaderRequired&&(o?o["X-Client-Protocol"]="webchannel":o={"X-Client-Protocol":"webchannel"}),this.g.o=o,o=l&&l.initMessageHeaders||null,l&&l.messageContentType&&(o?o["X-WebChannel-Content-Type"]=l.messageContentType:o={"X-WebChannel-Content-Type":l.messageContentType}),l&&l.va&&(o?o["X-WebChannel-Client-Profile"]=l.va:o={"X-WebChannel-Client-Profile":l.va}),this.g.S=o,(o=l&&l.Sb)&&!j(o)&&(this.g.m=o),this.v=l&&l.supportsCrossDomainXhr||!1,this.u=l&&l.sendRawJson||!1,(l=l&&l.httpSessionIdParam)&&!j(l)&&(this.g.D=l,o=this.h,o!==null&&l in o&&(o=this.h,l in o&&delete o[l])),this.j=new xn(this)}P(Ve,be),Ve.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ve.prototype.close=function(){$a(this.g)},Ve.prototype.o=function(o){var l=this.g;if(typeof o=="string"){var h={};h.__data__=o,o=h}else this.u&&(h={},h.__data__=Ra(o),o=h);l.i.push(new av(l.Ya++,o)),l.G==3&&ws(l)},Ve.prototype.N=function(){this.g.l=null,delete this.j,$a(this.g),delete this.g,Ve.aa.N.call(this)};function Tf(o){Na.call(this),o.__headers__&&(this.headers=o.__headers__,this.statusCode=o.__status__,delete o.__headers__,delete o.__status__);var l=o.__sm__;if(l){e:{for(let h in l){o=h;break e}o=void 0}(this.i=o)&&(o=this.i,l=l!==null&&o in l?l[o]:void 0),this.data=l}else this.data=o}P(Tf,Na);function Af(){Oa.call(this),this.status=1}P(Af,Oa);function xn(o){this.g=o}P(xn,If),xn.prototype.ua=function(){ke(this.g,"a")},xn.prototype.ta=function(o){ke(this.g,new Tf(o))},xn.prototype.sa=function(o){ke(this.g,new Af)},xn.prototype.ra=function(){ke(this.g,"b")},Is.prototype.createWebChannel=Is.prototype.g,Ve.prototype.send=Ve.prototype.o,Ve.prototype.open=Ve.prototype.m,Ve.prototype.close=Ve.prototype.close,Tc=Dt.createWebChannelTransport=function(){return new Is},Ic=Dt.getStatEventTarget=function(){return ls()},Ec=Dt.Event=Zt,ho=Dt.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},hs.NO_ERROR=0,hs.TIMEOUT=8,hs.HTTP_ERROR=6,mi=Dt.ErrorCode=hs,Ud.COMPLETE="complete",wc=Dt.EventType=Ud,Md.EventType=Or,Or.OPEN="a",Or.CLOSE="b",Or.ERROR="c",Or.MESSAGE="d",be.prototype.listen=be.prototype.K,Kn=Dt.WebChannel=Md,bI=Dt.FetchXmlHttpFactory=Br,de.prototype.listenOnce=de.prototype.L,de.prototype.getLastError=de.prototype.Ka,de.prototype.getLastErrorCode=de.prototype.Ba,de.prototype.getStatus=de.prototype.Z,de.prototype.getResponseJson=de.prototype.Oa,de.prototype.getResponseText=de.prototype.oa,de.prototype.send=de.prototype.ea,de.prototype.setWithCredentials=de.prototype.Ha,_c=Dt.XhrIo=de}).apply(typeof lo<"u"?lo:typeof self<"u"?self:typeof window<"u"?window:{});var fg="@firebase/firestore";var Ee=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ee.UNAUTHENTICATED=new Ee(null),Ee.GOOGLE_CREDENTIALS=new Ee("google-credentials-uid"),Ee.FIRST_PARTY=new Ee("first-party-uid"),Ee.MOCK_USER=new Ee("mock-user");var pr="10.14.0";var vn=new jt("@firebase/firestore");function yi(){return vn.logLevel}function x(n,...e){if(vn.logLevel<=Y.DEBUG){let t=e.map(hh);vn.debug(`Firestore (${pr}): ${n}`,...t)}}function Ct(n,...e){if(vn.logLevel<=Y.ERROR){let t=e.map(hh);vn.error(`Firestore (${pr}): ${n}`,...t)}}function tr(n,...e){if(vn.logLevel<=Y.WARN){let t=e.map(hh);vn.warn(`Firestore (${pr}): ${n}`,...t)}}function hh(n){if(typeof n=="string")return n;try{return function(t){return JSON.stringify(t)}(n)}catch{return n}}function $(n="Unexpected state"){let e=`FIRESTORE (${pr}) INTERNAL ASSERTION FAILED: `+n;throw Ct(e),new Error(e)}function se(n,e){n||$()}function q(n,e){return n}var R={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},M=class extends Ke{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var St=class{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}};var yo=class{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},Rc=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Ee.UNAUTHENTICATED))}shutdown(){}},Pc=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}},Nc=class{constructor(e){this.t=e,this.currentUser=Ee.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){se(this.o===void 0);let r=this.i,i=c=>this.i!==r?(r=this.i,t(c)):Promise.resolve(),s=new St;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new St,e.enqueueRetryable(()=>i(this.currentUser))};let a=()=>{let c=s;e.enqueueRetryable(()=>D(this,null,function*(){yield c.promise,yield i(this.currentUser)}))},u=c=>{x("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(c=>u(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?u(c):(x("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new St)}},0),a()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(x("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(se(typeof r.accessToken=="string"),new yo(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){let e=this.auth&&this.auth.getUid();return se(e===null||typeof e=="string"),new Ee(e)}},Oc=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Ee.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},kc=class{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new Oc(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Ee.FIRST_PARTY))}shutdown(){}invalidateToken(){}},Mc=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},xc=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){se(this.o===void 0);let r=s=>{s.error!=null&&x("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let a=s.token!==this.R;return this.R=s.token,x("FirebaseAppCheckTokenProvider",`Received ${a?"new":"existing"} token.`),a?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};let i=s=>{x("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?i(s):x("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(se(typeof t.token=="string"),this.R=t.token,new Mc(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};function CI(n){let e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}var vo=class{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="";for(;r.length<20;){let i=CI(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%e.length))}return r}};function te(n,e){return n<e?-1:n>e?1:0}function nr(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}var Ae=class n{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new M(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new M(R.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new M(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new M(R.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return n.fromMillis(Date.now())}static fromDate(e){return n.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new n(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?te(this.nanoseconds,e.nanoseconds):te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var G=class n{constructor(e){this.timestamp=e}static fromTimestamp(e){return new n(e)}static min(){return new n(new Ae(0,0))}static max(){return new n(new Ae(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var _o=class n{constructor(e,t,r){t===void 0?t=0:t>e.length&&$(),r===void 0?r=e.length-t:r>e.length-t&&$(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return n.comparator(this,e)===0}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof n?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let s=e.get(i),a=t.get(i);if(s<a)return-1;if(s>a)return 1}return e.length<t.length?-1:e.length>t.length?1:0}},he=class n extends _o{construct(e,t,r){return new n(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new M(R.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new n(t)}static emptyPath(){return new n([])}},RI=/^[_a-zA-Z][_a-zA-Z0-9]*$/,$e=class n extends _o{construct(e,t,r){return new n(e,t,r)}static isValidIdentifier(e){return RI.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(e){let t=[],r="",i=0,s=()=>{if(r.length===0)throw new M(R.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},a=!1;for(;i<e.length;){let u=e[i];if(u==="\\"){if(i+1===e.length)throw new M(R.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let c=e[i+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new M(R.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,i+=2}else u==="`"?(a=!a,i++):u!=="."||a?(r+=u,i++):(s(),i++)}if(s(),a)throw new M(R.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new n(t)}static emptyPath(){return new n([])}};var B=class n{constructor(e){this.path=e}static fromPath(e){return new n(he.fromString(e))}static fromName(e){return new n(he.fromString(e).popFirst(5))}static empty(){return new n(he.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&he.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return he.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new n(new he(e.slice()))}};var Fc=class{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}};Fc.UNKNOWN_ID=-1;function PI(n,e){let t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=G.fromTimestamp(r===1e9?new Ae(t+1,0):new Ae(t,r));return new _n(i,B.empty(),e)}function NI(n){return new _n(n.readTime,n.key,-1)}var _n=class n{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new n(G.min(),B.empty(),-1)}static max(){return new n(G.max(),B.empty(),-1)}};function OI(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=B.comparator(n.documentKey,e.documentKey),t!==0?t:te(n.largestBatchId,e.largestBatchId))}var kI="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Lc=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};function Li(n){return D(this,null,function*(){if(n.code!==R.FAILED_PRECONDITION||n.message!==kI)throw n;x("LocalStore","Unexpectedly lost primary lease")})}var O=class n{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&$(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new n((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof n?t:n.resolve(t)}catch(t){return n.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):n.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):n.reject(t)}static resolve(e){return new n((t,r)=>{t(e)})}static reject(e){return new n((t,r)=>{r(e)})}static waitFor(e){return new n((t,r)=>{let i=0,s=0,a=!1;e.forEach(u=>{++i,u.next(()=>{++s,a&&s===i&&t()},c=>r(c))}),a=!0,s===i&&t()})}static or(e){let t=n.resolve(!1);for(let r of e)t=t.next(i=>i?n.resolve(i):r());return t}static forEach(e,t){let r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new n((r,i)=>{let s=e.length,a=new Array(s),u=0;for(let c=0;c<s;c++){let d=c;t(e[d]).next(p=>{a[d]=p,++u,u===s&&r(a)},p=>i(p))}})}static doWhile(e,t){return new n((r,i)=>{let s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}};function MI(n){let e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}function Vi(n){return n.name==="IndexedDbTransactionError"}var Qg=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){let t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Ko(n){return n==null}function Ai(n){return n===0&&1/n==-1/0}function xI(n){return typeof n=="number"&&Number.isInteger(n)&&!Ai(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}var FI=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ZC=[...FI,"documentOverlays"],LI=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],VI=LI,UI=[...VI,"indexConfiguration","indexState","indexEntries"];var eR=[...UI,"globals"];function pg(n){let e=0;for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Sn(n,e){for(let t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Yg(n){for(let e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}var pe=class n{constructor(e,t){this.comparator=e,this.root=t||lt.EMPTY}insert(e,t){return new n(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,lt.BLACK,null,null))}remove(e){return new n(this.comparator,this.root.remove(e,this.comparator).copy(null,null,lt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Xn(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Xn(this.root,e,this.comparator,!1)}getReverseIterator(){return new Xn(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Xn(this.root,e,this.comparator,!0)}},Xn=class{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},lt=class n{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??n.RED,this.left=i??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new n(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return n.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){let e=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw $();let e=this.left.check();if(e!==this.right.check())throw $();return e+(this.isRed()?0:1)}};lt.EMPTY=null,lt.RED=!0,lt.BLACK=!1;lt.EMPTY=new class{constructor(){this.size=0}get key(){throw $()}get value(){throw $()}get color(){throw $()}get left(){throw $()}get right(){throw $()}copy(e,t,r,i,s){return this}insert(e,t,r){return new lt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var Ne=class n{constructor(e){this.comparator=e,this.data=new pe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new wo(this.data.getIterator())}getIteratorFrom(e){return new wo(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new n(this.comparator);return t.data=e,t}},wo=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};var Ye=class n{constructor(e){this.fields=e,e.sort($e.comparator)}static empty(){return new n([])}unionWith(e){let t=new Ne($e.comparator);for(let r of this.fields)t=t.add(r);for(let r of e)t=t.add(r);return new n(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return nr(this.fields,e.fields,(t,r)=>t.isEqual(r))}};var Eo=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};var Oe=class n{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Eo("Invalid base64 string: "+s):s}}(e);return new n(t)}static fromUint8Array(e){let t=function(i){let s="";for(let a=0;a<i.length;++a)s+=String.fromCharCode(i[a]);return s}(e);return new n(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){let r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};Oe.EMPTY_BYTE_STRING=new Oe("");var BI=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Rt(n){if(se(!!n),typeof n=="string"){let e=0,t=BI.exec(n);if(se(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}let r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ce(n.seconds),nanos:ce(n.nanos)}}function ce(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Kt(n){return typeof n=="string"?Oe.fromBase64String(n):Oe.fromUint8Array(n)}function dh(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="server_timestamp"}function fh(n){let e=n.mapValue.fields.__previous_value__;return dh(e)?fh(e):e}function Di(n){let e=Rt(n.mapValue.fields.__local_write_time__.timestampValue);return new Ae(e.seconds,e.nanos)}var Vc=class{constructor(e,t,r,i,s,a,u,c,d){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=a,this.autoDetectLongPolling=u,this.longPollingOptions=c,this.useFetchStreams=d}},Io=class n{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof n&&e.projectId===this.projectId&&e.database===this.database}};var fo={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function wn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?dh(n)?4:Xg(n)?9007199254740991:Jg(n)?10:11:$()}function ft(n,e){if(n===e)return!0;let t=wn(n);if(t!==wn(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Di(n).isEqual(Di(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;let a=Rt(i.timestampValue),u=Rt(s.timestampValue);return a.seconds===u.seconds&&a.nanos===u.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Kt(i.bytesValue).isEqual(Kt(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return ce(i.geoPointValue.latitude)===ce(s.geoPointValue.latitude)&&ce(i.geoPointValue.longitude)===ce(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return ce(i.integerValue)===ce(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){let a=ce(i.doubleValue),u=ce(s.doubleValue);return a===u?Ai(a)===Ai(u):isNaN(a)&&isNaN(u)}return!1}(n,e);case 9:return nr(n.arrayValue.values||[],e.arrayValue.values||[],ft);case 10:case 11:return function(i,s){let a=i.mapValue.fields||{},u=s.mapValue.fields||{};if(pg(a)!==pg(u))return!1;for(let c in a)if(a.hasOwnProperty(c)&&(u[c]===void 0||!ft(a[c],u[c])))return!1;return!0}(n,e);default:return $()}}function Si(n,e){return(n.values||[]).find(t=>ft(t,e))!==void 0}function rr(n,e){if(n===e)return 0;let t=wn(n),r=wn(e);if(t!==r)return te(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return te(n.booleanValue,e.booleanValue);case 2:return function(s,a){let u=ce(s.integerValue||s.doubleValue),c=ce(a.integerValue||a.doubleValue);return u<c?-1:u>c?1:u===c?0:isNaN(u)?isNaN(c)?0:-1:1}(n,e);case 3:return gg(n.timestampValue,e.timestampValue);case 4:return gg(Di(n),Di(e));case 5:return te(n.stringValue,e.stringValue);case 6:return function(s,a){let u=Kt(s),c=Kt(a);return u.compareTo(c)}(n.bytesValue,e.bytesValue);case 7:return function(s,a){let u=s.split("/"),c=a.split("/");for(let d=0;d<u.length&&d<c.length;d++){let p=te(u[d],c[d]);if(p!==0)return p}return te(u.length,c.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,a){let u=te(ce(s.latitude),ce(a.latitude));return u!==0?u:te(ce(s.longitude),ce(a.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return mg(n.arrayValue,e.arrayValue);case 10:return function(s,a){var u,c,d,p;let m=s.fields||{},w=a.fields||{},S=(u=m.value)===null||u===void 0?void 0:u.arrayValue,P=(c=w.value)===null||c===void 0?void 0:c.arrayValue,N=te(((d=S?.values)===null||d===void 0?void 0:d.length)||0,((p=P?.values)===null||p===void 0?void 0:p.length)||0);return N!==0?N:mg(S,P)}(n.mapValue,e.mapValue);case 11:return function(s,a){if(s===fo.mapValue&&a===fo.mapValue)return 0;if(s===fo.mapValue)return 1;if(a===fo.mapValue)return-1;let u=s.fields||{},c=Object.keys(u),d=a.fields||{},p=Object.keys(d);c.sort(),p.sort();for(let m=0;m<c.length&&m<p.length;++m){let w=te(c[m],p[m]);if(w!==0)return w;let S=rr(u[c[m]],d[p[m]]);if(S!==0)return S}return te(c.length,p.length)}(n.mapValue,e.mapValue);default:throw $()}}function gg(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return te(n,e);let t=Rt(n),r=Rt(e),i=te(t.seconds,r.seconds);return i!==0?i:te(t.nanos,r.nanos)}function mg(n,e){let t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){let s=rr(t[i],r[i]);if(s)return s}return te(t.length,r.length)}function ir(n){return Uc(n)}function Uc(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){let r=Rt(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Kt(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return B.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(let s of t.values||[])i?i=!1:r+=",",r+=Uc(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){let r=Object.keys(t.fields||{}).sort(),i="{",s=!0;for(let a of r)s?s=!1:i+=",",i+=`${a}:${Uc(t.fields[a])}`;return i+"}"}(n.mapValue):$()}function yg(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Bc(n){return!!n&&"integerValue"in n}function ph(n){return!!n&&"arrayValue"in n}function vg(n){return!!n&&"nullValue"in n}function _g(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function go(n){return!!n&&"mapValue"in n}function Jg(n){var e,t;return((t=(((e=n?.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||t===void 0?void 0:t.stringValue)==="__vector__"}function _i(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let e={mapValue:{fields:{}}};return Sn(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=_i(r)),e}if(n.arrayValue){let e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=_i(n.arrayValue.values[t]);return e}return Object.assign({},n)}function Xg(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Be=class n{constructor(e){this.value=e}static empty(){return new n({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!go(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=_i(t)}setAll(e){let t=$e.emptyPath(),r={},i=[];e.forEach((a,u)=>{if(!t.isImmediateParentOf(u)){let c=this.getFieldsMap(t);this.applyChanges(c,r,i),r={},i=[],t=u.popLast()}a?r[u.lastSegment()]=_i(a):i.push(u.lastSegment())});let s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){let t=this.field(e.popLast());go(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ft(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];go(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Sn(t,(i,s)=>e[i]=s);for(let i of r)delete e[i]}clone(){return new n(_i(this.value))}};function Zg(n){let e=[];return Sn(n.fields,(t,r)=>{let i=new $e([t]);if(go(r)){let s=Zg(r.mapValue).fields;if(s.length===0)e.push(i);else for(let a of s)e.push(i.child(a))}else e.push(i)}),new Ye(e)}var nt=class n{constructor(e,t,r,i,s,a,u){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=a,this.documentState=u}static newInvalidDocument(e){return new n(e,0,G.min(),G.min(),G.min(),Be.empty(),0)}static newFoundDocument(e,t,r,i){return new n(e,1,t,G.min(),r,i,0)}static newNoDocument(e,t){return new n(e,2,t,G.min(),G.min(),Be.empty(),0)}static newUnknownDocument(e,t){return new n(e,3,t,G.min(),G.min(),Be.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(G.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Be.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Be.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=G.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var sr=class{constructor(e,t){this.position=e,this.inclusive=t}};function wg(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){let s=e[i],a=n.position[i];if(s.field.isKeyField()?r=B.comparator(B.fromName(a.referenceValue),t.key):r=rr(a,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Eg(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ft(n.position[t],e.position[t]))return!1;return!0}var En=class{constructor(e,t="asc"){this.field=e,this.dir=t}};function $I(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}var To=class{},ye=class n extends To{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new jc(e,t,r):t==="array-contains"?new Gc(e,r):t==="in"?new Wc(e,r):t==="not-in"?new Hc(e,r):t==="array-contains-any"?new Kc(e,r):new n(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new zc(e,r):new qc(e,r)}matches(e){let t=e.data.field(this.field);return this.op==="!="?t!==null&&this.matchesComparison(rr(t,this.value)):t!==null&&wn(this.value)===wn(t)&&this.matchesComparison(rr(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return $()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},rt=class n extends To{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new n(e,t)}matches(e){return em(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function em(n){return n.op==="and"}function tm(n){return jI(n)&&em(n)}function jI(n){for(let e of n.filters)if(e instanceof rt)return!1;return!0}function $c(n){if(n instanceof ye)return n.field.canonicalString()+n.op.toString()+ir(n.value);if(tm(n))return n.filters.map(e=>$c(e)).join(",");{let e=n.filters.map(t=>$c(t)).join(",");return`${n.op}(${e})`}}function nm(n,e){return n instanceof ye?function(r,i){return i instanceof ye&&r.op===i.op&&r.field.isEqual(i.field)&&ft(r.value,i.value)}(n,e):n instanceof rt?function(r,i){return i instanceof rt&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,a,u)=>s&&nm(a,i.filters[u]),!0):!1}(n,e):void $()}function rm(n){return n instanceof ye?function(t){return`${t.field.canonicalString()} ${t.op} ${ir(t.value)}`}(n):n instanceof rt?function(t){return t.op.toString()+" {"+t.getFilters().map(rm).join(" ,")+"}"}(n):"Filter"}var jc=class extends ye{constructor(e,t,r){super(e,t,r),this.key=B.fromName(r.referenceValue)}matches(e){let t=B.comparator(e.key,this.key);return this.matchesComparison(t)}},zc=class extends ye{constructor(e,t){super(e,"in",t),this.keys=im("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}},qc=class extends ye{constructor(e,t){super(e,"not-in",t),this.keys=im("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}};function im(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>B.fromName(r.referenceValue))}var Gc=class extends ye{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return ph(t)&&Si(t.arrayValue,this.value)}},Wc=class extends ye{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return t!==null&&Si(this.value.arrayValue,t)}},Hc=class extends ye{constructor(e,t){super(e,"not-in",t)}matches(e){if(Si(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return t!==null&&!Si(this.value.arrayValue,t)}},Kc=class extends ye{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!ph(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Si(this.value.arrayValue,r))}};var Qc=class{constructor(e,t=null,r=[],i=[],s=null,a=null,u=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=a,this.endAt=u,this.ue=null}};function Ig(n,e=null,t=[],r=[],i=null,s=null,a=null){return new Qc(n,e,t,r,i,s,a)}function gh(n){let e=q(n);if(e.ue===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>$c(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Ko(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>ir(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>ir(r)).join(",")),e.ue=t}return e.ue}function mh(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!$I(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!nm(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Eg(n.startAt,e.startAt)&&Eg(n.endAt,e.endAt)}function Yc(n){return B.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}var Qt=class{constructor(e,t=null,r=[],i=[],s=null,a="F",u=null,c=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=a,this.startAt=u,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function zI(n,e,t,r,i,s,a,u){return new Qt(n,e,t,r,i,s,a,u)}function yh(n){return new Qt(n)}function Tg(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function sm(n){return n.collectionGroup!==null}function wi(n){let e=q(n);if(e.ce===null){e.ce=[];let t=new Set;for(let s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());let r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(a){let u=new Ne($e.comparator);return a.filters.forEach(c=>{c.getFlattenedFilters().forEach(d=>{d.isInequality()&&(u=u.add(d.field))})}),u})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new En(s,r))}),t.has($e.keyField().canonicalString())||e.ce.push(new En($e.keyField(),r))}return e.ce}function ht(n){let e=q(n);return e.le||(e.le=qI(e,wi(n))),e.le}function qI(n,e){if(n.limitType==="F")return Ig(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{let s=i.dir==="desc"?"asc":"desc";return new En(i.field,s)});let t=n.endAt?new sr(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new sr(n.startAt.position,n.startAt.inclusive):null;return Ig(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Jc(n,e){let t=n.filters.concat([e]);return new Qt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Xc(n,e,t){return new Qt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Qo(n,e){return mh(ht(n),ht(e))&&n.limitType===e.limitType}function om(n){return`${gh(ht(n))}|lt:${n.limitType}`}function Qn(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>rm(i)).join(", ")}]`),Ko(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(a){return`${a.field.canonicalString()} (${a.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>ir(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>ir(i)).join(",")),`Target(${r})`}(ht(n))}; limitType=${n.limitType})`}function Yo(n,e){return e.isFoundDocument()&&function(r,i){let s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):B.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(let s of wi(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(let s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(a,u,c){let d=wg(a,u,c);return a.inclusive?d<=0:d<0}(r.startAt,wi(r),i)||r.endAt&&!function(a,u,c){let d=wg(a,u,c);return a.inclusive?d>=0:d>0}(r.endAt,wi(r),i))}(n,e)}function GI(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function am(n){return(e,t)=>{let r=!1;for(let i of wi(n)){let s=WI(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function WI(n,e,t){let r=n.field.isKeyField()?B.comparator(e.key,t.key):function(s,a,u){let c=a.data.field(s),d=u.data.field(s);return c!==null&&d!==null?rr(c,d):$()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return $()}}var Yt=class{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(let[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Sn(this.inner,(t,r)=>{for(let[i,s]of r)e(i,s)})}isEmpty(){return Yg(this.inner)}size(){return this.innerSize}};var HI=new pe(B.comparator);function Pt(){return HI}var um=new pe(B.comparator);function vi(...n){let e=um;for(let t of n)e=e.insert(t.key,t);return e}function cm(n){let e=um;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function gn(){return Ei()}function lm(){return Ei()}function Ei(){return new Yt(n=>n.toString(),(n,e)=>n.isEqual(e))}var KI=new pe(B.comparator),QI=new Ne(B.comparator);function J(...n){let e=QI;for(let t of n)e=e.add(t);return e}var YI=new Ne(te);function JI(){return YI}function vh(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ai(e)?"-0":e}}function hm(n){return{integerValue:""+n}}function XI(n,e){return xI(e)?hm(e):vh(n,e)}var or=class{constructor(){this._=void 0}};function ZI(n,e,t){return n instanceof ar?function(i,s){let a={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&dh(s)&&(s=fh(s)),s&&(a.fields.__previous_value__=s),{mapValue:a}}(t,e):n instanceof In?fm(n,e):n instanceof Tn?pm(n,e):function(i,s){let a=dm(i,s),u=Ag(a)+Ag(i.Pe);return Bc(a)&&Bc(i.Pe)?hm(u):vh(i.serializer,u)}(n,e)}function e0(n,e,t){return n instanceof In?fm(n,e):n instanceof Tn?pm(n,e):t}function dm(n,e){return n instanceof ur?function(r){return Bc(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}var ar=class extends or{},In=class extends or{constructor(e){super(),this.elements=e}};function fm(n,e){let t=gm(e);for(let r of n.elements)t.some(i=>ft(i,r))||t.push(r);return{arrayValue:{values:t}}}var Tn=class extends or{constructor(e){super(),this.elements=e}};function pm(n,e){let t=gm(e);for(let r of n.elements)t=t.filter(i=>!ft(i,r));return{arrayValue:{values:t}}}var ur=class extends or{constructor(e,t){super(),this.serializer=e,this.Pe=t}};function Ag(n){return ce(n.integerValue||n.doubleValue)}function gm(n){return ph(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}function t0(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof In&&i instanceof In||r instanceof Tn&&i instanceof Tn?nr(r.elements,i.elements,ft):r instanceof ur&&i instanceof ur?ft(r.Pe,i.Pe):r instanceof ar&&i instanceof ar}(n.transform,e.transform)}var Zc=class{constructor(e,t){this.version=e,this.transformResults=t}},bt=class n{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new n}static exists(e){return new n(void 0,e)}static updateTime(e){return new n(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function mo(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}var cr=class{};function mm(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new bi(n.key,bt.none()):new An(n.key,n.data,bt.none());{let t=n.data,r=Be.empty(),i=new Ne($e.comparator);for(let s of e.fields)if(!i.has(s)){let a=t.field(s);a===null&&s.length>1&&(s=s.popLast(),a=t.field(s)),a===null?r.delete(s):r.set(s,a),i=i.add(s)}return new pt(n.key,r,new Ye(i.toArray()),bt.none())}}function n0(n,e,t){n instanceof An?function(i,s,a){let u=i.value.clone(),c=Sg(i.fieldTransforms,s,a.transformResults);u.setAll(c),s.convertToFoundDocument(a.version,u).setHasCommittedMutations()}(n,e,t):n instanceof pt?function(i,s,a){if(!mo(i.precondition,s))return void s.convertToUnknownDocument(a.version);let u=Sg(i.fieldTransforms,s,a.transformResults),c=s.data;c.setAll(ym(i)),c.setAll(u),s.convertToFoundDocument(a.version,c).setHasCommittedMutations()}(n,e,t):function(i,s,a){s.convertToNoDocument(a.version).setHasCommittedMutations()}(0,e,t)}function Ii(n,e,t,r){return n instanceof An?function(s,a,u,c){if(!mo(s.precondition,a))return u;let d=s.value.clone(),p=bg(s.fieldTransforms,c,a);return d.setAll(p),a.convertToFoundDocument(a.version,d).setHasLocalMutations(),null}(n,e,t,r):n instanceof pt?function(s,a,u,c){if(!mo(s.precondition,a))return u;let d=bg(s.fieldTransforms,c,a),p=a.data;return p.setAll(ym(s)),p.setAll(d),a.convertToFoundDocument(a.version,p).setHasLocalMutations(),u===null?null:u.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(m=>m.field))}(n,e,t,r):function(s,a,u){return mo(s.precondition,a)?(a.convertToNoDocument(a.version).setHasLocalMutations(),null):u}(n,e,t)}function r0(n,e){let t=null;for(let r of n.fieldTransforms){let i=e.data.field(r.field),s=dm(r.transform,i||null);s!=null&&(t===null&&(t=Be.empty()),t.set(r.field,s))}return t||null}function Dg(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&nr(r,i,(s,a)=>t0(s,a))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}var An=class extends cr{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}},pt=class extends cr{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function ym(n){let e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){let r=n.data.field(t);e.set(t,r)}}),e}function Sg(n,e,t){let r=new Map;se(n.length===t.length);for(let i=0;i<t.length;i++){let s=n[i],a=s.transform,u=e.data.field(s.field);r.set(s.field,e0(a,u,t[i]))}return r}function bg(n,e,t){let r=new Map;for(let i of n){let s=i.transform,a=t.data.field(i.field);r.set(i.field,ZI(s,a,e))}return r}var bi=class extends cr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},el=class extends cr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var tl=class{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){let s=this.mutations[i];s.key.isEqual(e.key)&&n0(s,e,r[i])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=Ii(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=Ii(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=lm();return this.mutations.forEach(i=>{let s=e.get(i.key),a=s.overlayedDocument,u=this.applyToLocalView(a,s.mutatedFields);u=t.has(i.key)?null:u;let c=mm(a,u);c!==null&&r.set(i.key,c),a.isValidDocument()||a.convertToNoDocument(G.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),J())}isEqual(e){return this.batchId===e.batchId&&nr(this.mutations,e.mutations,(t,r)=>Dg(t,r))&&nr(this.baseMutations,e.baseMutations,(t,r)=>Dg(t,r))}},nl=class n{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){se(e.mutations.length===r.length);let i=function(){return KI}(),s=e.mutations;for(let a=0;a<s.length;a++)i=i.insert(s[a].key,r[a].version);return new n(e,t,r,i)}};var rl=class{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var il=class{constructor(e,t){this.count=e,this.unchangedNames=t}};var ge,Z;function i0(n){switch(n){default:return $();case R.CANCELLED:case R.UNKNOWN:case R.DEADLINE_EXCEEDED:case R.RESOURCE_EXHAUSTED:case R.INTERNAL:case R.UNAVAILABLE:case R.UNAUTHENTICATED:return!1;case R.INVALID_ARGUMENT:case R.NOT_FOUND:case R.ALREADY_EXISTS:case R.PERMISSION_DENIED:case R.FAILED_PRECONDITION:case R.ABORTED:case R.OUT_OF_RANGE:case R.UNIMPLEMENTED:case R.DATA_LOSS:return!0}}function vm(n){if(n===void 0)return Ct("GRPC error has no .code"),R.UNKNOWN;switch(n){case ge.OK:return R.OK;case ge.CANCELLED:return R.CANCELLED;case ge.UNKNOWN:return R.UNKNOWN;case ge.DEADLINE_EXCEEDED:return R.DEADLINE_EXCEEDED;case ge.RESOURCE_EXHAUSTED:return R.RESOURCE_EXHAUSTED;case ge.INTERNAL:return R.INTERNAL;case ge.UNAVAILABLE:return R.UNAVAILABLE;case ge.UNAUTHENTICATED:return R.UNAUTHENTICATED;case ge.INVALID_ARGUMENT:return R.INVALID_ARGUMENT;case ge.NOT_FOUND:return R.NOT_FOUND;case ge.ALREADY_EXISTS:return R.ALREADY_EXISTS;case ge.PERMISSION_DENIED:return R.PERMISSION_DENIED;case ge.FAILED_PRECONDITION:return R.FAILED_PRECONDITION;case ge.ABORTED:return R.ABORTED;case ge.OUT_OF_RANGE:return R.OUT_OF_RANGE;case ge.UNIMPLEMENTED:return R.UNIMPLEMENTED;case ge.DATA_LOSS:return R.DATA_LOSS;default:return $()}}(Z=ge||(ge={}))[Z.OK=0]="OK",Z[Z.CANCELLED=1]="CANCELLED",Z[Z.UNKNOWN=2]="UNKNOWN",Z[Z.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Z[Z.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Z[Z.NOT_FOUND=5]="NOT_FOUND",Z[Z.ALREADY_EXISTS=6]="ALREADY_EXISTS",Z[Z.PERMISSION_DENIED=7]="PERMISSION_DENIED",Z[Z.UNAUTHENTICATED=16]="UNAUTHENTICATED",Z[Z.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Z[Z.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Z[Z.ABORTED=10]="ABORTED",Z[Z.OUT_OF_RANGE=11]="OUT_OF_RANGE",Z[Z.UNIMPLEMENTED=12]="UNIMPLEMENTED",Z[Z.INTERNAL=13]="INTERNAL",Z[Z.UNAVAILABLE=14]="UNAVAILABLE",Z[Z.DATA_LOSS=15]="DATA_LOSS";var Cg=null;function s0(){return new TextEncoder}var o0=new Wt([4294967295,4294967295],0);function Rg(n){let e=s0().encode(n),t=new vc;return t.update(e),new Uint8Array(t.digest())}function Pg(n){let e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Wt([t,r],0),new Wt([i,s],0)]}var sl=class n{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new mn(`Invalid padding: ${t}`);if(r<0)throw new mn(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new mn(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new mn(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Wt.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(Wt.fromNumber(r)));return i.compare(o0)===1&&(i=new Wt([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;let t=Rg(e),[r,i]=Pg(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);if(!this.de(a))return!1}return!0}static create(e,t,r){let i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),a=new n(s,i,t);return r.forEach(u=>a.insert(u)),a}insert(e){if(this.Ie===0)return;let t=Rg(e),[r,i]=Pg(t);for(let s=0;s<this.hashCount;s++){let a=this.Ee(r,i,s);this.Ae(a)}}Ae(e){let t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}},mn=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var Ao=class n{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){let i=new Map;return i.set(e,Ci.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new n(G.min(),i,new pe(te),Pt(),J())}},Ci=class n{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new n(r,t,J(),J(),J())}};var Zn=class{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}},Do=class{constructor(e,t){this.targetId=e,this.me=t}},So=class{constructor(e,t,r=Oe.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}},bo=class{constructor(){this.fe=0,this.ge=Og(),this.pe=Oe.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=J(),t=J(),r=J();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:$()}}),new Ci(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=Og()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,se(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},ol=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Pt(),this.qe=Ng(),this.Qe=new pe(te)}Ke(e){for(let t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(let t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{let r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:$()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){let t=e.targetId,r=e.me.count,i=this.Je(t);if(i){let s=i.target;if(Yc(s))if(r===0){let a=new B(s.path);this.Ue(t,a,nt.newNoDocument(a,G.min()))}else se(r===1);else{let a=this.Ye(t);if(a!==r){let u=this.Ze(e),c=u?this.Xe(u,e,a):1;if(c!==0){this.je(t);let d=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,d)}Cg?.et(function(p,m,w,S,P){var N,C,U,j,L,ne;let le={localCacheCount:p,existenceFilterCount:m.count,databaseId:w.database,projectId:w.projectId},X=m.unchangedNames;return X&&(le.bloomFilter={applied:P===0,hashCount:(N=X?.hashCount)!==null&&N!==void 0?N:0,bitmapLength:(j=(U=(C=X?.bits)===null||C===void 0?void 0:C.bitmap)===null||U===void 0?void 0:U.length)!==null&&j!==void 0?j:0,padding:(ne=(L=X?.bits)===null||L===void 0?void 0:L.padding)!==null&&ne!==void 0?ne:0,mightContain:E=>{var g;return(g=S?.mightContain(E))!==null&&g!==void 0&&g}}),le}(a,e.me,this.Le.tt(),u,c))}}}}Ze(e){let t=e.me.unchangedNames;if(!t||!t.bits)return null;let{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t,a,u;try{a=Kt(r).toUint8Array()}catch(c){if(c instanceof Eo)return tr("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{u=new sl(a,i,s)}catch(c){return tr(c instanceof mn?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return u.Ie===0?null:u}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){let r=this.Le.getRemoteKeysForTarget(t),i=0;return r.forEach(s=>{let a=this.Le.tt(),u=`projects/${a.projectId}/databases/${a.database}/documents/${s.path.canonicalString()}`;e.mightContain(u)||(this.Ue(t,s,null),i++)}),i}rt(e){let t=new Map;this.Be.forEach((s,a)=>{let u=this.Je(a);if(u){if(s.current&&Yc(u.target)){let c=new B(u.target.path);this.ke.get(c)!==null||this.it(a,c)||this.Ue(a,c,nt.newNoDocument(c,e))}s.be&&(t.set(a,s.ve()),s.Ce())}});let r=J();this.qe.forEach((s,a)=>{let u=!0;a.forEachWhile(c=>{let d=this.Je(c);return!d||d.purpose==="TargetPurposeLimboResolution"||(u=!1,!1)}),u&&(r=r.add(s))}),this.ke.forEach((s,a)=>a.setReadTime(e));let i=new Ao(e,t,this.Qe,this.ke,r);return this.ke=Pt(),this.qe=Ng(),this.Qe=new pe(te),i}$e(e,t){if(!this.ze(e))return;let r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;let i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){let t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new bo,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Ne(te),this.qe=this.qe.insert(e,t)),t}ze(e){let t=this.Je(e)!==null;return t||x("WatchChangeAggregator","Detected inactive target",e),t}Je(e){let t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new bo),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}};function Ng(){return new pe(B.comparator)}function Og(){return new pe(B.comparator)}var a0={asc:"ASCENDING",desc:"DESCENDING"},u0={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},c0={and:"AND",or:"OR"},al=class{constructor(e,t){this.databaseId=e,this.useProto3Json=t}};function ul(n,e){return n.useProto3Json||Ko(e)?e:{value:e}}function Co(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function _m(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function l0(n,e){return Co(n,e.toTimestamp())}function dt(n){return se(!!n),G.fromTimestamp(function(t){let r=Rt(t);return new Ae(r.seconds,r.nanos)}(n))}function _h(n,e){return cl(n,e).canonicalString()}function cl(n,e){let t=function(i){return new he(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function wm(n){let e=he.fromString(n);return se(Dm(e)),e}function ll(n,e){return _h(n.databaseId,e.path)}function Ac(n,e){let t=wm(e);if(t.get(1)!==n.databaseId.projectId)throw new M(R.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new M(R.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new B(Im(t))}function Em(n,e){return _h(n.databaseId,e)}function h0(n){let e=wm(n);return e.length===4?he.emptyPath():Im(e)}function hl(n){return new he(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Im(n){return se(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function kg(n,e,t){return{name:ll(n,e),fields:t.value.mapValue.fields}}function d0(n,e){let t;if("targetChange"in e){e.targetChange;let r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:$()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(d,p){return d.useProto3Json?(se(p===void 0||typeof p=="string"),Oe.fromBase64String(p||"")):(se(p===void 0||p instanceof Buffer||p instanceof Uint8Array),Oe.fromUint8Array(p||new Uint8Array))}(n,e.targetChange.resumeToken),a=e.targetChange.cause,u=a&&function(d){let p=d.code===void 0?R.UNKNOWN:vm(d.code);return new M(p,d.message||"")}(a);t=new So(r,i,s,u||null)}else if("documentChange"in e){e.documentChange;let r=e.documentChange;r.document,r.document.name,r.document.updateTime;let i=Ac(n,r.document.name),s=dt(r.document.updateTime),a=r.document.createTime?dt(r.document.createTime):G.min(),u=new Be({mapValue:{fields:r.document.fields}}),c=nt.newFoundDocument(i,s,a,u),d=r.targetIds||[],p=r.removedTargetIds||[];t=new Zn(d,p,c.key,c)}else if("documentDelete"in e){e.documentDelete;let r=e.documentDelete;r.document;let i=Ac(n,r.document),s=r.readTime?dt(r.readTime):G.min(),a=nt.newNoDocument(i,s),u=r.removedTargetIds||[];t=new Zn([],u,a.key,a)}else if("documentRemove"in e){e.documentRemove;let r=e.documentRemove;r.document;let i=Ac(n,r.document),s=r.removedTargetIds||[];t=new Zn([],s,i,null)}else{if(!("filter"in e))return $();{e.filter;let r=e.filter;r.targetId;let{count:i=0,unchangedNames:s}=r,a=new il(i,s),u=r.targetId;t=new Do(u,a)}}return t}function f0(n,e){let t;if(e instanceof An)t={update:kg(n,e.key,e.value)};else if(e instanceof bi)t={delete:ll(n,e.key)};else if(e instanceof pt)t={update:kg(n,e.key,e.data),updateMask:I0(e.fieldMask)};else{if(!(e instanceof el))return $();t={verify:ll(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,a){let u=a.transform;if(u instanceof ar)return{fieldPath:a.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof In)return{fieldPath:a.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Tn)return{fieldPath:a.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof ur)return{fieldPath:a.field.canonicalString(),increment:u.Pe};throw $()}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:l0(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:$()}(n,e.precondition)),t}function p0(n,e){return n&&n.length>0?(se(e!==void 0),n.map(t=>function(i,s){let a=i.updateTime?dt(i.updateTime):dt(s);return a.isEqual(G.min())&&(a=dt(s)),new Zc(a,i.transformResults||[])}(t,e))):[]}function g0(n,e){return{documents:[Em(n,e.path)]}}function m0(n,e){let t={structuredQuery:{}},r=e.path,i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Em(n,i);let s=function(d){if(d.length!==0)return Am(rt.create(d,"and"))}(e.filters);s&&(t.structuredQuery.where=s);let a=function(d){if(d.length!==0)return d.map(p=>function(w){return{field:Yn(w.field),direction:_0(w.dir)}}(p))}(e.orderBy);a&&(t.structuredQuery.orderBy=a);let u=ul(n,e.limit);return u!==null&&(t.structuredQuery.limit=u),e.startAt&&(t.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:t,parent:i}}function y0(n){let e=h0(n.parent),t=n.structuredQuery,r=t.from?t.from.length:0,i=null;if(r>0){se(r===1);let p=t.from[0];p.allDescendants?i=p.collectionId:e=e.child(p.collectionId)}let s=[];t.where&&(s=function(m){let w=Tm(m);return w instanceof rt&&tm(w)?w.getFilters():[w]}(t.where));let a=[];t.orderBy&&(a=function(m){return m.map(w=>function(P){return new En(Jn(P.field),function(C){switch(C){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(P.direction))}(w))}(t.orderBy));let u=null;t.limit&&(u=function(m){let w;return w=typeof m=="object"?m.value:m,Ko(w)?null:w}(t.limit));let c=null;t.startAt&&(c=function(m){let w=!!m.before,S=m.values||[];return new sr(S,w)}(t.startAt));let d=null;return t.endAt&&(d=function(m){let w=!m.before,S=m.values||[];return new sr(S,w)}(t.endAt)),zI(e,i,a,s,u,"F",c,d)}function v0(n,e){let t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return $()}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Tm(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":let r=Jn(t.unaryFilter.field);return ye.create(r,"==",{doubleValue:NaN});case"IS_NULL":let i=Jn(t.unaryFilter.field);return ye.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=Jn(t.unaryFilter.field);return ye.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let a=Jn(t.unaryFilter.field);return ye.create(a,"!=",{nullValue:"NULL_VALUE"});default:return $()}}(n):n.fieldFilter!==void 0?function(t){return ye.create(Jn(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return $()}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return rt.create(t.compositeFilter.filters.map(r=>Tm(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return $()}}(t.compositeFilter.op))}(n):$()}function _0(n){return a0[n]}function w0(n){return u0[n]}function E0(n){return c0[n]}function Yn(n){return{fieldPath:n.canonicalString()}}function Jn(n){return $e.fromServerFormat(n.fieldPath)}function Am(n){return n instanceof ye?function(t){if(t.op==="=="){if(_g(t.value))return{unaryFilter:{field:Yn(t.field),op:"IS_NAN"}};if(vg(t.value))return{unaryFilter:{field:Yn(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(_g(t.value))return{unaryFilter:{field:Yn(t.field),op:"IS_NOT_NAN"}};if(vg(t.value))return{unaryFilter:{field:Yn(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yn(t.field),op:w0(t.op),value:t.value}}}(n):n instanceof rt?function(t){let r=t.getFilters().map(i=>Am(i));return r.length===1?r[0]:{compositeFilter:{op:E0(t.op),filters:r}}}(n):$()}function I0(n){let e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Dm(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var Ri=class n{constructor(e,t,r,i,s=G.min(),a=G.min(),u=Oe.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=a,this.resumeToken=u,this.expectedCount=c}withSequenceNumber(e){return new n(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};var dl=class{constructor(e){this.ct=e}};function T0(n){let e=y0({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Xc(e,e.limit,"L"):e}var Ro=class{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(ce(e.integerValue));else if("doubleValue"in e){let r=ce(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Ai(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),typeof r=="string"&&(r=Rt(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Kt(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?Xg(e)?this.dt(t,Number.MAX_SAFE_INTEGER):Jg(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):$()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){let r=e.fields||{};this.dt(t,55);for(let i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;let s=e.fields||{};this.dt(t,53);let a="value",u=((i=(r=s[a].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(t,15),t.At(ce(u)),this.Vt(a,t),this.Tt(s[a],t)}bt(e,t){let r=e.values||[];this.dt(t,50);for(let i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),B.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}};Ro.vt=new Ro;var fl=class{constructor(){this.un=new pl}addToCollectionParentIndex(e,t){return this.un.add(t),O.resolve()}getCollectionParents(e,t){return O.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return O.resolve()}deleteFieldIndex(e,t){return O.resolve()}deleteAllFieldIndexes(e){return O.resolve()}createTargetIndexes(e,t){return O.resolve()}getDocumentsMatchingTarget(e,t){return O.resolve(null)}getIndexType(e,t){return O.resolve(0)}getFieldIndexes(e,t){return O.resolve([])}getNextCollectionGroupToUpdate(e){return O.resolve(null)}getMinOffset(e,t){return O.resolve(_n.min())}getMinOffsetFromCollectionGroup(e,t){return O.resolve(_n.min())}updateCollectionGroup(e,t,r){return O.resolve()}updateIndexEntries(e,t){return O.resolve()}},pl=class{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new Ne(he.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ne(he.comparator)).toArray()}};var nR=new Uint8Array(0);var ct=class n{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new n(e,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};ct.DEFAULT_COLLECTION_PERCENTILE=10,ct.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ct.DEFAULT=new ct(41943040,ct.DEFAULT_COLLECTION_PERCENTILE,ct.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ct.DISABLED=new ct(-1,0,0);var Pi=class n{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var gl=class{constructor(){this.changes=new Yt(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,nt.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return r!==void 0?O.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};var ml=class{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}};var yl=class{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&Ii(r.mutation,i,Ye.empty(),Ae.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,J()).next(()=>r))}getLocalViewOfDocuments(e,t,r=J()){let i=gn();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let a=vi();return s.forEach((u,c)=>{a=a.insert(u,c.overlayedDocument)}),a}))}getOverlayedDocuments(e,t){let r=gn();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,J()))}populateOverlays(e,t,r){let i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((a,u)=>{t.set(a,u)})})}computeViews(e,t,r,i){let s=Pt(),a=Ei(),u=function(){return Ei()}();return t.forEach((c,d)=>{let p=r.get(d.key);i.has(d.key)&&(p===void 0||p.mutation instanceof pt)?s=s.insert(d.key,d):p!==void 0?(a.set(d.key,p.mutation.getFieldMask()),Ii(p.mutation,d,p.mutation.getFieldMask(),Ae.now())):a.set(d.key,Ye.empty())}),this.recalculateAndSaveOverlays(e,s).next(c=>(c.forEach((d,p)=>a.set(d,p)),t.forEach((d,p)=>{var m;return u.set(d,new ml(p,(m=a.get(d))!==null&&m!==void 0?m:null))}),u))}recalculateAndSaveOverlays(e,t){let r=Ei(),i=new pe((a,u)=>a-u),s=J();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(a=>{for(let u of a)u.keys().forEach(c=>{let d=t.get(c);if(d===null)return;let p=r.get(c)||Ye.empty();p=u.applyToLocalView(d,p),r.set(c,p);let m=(i.get(u.batchId)||J()).add(c);i=i.insert(u.batchId,m)})}).next(()=>{let a=[],u=i.getReverseIterator();for(;u.hasNext();){let c=u.getNext(),d=c.key,p=c.value,m=lm();p.forEach(w=>{if(!s.has(w)){let S=mm(t.get(w),r.get(w));S!==null&&m.set(w,S),s=s.add(w)}}),a.push(this.documentOverlayCache.saveOverlays(e,d,m))}return O.waitFor(a)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(a){return B.isDocumentKey(a.path)&&a.collectionGroup===null&&a.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):sm(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{let a=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):O.resolve(gn()),u=-1,c=s;return a.next(d=>O.forEach(d,(p,m)=>(u<m.largestBatchId&&(u=m.largestBatchId),s.get(p)?O.resolve():this.remoteDocumentCache.getEntry(e,p).next(w=>{c=c.insert(p,w)}))).next(()=>this.populateOverlays(e,d,s)).next(()=>this.computeViews(e,c,d,J())).next(p=>({batchId:u,changes:cm(p)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new B(t)).next(r=>{let i=vi();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let s=t.collectionGroup,a=vi();return this.indexManager.getCollectionParents(e,s).next(u=>O.forEach(u,c=>{let d=function(m,w){return new Qt(w,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt)}(t,c.child(s));return this.getDocumentsMatchingCollectionQuery(e,d,r,i).next(p=>{p.forEach((m,w)=>{a=a.insert(m,w)})})}).next(()=>a))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(a=>(s=a,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(a=>{s.forEach((c,d)=>{let p=d.getKey();a.get(p)===null&&(a=a.insert(p,nt.newInvalidDocument(p)))});let u=vi();return a.forEach((c,d)=>{let p=s.get(c);p!==void 0&&Ii(p.mutation,d,Ye.empty(),Ae.now()),Yo(t,d)&&(u=u.insert(c,d))}),u})}};var vl=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return O.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:dt(i.createTime)}}(t)),O.resolve()}getNamedQuery(e,t){return O.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(i){return{name:i.name,query:T0(i.bundledQuery),readTime:dt(i.readTime)}}(t)),O.resolve()}};var _l=class{constructor(){this.overlays=new pe(B.comparator),this.Ir=new Map}getOverlay(e,t){return O.resolve(this.overlays.get(t))}getOverlays(e,t){let r=gn();return O.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),O.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),O.resolve()}getOverlaysForCollection(e,t,r){let i=gn(),s=t.length+1,a=new B(t.child("")),u=this.overlays.getIteratorFrom(a);for(;u.hasNext();){let c=u.getNext().value,d=c.getKey();if(!t.isPrefixOf(d.path))break;d.path.length===s&&c.largestBatchId>r&&i.set(c.getKey(),c)}return O.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new pe((d,p)=>d-p),a=this.overlays.getIterator();for(;a.hasNext();){let d=a.getNext().value;if(d.getKey().getCollectionGroup()===t&&d.largestBatchId>r){let p=s.get(d.largestBatchId);p===null&&(p=gn(),s=s.insert(d.largestBatchId,p)),p.set(d.getKey(),d)}}let u=gn(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((d,p)=>u.set(d,p)),!(u.size()>=i)););return O.resolve(u)}ht(e,t,r){let i=this.overlays.get(r.key);if(i!==null){let a=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,a)}this.overlays=this.overlays.insert(r.key,new rl(t,r));let s=this.Ir.get(t);s===void 0&&(s=J(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}};var wl=class{constructor(){this.sessionToken=Oe.EMPTY_BYTE_STRING}getSessionToken(e){return O.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,O.resolve()}};var Ni=class{constructor(){this.Tr=new Ne(me.Er),this.dr=new Ne(me.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){let r=new me(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new me(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){let t=new B(new he([])),r=new me(t,e),i=new me(t,e+1),s=[];return this.dr.forEachInRange([r,i],a=>{this.Vr(a),s.push(a.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){let t=new B(new he([])),r=new me(t,e),i=new me(t,e+1),s=J();return this.dr.forEachInRange([r,i],a=>{s=s.add(a.key)}),s}containsKey(e){let t=new me(e,0),r=this.Tr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}},me=class{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return B.comparator(e.key,t.key)||te(e.wr,t.wr)}static Ar(e,t){return te(e.wr,t.wr)||B.comparator(e.key,t.key)}};var El=class{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Ne(me.Er)}checkEmpty(e){return O.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let a=new tl(s,t,r,i);this.mutationQueue.push(a);for(let u of i)this.br=this.br.add(new me(u.key,s)),this.indexManager.addToCollectionParentIndex(e,u.key.path.popLast());return O.resolve(a)}lookupMutationBatch(e,t){return O.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.vr(r),s=i<0?0:i;return O.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return O.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return O.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new me(t,0),i=new me(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],a=>{let u=this.Dr(a.wr);s.push(u)}),O.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ne(te);return t.forEach(i=>{let s=new me(i,0),a=new me(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,a],u=>{r=r.add(u.wr)})}),O.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,s=r;B.isDocumentKey(s)||(s=s.child(""));let a=new me(new B(s),0),u=new Ne(te);return this.br.forEachWhile(c=>{let d=c.key.path;return!!r.isPrefixOf(d)&&(d.length===i&&(u=u.add(c.wr)),!0)},a),O.resolve(this.Cr(u))}Cr(e){let t=[];return e.forEach(r=>{let i=this.Dr(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){se(this.Fr(t.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return O.forEach(t.mutations,i=>{let s=new me(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){let r=new me(t,0),i=this.br.firstAfterOrEqual(r);return O.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,O.resolve()}Fr(e,t){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){let t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}};var Il=class{constructor(e){this.Mr=e,this.docs=function(){return new pe(B.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),s=i?i.size:0,a=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:a}),this.size+=a-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return O.resolve(r?r.document.mutableCopy():nt.newInvalidDocument(t))}getEntries(e,t){let r=Pt();return t.forEach(i=>{let s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():nt.newInvalidDocument(i))}),O.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=Pt(),a=t.path,u=new B(a.child("")),c=this.docs.getIteratorFrom(u);for(;c.hasNext();){let{key:d,value:{document:p}}=c.getNext();if(!a.isPrefixOf(d.path))break;d.path.length>a.length+1||OI(NI(p),r)<=0||(i.has(p.key)||Yo(t,p))&&(s=s.insert(p.key,p.mutableCopy()))}return O.resolve(s)}getAllFromCollectionGroup(e,t,r,i){$()}Or(e,t){return O.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new Tl(this)}getSize(e){return O.resolve(this.size)}},Tl=class extends gl{constructor(e){super(),this.cr=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),O.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}};var Al=class{constructor(e){this.persistence=e,this.Nr=new Yt(t=>gh(t),mh),this.lastRemoteSnapshotVersion=G.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ni,this.targetCount=0,this.kr=Pi.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),O.resolve()}getLastRemoteSnapshotVersion(e){return O.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return O.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),O.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),O.resolve()}Kn(e){this.Nr.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.kr=new Pi(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,O.resolve()}updateTargetData(e,t){return this.Kn(t),O.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,O.resolve()}removeTargets(e,t,r){let i=0,s=[];return this.Nr.forEach((a,u)=>{u.sequenceNumber<=t&&r.get(u.targetId)===null&&(this.Nr.delete(a),s.push(this.removeMatchingKeysForTargetId(e,u.targetId)),i++)}),O.waitFor(s).next(()=>i)}getTargetCount(e){return O.resolve(this.targetCount)}getTargetData(e,t){let r=this.Nr.get(t)||null;return O.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),O.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);let i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(a=>{s.push(i.markPotentiallyOrphaned(e,a))}),O.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),O.resolve()}getMatchingKeysForTargetId(e,t){let r=this.Br.yr(t);return O.resolve(r)}containsKey(e,t){return O.resolve(this.Br.containsKey(t))}};var Dl=class{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Qg(0),this.Kr=!1,this.Kr=!0,this.$r=new wl,this.referenceDelegate=e(this),this.Ur=new Al(this),this.indexManager=new fl,this.remoteDocumentCache=function(i){return new Il(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new dl(t),this.Gr=new vl(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new _l,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new El(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){x("MemoryPersistence","Starting transaction:",e);let i=new Sl(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return O.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}},Sl=class extends Lc{constructor(e){super(),this.currentSequenceNumber=e}},bl=class n{constructor(e){this.persistence=e,this.Jr=new Ni,this.Yr=null}static Zr(e){return new n(e)}get Xr(){if(this.Yr)return this.Yr;throw $()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),O.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),O.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),O.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return O.forEach(this.Xr,r=>{let i=B.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,G.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return O.or([()=>O.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}};var Cl=class n{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=J(),i=J();for(let s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new n(e,t.fromCache,r,i)}};var Rl=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};var Pl=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Pp()?8:MI(Ue())>0?6:4}()}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){let s={result:null};return this.Yi(e,t).next(a=>{s.result=a}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(a=>{s.result=a})}).next(()=>{if(s.result)return;let a=new Rl;return this.Xi(e,t,a).next(u=>{if(s.result=u,this.zi)return this.es(e,t,a,u.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(yi()<=Y.DEBUG&&x("QueryEngine","SDK will not create cache indexes for query:",Qn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),O.resolve()):(yi()<=Y.DEBUG&&x("QueryEngine","Query:",Qn(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(yi()<=Y.DEBUG&&x("QueryEngine","The SDK decides to create cache indexes for query:",Qn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ht(t))):O.resolve())}Yi(e,t){if(Tg(t))return O.resolve(null);let r=ht(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Xc(t,null,"F"),r=ht(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{let a=J(...s);return this.Ji.getDocuments(e,a).next(u=>this.indexManager.getMinOffset(e,r).next(c=>{let d=this.ts(t,u);return this.ns(t,d,a,c.readTime)?this.Yi(e,Xc(t,null,"F")):this.rs(e,d,t,c)}))})))}Zi(e,t,r,i){return Tg(t)||i.isEqual(G.min())?O.resolve(null):this.Ji.getDocuments(e,r).next(s=>{let a=this.ts(t,s);return this.ns(t,a,r,i)?O.resolve(null):(yi()<=Y.DEBUG&&x("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Qn(t)),this.rs(e,a,t,PI(i,-1)).next(u=>u))})}ts(e,t){let r=new Ne(am(e));return t.forEach((i,s)=>{Yo(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;let s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return yi()<=Y.DEBUG&&x("QueryEngine","Using full collection scan to execute query:",Qn(t)),this.Ji.getDocumentsMatchingQuery(e,t,_n.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(a=>{s=s.insert(a.key,a)}),s))}};var Nl=class{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new pe(te),this._s=new Yt(s=>gh(s),mh),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new yl(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}};function A0(n,e,t,r){return new Nl(n,e,t,r)}function Sm(n,e){return D(this,null,function*(){let t=q(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{let a=[],u=[],c=J();for(let d of i){a.push(d.batchId);for(let p of d.mutations)c=c.add(p.key)}for(let d of s){u.push(d.batchId);for(let p of d.mutations)c=c.add(p.key)}return t.localDocuments.getDocuments(r,c).next(d=>({hs:d,removedBatchIds:a,addedBatchIds:u}))})})})}function D0(n,e){let t=q(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{let i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(u,c,d,p){let m=d.batch,w=m.keys(),S=O.resolve();return w.forEach(P=>{S=S.next(()=>p.getEntry(c,P)).next(N=>{let C=d.docVersions.get(P);se(C!==null),N.version.compareTo(C)<0&&(m.applyToRemoteDocument(N,d),N.isValidDocument()&&(N.setReadTime(d.commitVersion),p.addEntry(N)))})}),S.next(()=>u.mutationQueue.removeMutationBatch(c,m))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(u){let c=J();for(let d=0;d<u.mutationResults.length;++d)u.mutationResults[d].transformResults.length>0&&(c=c.add(u.batch.mutations[d].key));return c}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function bm(n){let e=q(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function S0(n,e){let t=q(n),r=e.snapshotVersion,i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let a=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;let u=[];e.targetChanges.forEach((p,m)=>{let w=i.get(m);if(!w)return;u.push(t.Ur.removeMatchingKeys(s,p.removedDocuments,m).next(()=>t.Ur.addMatchingKeys(s,p.addedDocuments,m)));let S=w.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(m)!==null?S=S.withResumeToken(Oe.EMPTY_BYTE_STRING,G.min()).withLastLimboFreeSnapshotVersion(G.min()):p.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(p.resumeToken,r)),i=i.insert(m,S),function(N,C,U){return N.resumeToken.approximateByteSize()===0||C.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=3e8?!0:U.addedDocuments.size+U.modifiedDocuments.size+U.removedDocuments.size>0}(w,S,p)&&u.push(t.Ur.updateTargetData(s,S))});let c=Pt(),d=J();if(e.documentUpdates.forEach(p=>{e.resolvedLimboDocuments.has(p)&&u.push(t.persistence.referenceDelegate.updateLimboDocument(s,p))}),u.push(b0(s,a,e.documentUpdates).next(p=>{c=p.Ps,d=p.Is})),!r.isEqual(G.min())){let p=t.Ur.getLastRemoteSnapshotVersion(s).next(m=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));u.push(p)}return O.waitFor(u).next(()=>a.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,c,d)).next(()=>c)}).then(s=>(t.os=i,s))}function b0(n,e,t){let r=J(),i=J();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let a=Pt();return t.forEach((u,c)=>{let d=s.get(u);c.isFoundDocument()!==d.isFoundDocument()&&(i=i.add(u)),c.isNoDocument()&&c.version.isEqual(G.min())?(e.removeEntry(u,c.readTime),a=a.insert(u,c)):!d.isValidDocument()||c.version.compareTo(d.version)>0||c.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(c),a=a.insert(u,c)):x("LocalStore","Ignoring outdated watch update for ",u,". Current version:",d.version," Watch version:",c.version)}),{Ps:a,Is:i}})}function C0(n,e){let t=q(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function R0(n,e){let t=q(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,O.resolve(i)):t.Ur.allocateTargetId(r).next(a=>(i=new Ri(e,a,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{let i=t.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function Ol(n,e,t){return D(this,null,function*(){let r=q(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,a=>r.persistence.referenceDelegate.removeTarget(a,i)))}catch(a){if(!Vi(a))throw a;x("LocalStore",`Failed to update sequence numbers for target ${e}: ${a}`)}r.os=r.os.remove(e),r._s.delete(i.target)})}function Mg(n,e,t){let r=q(n),i=G.min(),s=J();return r.persistence.runTransaction("Execute query","readwrite",a=>function(c,d,p){let m=q(c),w=m._s.get(p);return w!==void 0?O.resolve(m.os.get(w)):m.Ur.getTargetData(d,p)}(r,a,ht(e)).next(u=>{if(u)return i=u.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(a,u.targetId).next(c=>{s=c})}).next(()=>r.ss.getDocumentsMatchingQuery(a,e,t?i:G.min(),t?s:J())).next(u=>(P0(r,GI(e),u),{documents:u,Ts:s})))}function P0(n,e,t){let r=n.us.get(e)||G.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}var Po=class{constructor(){this.activeTargetIds=JI()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}};var kl=class{constructor(){this.so=new Po,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Po,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};var Ml=class{_o(e){}shutdown(){}};var No=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){x("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let e of this.ho)e(0)}lo(){x("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var po=null;function Dc(){return po===null?po=function(){return 268435456+Math.round(2147483648*Math.random())}():po++,"0x"+po.toString(16)}var N0={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var xl=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};var Pe="WebChannelConnection",Fl=class extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;let r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,a){let u=Dc(),c=this.xo(t,r.toUriEncodedString());x("RestConnection",`Sending RPC '${t}' ${u}:`,c,i);let d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,s,a),this.No(t,c,d,i).then(p=>(x("RestConnection",`Received RPC '${t}' ${u}: `,p),p),p=>{throw tr("RestConnection",`RPC '${t}' ${u} failed with error: `,p,"url: ",c,"request:",i),p})}Lo(t,r,i,s,a,u){return this.Mo(t,r,i,s,a)}Oo(t,r,i){t["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+pr}(),t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,a)=>t[a]=s),i&&i.headers.forEach((s,a)=>t[a]=s)}xo(t,r){let i=N0[t];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){let s=Dc();return new Promise((a,u)=>{let c=new _c;c.setWithCredentials(!0),c.listenOnce(wc.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case mi.NO_ERROR:let p=c.getResponseJson();x(Pe,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(p)),a(p);break;case mi.TIMEOUT:x(Pe,`RPC '${e}' ${s} timed out`),u(new M(R.DEADLINE_EXCEEDED,"Request time out"));break;case mi.HTTP_ERROR:let m=c.getStatus();if(x(Pe,`RPC '${e}' ${s} failed with status:`,m,"response text:",c.getResponseText()),m>0){let w=c.getResponseJson();Array.isArray(w)&&(w=w[0]);let S=w?.error;if(S&&S.status&&S.message){let P=function(C){let U=C.toLowerCase().replace(/_/g,"-");return Object.values(R).indexOf(U)>=0?U:R.UNKNOWN}(S.status);u(new M(P,S.message))}else u(new M(R.UNKNOWN,"Server responded with status "+c.getStatus()))}else u(new M(R.UNAVAILABLE,"Connection failed."));break;default:$()}}finally{x(Pe,`RPC '${e}' ${s} completed.`)}});let d=JSON.stringify(i);x(Pe,`RPC '${e}' ${s} sending request:`,i),c.send(t,"POST",d,r,15)})}Bo(e,t,r){let i=Dc(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],a=Tc(),u=Ic(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(c.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,t,r),c.encodeInitMessageHeaders=!0;let p=s.join("");x(Pe,`Creating RPC '${e}' stream ${i}: ${p}`,c);let m=a.createWebChannel(p,c),w=!1,S=!1,P=new xl({Io:C=>{S?x(Pe,`Not sending because RPC '${e}' stream ${i} is closed:`,C):(w||(x(Pe,`Opening RPC '${e}' stream ${i} transport.`),m.open(),w=!0),x(Pe,`RPC '${e}' stream ${i} sending:`,C),m.send(C))},To:()=>m.close()}),N=(C,U,j)=>{C.listen(U,L=>{try{j(L)}catch(ne){setTimeout(()=>{throw ne},0)}})};return N(m,Kn.EventType.OPEN,()=>{S||(x(Pe,`RPC '${e}' stream ${i} transport opened.`),P.yo())}),N(m,Kn.EventType.CLOSE,()=>{S||(S=!0,x(Pe,`RPC '${e}' stream ${i} transport closed`),P.So())}),N(m,Kn.EventType.ERROR,C=>{S||(S=!0,tr(Pe,`RPC '${e}' stream ${i} transport errored:`,C),P.So(new M(R.UNAVAILABLE,"The operation could not be completed")))}),N(m,Kn.EventType.MESSAGE,C=>{var U;if(!S){let j=C.data[0];se(!!j);let L=j,ne=L.error||((U=L[0])===null||U===void 0?void 0:U.error);if(ne){x(Pe,`RPC '${e}' stream ${i} received error:`,ne);let le=ne.status,X=function(v){let _=ge[v];if(_!==void 0)return vm(_)}(le),E=ne.message;X===void 0&&(X=R.INTERNAL,E="Unknown error status: "+le+" with message "+ne.message),S=!0,P.So(new M(X,E)),m.close()}else x(Pe,`RPC '${e}' stream ${i} received:`,j),P.bo(j)}}),N(u,Ec.STAT_EVENT,C=>{C.stat===ho.PROXY?x(Pe,`RPC '${e}' stream ${i} detected buffering proxy`):C.stat===ho.NOPROXY&&x(Pe,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{P.wo()},0),P}};function Sc(){return typeof document<"u"?document:null}function Jo(n){return new al(n,!0)}var Oo=class{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();let t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&x("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var ko=class{constructor(e,t,r,i,s,a,u,c){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=a,this.appCheckCredentialsProvider=u,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Oo(e,t)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return D(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){return D(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){return D(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():t&&t.code===R.RESOURCE_EXHAUSTED?(Ct(t.toString()),Ct("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===R.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,yield this.listener.mo(t)})}l_(){}auth(){this.state=1;let e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{let i=new M(R.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){let r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(()=>D(this,null,function*(){this.state=0,this.start()}))}I_(e){return x("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(x("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Ll=class extends ko{constructor(e,t,r,i,s,a){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();let t=d0(this.serializer,e),r=function(s){if(!("targetChange"in s))return G.min();let a=s.targetChange;return a.targetIds&&a.targetIds.length?G.min():a.readTime?dt(a.readTime):G.min()}(e);return this.listener.d_(t,r)}A_(e){let t={};t.database=hl(this.serializer),t.addTarget=function(s,a){let u,c=a.target;if(u=Yc(c)?{documents:g0(s,c)}:{query:m0(s,c)._t},u.targetId=a.targetId,a.resumeToken.approximateByteSize()>0){u.resumeToken=_m(s,a.resumeToken);let d=ul(s,a.expectedCount);d!==null&&(u.expectedCount=d)}else if(a.snapshotVersion.compareTo(G.min())>0){u.readTime=Co(s,a.snapshotVersion.toTimestamp());let d=ul(s,a.expectedCount);d!==null&&(u.expectedCount=d)}return u}(this.serializer,e);let r=v0(this.serializer,e);r&&(t.labels=r),this.a_(t)}R_(e){let t={};t.database=hl(this.serializer),t.removeTarget=e,this.a_(t)}},Vl=class extends ko{constructor(e,t,r,i,s,a){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,a),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return se(!!e.streamToken),this.lastStreamToken=e.streamToken,se(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){se(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();let t=p0(e.writeResults,e.commitTime),r=dt(e.commitTime);return this.listener.g_(r,t)}p_(){let e={};e.database=hl(this.serializer),this.a_(e)}m_(e){let t={streamToken:this.lastStreamToken,writes:e.map(r=>f0(this.serializer,r))};this.a_(t)}};var Ul=class extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new M(R.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.Mo(e,cl(t,r),i,s,a)).catch(s=>{throw s.name==="FirebaseError"?(s.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new M(R.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,u])=>this.connection.Lo(e,cl(t,r),i,a,u,s)).catch(a=>{throw a.name==="FirebaseError"?(a.code===R.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new M(R.UNKNOWN,a.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Bl=class{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Ct(t),this.D_=!1):x("OnlineStateTracker",t)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var $l=class{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{r.enqueueAndForget(()=>D(this,null,function*(){bn(this)&&(x("RemoteStore","Restarting streams for network reachability change."),yield function(c){return D(this,null,function*(){let d=q(c);d.L_.add(4),yield Ui(d),d.q_.set("Unknown"),d.L_.delete(4),yield Xo(d)})}(this))}))}),this.q_=new Bl(r,i)}};function Xo(n){return D(this,null,function*(){if(bn(n))for(let e of n.B_)yield e(!0)})}function Ui(n){return D(this,null,function*(){for(let e of n.B_)yield e(!1)})}function Cm(n,e){let t=q(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),Th(t)?Ih(t):gr(t).r_()&&Eh(t,e))}function wh(n,e){let t=q(n),r=gr(t);t.N_.delete(e),r.r_()&&Rm(t,e),t.N_.size===0&&(r.r_()?r.o_():bn(t)&&t.q_.set("Unknown"))}function Eh(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(G.min())>0){let t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}gr(n).A_(e)}function Rm(n,e){n.Q_.xe(e),gr(n).R_(e)}function Ih(n){n.Q_=new ol({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),gr(n).start(),n.q_.v_()}function Th(n){return bn(n)&&!gr(n).n_()&&n.N_.size>0}function bn(n){return q(n).L_.size===0}function Pm(n){n.Q_=void 0}function O0(n){return D(this,null,function*(){n.q_.set("Online")})}function k0(n){return D(this,null,function*(){n.N_.forEach((e,t)=>{Eh(n,e)})})}function M0(n,e){return D(this,null,function*(){Pm(n),Th(n)?(n.q_.M_(e),Ih(n)):n.q_.set("Unknown")})}function x0(n,e,t){return D(this,null,function*(){if(n.q_.set("Online"),e instanceof So&&e.state===2&&e.cause)try{yield function(i,s){return D(this,null,function*(){let a=s.cause;for(let u of s.targetIds)i.N_.has(u)&&(yield i.remoteSyncer.rejectListen(u,a),i.N_.delete(u),i.Q_.removeTarget(u))})}(n,e)}catch(r){x("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Mo(n,r)}else if(e instanceof Zn?n.Q_.Ke(e):e instanceof Do?n.Q_.He(e):n.Q_.We(e),!t.isEqual(G.min()))try{let r=yield bm(n.localStore);t.compareTo(r)>=0&&(yield function(s,a){let u=s.Q_.rt(a);return u.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){let p=s.N_.get(d);p&&s.N_.set(d,p.withResumeToken(c.resumeToken,a))}}),u.targetMismatches.forEach((c,d)=>{let p=s.N_.get(c);if(!p)return;s.N_.set(c,p.withResumeToken(Oe.EMPTY_BYTE_STRING,p.snapshotVersion)),Rm(s,c);let m=new Ri(p.target,c,d,p.sequenceNumber);Eh(s,m)}),s.remoteSyncer.applyRemoteEvent(u)}(n,t))}catch(r){x("RemoteStore","Failed to raise snapshot:",r),yield Mo(n,r)}})}function Mo(n,e,t){return D(this,null,function*(){if(!Vi(e))throw e;n.L_.add(1),yield Ui(n),n.q_.set("Offline"),t||(t=()=>bm(n.localStore)),n.asyncQueue.enqueueRetryable(()=>D(this,null,function*(){x("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield Xo(n)}))})}function Nm(n,e){return e().catch(t=>Mo(n,t,e))}function Zo(n){return D(this,null,function*(){let e=q(n),t=Jt(e),r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;F0(e);)try{let i=yield C0(e.localStore,r);if(i===null){e.O_.length===0&&t.o_();break}r=i.batchId,L0(e,i)}catch(i){yield Mo(e,i)}Om(e)&&km(e)})}function F0(n){return bn(n)&&n.O_.length<10}function L0(n,e){n.O_.push(e);let t=Jt(n);t.r_()&&t.V_&&t.m_(e.mutations)}function Om(n){return bn(n)&&!Jt(n).n_()&&n.O_.length>0}function km(n){Jt(n).start()}function V0(n){return D(this,null,function*(){Jt(n).p_()})}function U0(n){return D(this,null,function*(){let e=Jt(n);for(let t of n.O_)e.m_(t.mutations)})}function B0(n,e,t){return D(this,null,function*(){let r=n.O_.shift(),i=nl.from(r,e,t);yield Nm(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield Zo(n)})}function $0(n,e){return D(this,null,function*(){e&&Jt(n).V_&&(yield function(r,i){return D(this,null,function*(){if(function(a){return i0(a)&&a!==R.ABORTED}(i.code)){let s=r.O_.shift();Jt(r).s_(),yield Nm(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),yield Zo(r)}})}(n,e)),Om(n)&&km(n)})}function xg(n,e){return D(this,null,function*(){let t=q(n);t.asyncQueue.verifyOperationInProgress(),x("RemoteStore","RemoteStore received new credentials");let r=bn(t);t.L_.add(3),yield Ui(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield Xo(t)})}function j0(n,e){return D(this,null,function*(){let t=q(n);e?(t.L_.delete(2),yield Xo(t)):e||(t.L_.add(2),yield Ui(t),t.q_.set("Unknown"))})}function gr(n){return n.K_||(n.K_=function(t,r,i){let s=q(t);return s.w_(),new Ll(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:O0.bind(null,n),Ro:k0.bind(null,n),mo:M0.bind(null,n),d_:x0.bind(null,n)}),n.B_.push(e=>D(this,null,function*(){e?(n.K_.s_(),Th(n)?Ih(n):n.q_.set("Unknown")):(yield n.K_.stop(),Pm(n))}))),n.K_}function Jt(n){return n.U_||(n.U_=function(t,r,i){let s=q(t);return s.w_(),new Vl(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:V0.bind(null,n),mo:$0.bind(null,n),f_:U0.bind(null,n),g_:B0.bind(null,n)}),n.B_.push(e=>D(this,null,function*(){e?(n.U_.s_(),yield Zo(n)):(yield n.U_.stop(),n.O_.length>0&&(x("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var jl=class n{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new St,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){let a=Date.now()+r,u=new n(e,t,a,i,s);return u.start(r),u}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new M(R.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Ah(n,e){if(Ct("AsyncQueue",`${e}: ${n}`),Vi(n))return new M(R.UNAVAILABLE,`${e}: ${n}`);throw n}var xo=class n{constructor(e){this.comparator=e?(t,r)=>e(t,r)||B.comparator(t.key,r.key):(t,r)=>B.comparator(t.key,r.key),this.keyedMap=vi(),this.sortedSet=new pe(this.comparator)}static emptySet(e){return new n(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof n)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){let i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){let r=new n;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}};var Fo=class{constructor(){this.W_=new pe(B.comparator)}track(e){let t=e.doc.key,r=this.W_.get(t);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(t,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(t):e.type===1&&r.type===2?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):$():this.W_=this.W_.insert(t,e)}G_(){let e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}},lr=class n{constructor(e,t,r,i,s,a,u,c,d){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=a,this.syncStateChanged=u,this.excludesMetadataChanges=c,this.hasCachedResults=d}static fromInitialDocuments(e,t,r,i,s){let a=[];return t.forEach(u=>{a.push({type:0,doc:u})}),new n(e,t,xo.emptySet(t),a,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Qo(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}};var zl=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},ql=class{constructor(){this.queries=Fg(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(t,r){let i=q(t),s=i.queries;i.queries=Fg(),s.forEach((a,u)=>{for(let c of u.j_)c.onError(r)})})(this,new M(R.ABORTED,"Firestore shutting down"))}};function Fg(){return new Yt(n=>om(n),Qo)}function z0(n,e){return D(this,null,function*(){let t=q(n),r=3,i=e.query,s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new zl,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(a){let u=Ah(a,`Initialization of query '${Qn(e.query)}' failed`);return void e.onError(u)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&Dh(t)})}function q0(n,e){return D(this,null,function*(){let t=q(n),r=e.query,i=3,s=t.queries.get(r);if(s){let a=s.j_.indexOf(e);a>=0&&(s.j_.splice(a,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})}function G0(n,e){let t=q(n),r=!1;for(let i of e){let s=i.query,a=t.queries.get(s);if(a){for(let u of a.j_)u.X_(i)&&(r=!0);a.z_=i}}r&&Dh(t)}function W0(n,e,t){let r=q(n),i=r.queries.get(e);if(i)for(let s of i.j_)s.onError(t);r.queries.delete(e)}function Dh(n){n.Y_.forEach(e=>{e.next()})}var Gl,Lg;(Lg=Gl||(Gl={})).ea="default",Lg.Cache="cache";var Wl=class{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){let r=[];for(let i of e.docChanges)i.type!==3&&r.push(i);e=new lr(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache||!this.J_())return!0;let r=t!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}ia(e){if(e.docChanges.length>0)return!0;let t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}oa(e){e=lr.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Gl.Cache}};var Lo=class{constructor(e){this.key=e}},Vo=class{constructor(e){this.key=e}},Hl=class{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=J(),this.mutatedKeys=J(),this.Aa=am(e),this.Ra=new xo(this.Aa)}get Va(){return this.Ta}ma(e,t){let r=t?t.fa:new Fo,i=t?t.Ra:this.Ra,s=t?t.mutatedKeys:this.mutatedKeys,a=i,u=!1,c=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,d=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((p,m)=>{let w=i.get(p),S=Yo(this.query,m)?m:null,P=!!w&&this.mutatedKeys.has(w.key),N=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations),C=!1;w&&S?w.data.isEqual(S.data)?P!==N&&(r.track({type:3,doc:S}),C=!0):this.ga(w,S)||(r.track({type:2,doc:S}),C=!0,(c&&this.Aa(S,c)>0||d&&this.Aa(S,d)<0)&&(u=!0)):!w&&S?(r.track({type:0,doc:S}),C=!0):w&&!S&&(r.track({type:1,doc:w}),C=!0,(c||d)&&(u=!0)),C&&(S?(a=a.add(S),s=N?s.add(p):s.delete(p)):(a=a.delete(p),s=s.delete(p)))}),this.query.limit!==null)for(;a.size>this.query.limit;){let p=this.query.limitType==="F"?a.last():a.first();a=a.delete(p.key),s=s.delete(p.key),r.track({type:1,doc:p})}return{Ra:a,fa:r,ns:u,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){let s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;let a=e.fa.G_();a.sort((p,m)=>function(S,P){let N=C=>{switch(C){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return $()}};return N(S)-N(P)}(p.type,m.type)||this.Aa(p.doc,m.doc)),this.pa(r),i=i!=null&&i;let u=t&&!i?this.ya():[],c=this.da.size===0&&this.current&&!i?1:0,d=c!==this.Ea;return this.Ea=c,a.length!==0||d?{snapshot:new lr(this.query,e.Ra,s,a,e.mutatedKeys,c===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:u}:{wa:u}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Fo,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];let e=this.da;this.da=J(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});let t=[];return e.forEach(r=>{this.da.has(r)||t.push(new Vo(r))}),this.da.forEach(r=>{e.has(r)||t.push(new Lo(r))}),t}ba(e){this.Ta=e.Ts,this.da=J();let t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return lr.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Kl=class{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}},Ql=class{constructor(e){this.key=e,this.va=!1}},Yl=class{constructor(e,t,r,i,s,a){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=a,this.Ca={},this.Fa=new Yt(u=>om(u),Qo),this.Ma=new Map,this.xa=new Set,this.Oa=new pe(B.comparator),this.Na=new Map,this.La=new Ni,this.Ba={},this.ka=new Map,this.qa=Pi.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function H0(n,e,t=!0){return D(this,null,function*(){let r=Um(n),i,s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield Mm(r,e,t,!0),i})}function K0(n,e){return D(this,null,function*(){let t=Um(n);yield Mm(t,e,!0,!1)})}function Mm(n,e,t,r){return D(this,null,function*(){let i=yield R0(n.localStore,ht(e)),s=i.targetId,a=n.sharedClientState.addLocalQueryTarget(s,t),u;return r&&(u=yield Q0(n,e,s,a==="current",i.resumeToken)),n.isPrimaryClient&&t&&Cm(n.remoteStore,i),u})}function Q0(n,e,t,r,i){return D(this,null,function*(){n.Ka=(m,w,S)=>function(N,C,U,j){return D(this,null,function*(){let L=C.view.ma(U);L.ns&&(L=yield Mg(N.localStore,C.query,!1).then(({documents:E})=>C.view.ma(E,L)));let ne=j&&j.targetChanges.get(C.targetId),le=j&&j.targetMismatches.get(C.targetId)!=null,X=C.view.applyChanges(L,N.isPrimaryClient,ne,le);return Ug(N,C.targetId,X.wa),X.snapshot})}(n,m,w,S);let s=yield Mg(n.localStore,e,!0),a=new Hl(e,s.Ts),u=a.ma(s.documents),c=Ci.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),d=a.applyChanges(u,n.isPrimaryClient,c);Ug(n,t,d.wa);let p=new Kl(e,t,a);return n.Fa.set(e,p),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),d.snapshot})}function Y0(n,e,t){return D(this,null,function*(){let r=q(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(a=>!Qo(a,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Ol(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&wh(r.remoteStore,i.targetId),Jl(r,i.targetId)}).catch(Li))):(Jl(r,i.targetId),yield Ol(r.localStore,i.targetId,!0))})}function J0(n,e){return D(this,null,function*(){let t=q(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),wh(t.remoteStore,r.targetId))})}function X0(n,e,t){return D(this,null,function*(){let r=sT(n);try{let i=yield function(a,u){let c=q(a),d=Ae.now(),p=u.reduce((S,P)=>S.add(P.key),J()),m,w;return c.persistence.runTransaction("Locally write mutations","readwrite",S=>{let P=Pt(),N=J();return c.cs.getEntries(S,p).next(C=>{P=C,P.forEach((U,j)=>{j.isValidDocument()||(N=N.add(U))})}).next(()=>c.localDocuments.getOverlayedDocuments(S,P)).next(C=>{m=C;let U=[];for(let j of u){let L=r0(j,m.get(j.key).overlayedDocument);L!=null&&U.push(new pt(j.key,L,Zg(L.value.mapValue),bt.exists(!0)))}return c.mutationQueue.addMutationBatch(S,d,U,u)}).next(C=>{w=C;let U=C.applyToLocalDocumentSet(m,N);return c.documentOverlayCache.saveOverlays(S,C.batchId,U)})}).then(()=>({batchId:w.batchId,changes:cm(m)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(a,u,c){let d=a.Ba[a.currentUser.toKey()];d||(d=new pe(te)),d=d.insert(u,c),a.Ba[a.currentUser.toKey()]=d}(r,i.batchId,t),yield Bi(r,i.changes),yield Zo(r.remoteStore)}catch(i){let s=Ah(i,"Failed to persist write");t.reject(s)}})}function xm(n,e){return D(this,null,function*(){let t=q(n);try{let r=yield S0(t.localStore,e);e.targetChanges.forEach((i,s)=>{let a=t.Na.get(s);a&&(se(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?a.va=!0:i.modifiedDocuments.size>0?se(a.va):i.removedDocuments.size>0&&(se(a.va),a.va=!1))}),yield Bi(t,r,e)}catch(r){yield Li(r)}})}function Vg(n,e,t){let r=q(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){let i=[];r.Fa.forEach((s,a)=>{let u=a.view.Z_(e);u.snapshot&&i.push(u.snapshot)}),function(a,u){let c=q(a);c.onlineState=u;let d=!1;c.queries.forEach((p,m)=>{for(let w of m.j_)w.Z_(u)&&(d=!0)}),d&&Dh(c)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function Z0(n,e,t){return D(this,null,function*(){let r=q(n);r.sharedClientState.updateQueryState(e,"rejected",t);let i=r.Na.get(e),s=i&&i.key;if(s){let a=new pe(B.comparator);a=a.insert(s,nt.newNoDocument(s,G.min()));let u=J().add(s),c=new Ao(G.min(),new Map,new pe(te),a,u);yield xm(r,c),r.Oa=r.Oa.remove(s),r.Na.delete(e),Sh(r)}else yield Ol(r.localStore,e,!1).then(()=>Jl(r,e,t)).catch(Li)})}function eT(n,e){return D(this,null,function*(){let t=q(n),r=e.batch.batchId;try{let i=yield D0(t.localStore,e);Lm(t,r,null),Fm(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Bi(t,i)}catch(i){yield Li(i)}})}function tT(n,e,t){return D(this,null,function*(){let r=q(n);try{let i=yield function(a,u){let c=q(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let p;return c.mutationQueue.lookupMutationBatch(d,u).next(m=>(se(m!==null),p=m.keys(),c.mutationQueue.removeMutationBatch(d,m))).next(()=>c.mutationQueue.performConsistencyCheck(d)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(d,p,u)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,p)).next(()=>c.localDocuments.getDocuments(d,p))})}(r.localStore,e);Lm(r,e,t),Fm(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Bi(r,i)}catch(i){yield Li(i)}})}function Fm(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function Lm(n,e,t){let r=q(n),i=r.Ba[r.currentUser.toKey()];if(i){let s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Jl(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(let r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||Vm(n,r)})}function Vm(n,e){n.xa.delete(e.path.canonicalString());let t=n.Oa.get(e);t!==null&&(wh(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),Sh(n))}function Ug(n,e,t){for(let r of t)r instanceof Lo?(n.La.addReference(r.key,e),nT(n,r)):r instanceof Vo?(x("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||Vm(n,r.key)):$()}function nT(n,e){let t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(x("SyncEngine","New document in limbo: "+t),n.xa.add(r),Sh(n))}function Sh(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let e=n.xa.values().next().value;n.xa.delete(e);let t=new B(he.fromString(e)),r=n.qa.next();n.Na.set(r,new Ql(t)),n.Oa=n.Oa.insert(t,r),Cm(n.remoteStore,new Ri(ht(yh(t.path)),r,"TargetPurposeLimboResolution",Qg.oe))}}function Bi(n,e,t){return D(this,null,function*(){let r=q(n),i=[],s=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach((u,c)=>{a.push(r.Ka(c,e,t).then(d=>{var p;if((d||t)&&r.isPrimaryClient){let m=d?!d.fromCache:(p=t?.targetChanges.get(c.targetId))===null||p===void 0?void 0:p.current;r.sharedClientState.updateQueryState(c.targetId,m?"current":"not-current")}if(d){i.push(d);let m=Cl.Wi(c.targetId,d);s.push(m)}}))}),yield Promise.all(a),r.Ca.d_(i),yield function(c,d){return D(this,null,function*(){let p=q(c);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",m=>O.forEach(d,w=>O.forEach(w.$i,S=>p.persistence.referenceDelegate.addReference(m,w.targetId,S)).next(()=>O.forEach(w.Ui,S=>p.persistence.referenceDelegate.removeReference(m,w.targetId,S)))))}catch(m){if(!Vi(m))throw m;x("LocalStore","Failed to update sequence numbers: "+m)}for(let m of d){let w=m.targetId;if(!m.fromCache){let S=p.os.get(w),P=S.snapshotVersion,N=S.withLastLimboFreeSnapshotVersion(P);p.os=p.os.insert(w,N)}}})}(r.localStore,s))})}function rT(n,e){return D(this,null,function*(){let t=q(n);if(!t.currentUser.isEqual(e)){x("SyncEngine","User change. New user:",e.toKey());let r=yield Sm(t.localStore,e);t.currentUser=e,function(s,a){s.ka.forEach(u=>{u.forEach(c=>{c.reject(new M(R.CANCELLED,a))})}),s.ka.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Bi(t,r.hs)}})}function iT(n,e){let t=q(n),r=t.Na.get(e);if(r&&r.va)return J().add(r.key);{let i=J(),s=t.Ma.get(e);if(!s)return i;for(let a of s){let u=t.Fa.get(a);i=i.unionWith(u.view.Va)}return i}}function Um(n){let e=q(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=xm.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=iT.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=Z0.bind(null,e),e.Ca.d_=G0.bind(null,e.eventManager),e.Ca.$a=W0.bind(null,e.eventManager),e}function sT(n){let e=q(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=eT.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=tT.bind(null,e),e}var Bg=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){return D(this,null,function*(){this.serializer=Jo(t.databaseInfo.databaseId),this.sharedClientState=this.Wa(t),this.persistence=this.Ga(t),yield this.persistence.start(),this.localStore=this.za(t),this.gcScheduler=this.ja(t,this.localStore),this.indexBackfillerScheduler=this.Ha(t,this.localStore)})}ja(t,r){return null}Ha(t,r){return null}za(t){return A0(this.persistence,new Pl,t.initialUser,this.serializer)}Ga(t){return new Dl(bl.Zr,this.serializer)}Wa(t){return new kl}terminate(){return D(this,null,function*(){var t,r;(t=this.gcScheduler)===null||t===void 0||t.stop(),(r=this.indexBackfillerScheduler)===null||r===void 0||r.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}}return n.provider={build:()=>new n},n})();var oT=(()=>{class n{initialize(t,r){return D(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(r),this.remoteStore=this.createRemoteStore(r),this.eventManager=this.createEventManager(r),this.syncEngine=this.createSyncEngine(r,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>Vg(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=rT.bind(null,this.syncEngine),yield j0(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new ql}()}createDatastore(t){let r=Jo(t.databaseInfo.databaseId),i=function(a){return new Fl(a)}(t.databaseInfo);return function(a,u,c,d){return new Ul(a,u,c,d)}(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return function(i,s,a,u,c){return new $l(i,s,a,u,c)}(this.localStore,this.datastore,t.asyncQueue,r=>Vg(this.syncEngine,r,0),function(){return No.D()?new No:new Ml}())}createSyncEngine(t,r){return function(s,a,u,c,d,p,m){let w=new Yl(s,a,u,c,d,p);return m&&(w.Qa=!0),w}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){return D(this,null,function*(){var t,r;yield function(s){return D(this,null,function*(){let a=q(s);x("RemoteStore","RemoteStore shutting down."),a.L_.add(5),yield Ui(a),a.k_.shutdown(),a.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(r=this.eventManager)===null||r===void 0||r.terminate()})}}return n.provider={build:()=>new n},n})();var Xl=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Ct("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}};var Zl=class{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Ee.UNAUTHENTICATED,this.clientId=vo.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,a=>D(this,null,function*(){x("FirestoreClient","Received user=",a.uid),yield this.authCredentialListener(a),this.user=a})),this.appCheckCredentials.start(r,a=>(x("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new St;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>D(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){let r=Ah(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}};function bc(n,e){return D(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),x("FirestoreClient","Initializing OfflineComponentProvider");let t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(i=>D(this,null,function*(){r.isEqual(i)||(yield Sm(e.localStore,i),r=i)})),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e})}function $g(n,e){return D(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let t=yield aT(n);x("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>xg(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>xg(e.remoteStore,i)),n._onlineComponents=e})}function aT(n){return D(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){x("FirestoreClient","Using user provided OfflineComponentProvider");try{yield bc(n,n._uninitializedComponentsProvider._offline)}catch(e){let t=e;if(!function(i){return i.name==="FirebaseError"?i.code===R.FAILED_PRECONDITION||i.code===R.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;tr("Error using user provided cache. Falling back to memory cache: "+t),yield bc(n,new Bg)}}else x("FirestoreClient","Using default OfflineComponentProvider"),yield bc(n,new Bg);return n._offlineComponents})}function Bm(n){return D(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(x("FirestoreClient","Using user provided OnlineComponentProvider"),yield $g(n,n._uninitializedComponentsProvider._online)):(x("FirestoreClient","Using default OnlineComponentProvider"),yield $g(n,new oT))),n._onlineComponents})}function uT(n){return Bm(n).then(e=>e.syncEngine)}function jg(n){return D(this,null,function*(){let e=yield Bm(n),t=e.eventManager;return t.onListen=H0.bind(null,e.syncEngine),t.onUnlisten=Y0.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=K0.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=J0.bind(null,e.syncEngine),t})}function $m(n){let e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}var zg=new Map;function jm(n,e,t){if(!t)throw new M(R.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function cT(n,e,t,r){if(e===!0&&r===!0)throw new M(R.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function qg(n){if(!B.isDocumentKey(n))throw new M(R.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Gg(n){if(B.isDocumentKey(n))throw new M(R.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function ea(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":$()}function Ti(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new M(R.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let t=ea(n);throw new M(R.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}var Uo=class{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new M(R.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(t=e.ssl)===null||t===void 0||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new M(R.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}cT("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=$m((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new M(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new M(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new M(R.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},hr=class{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Uo({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new M(R.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new M(R.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Uo(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Rc;switch(r.type){case"firstParty":return new kc(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new M(R.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){return D(this,null,function*(){this._terminateTask==="notTerminated"?yield this._terminate():this._terminateTask="notTerminated"})}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){let r=zg.get(t);r&&(x("ComponentProvider","Removing Datastore"),zg.delete(t),r.terminate())}(this),Promise.resolve()}};function zm(n,e,t,r={}){var i;let s=(n=Ti(n,hr))._getSettings(),a=`${e}:${t}`;if(s.host!=="firestore.googleapis.com"&&s.host!==a&&tr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let u,c;if(typeof r.mockUserToken=="string")u=r.mockUserToken,c=Ee.MOCK_USER;else{u=Dp(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);let d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new M(R.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new Ee(d)}n._authCredentials=new Pc(new yo(u,c))}}var Dn=class n{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new n(this.firestore,e,this._query)}},je=class n{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ht(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new n(this.firestore,e,this._key)}},Ht=class n extends Dn{constructor(e,t,r){super(e,t,yh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new je(this.firestore,null,new B(e))}withConverter(e){return new n(this.firestore,e,this._path)}};function qm(n,e,...t){if(n=Te(n),jm("collection","path",e),n instanceof hr){let r=he.fromString(e,...t);return Gg(r),new Ht(n,null,r)}{if(!(n instanceof je||n instanceof Ht))throw new M(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(he.fromString(e,...t));return Gg(r),new Ht(n.firestore,null,r)}}function Gm(n,e,...t){if(n=Te(n),arguments.length===1&&(e=vo.newId()),jm("doc","path",e),n instanceof hr){let r=he.fromString(e,...t);return qg(r),new je(n,null,new B(r))}{if(!(n instanceof je||n instanceof Ht))throw new M(R.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=n._path.child(he.fromString(e,...t));return qg(r),new je(n.firestore,n instanceof Ht?n.converter:null,new B(r))}}var Bo=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Oo(this,"async_queue_retry"),this.Vu=()=>{let r=Sc();r&&x("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;let t=Sc();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;let t=Sc();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});let t=new St;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){return D(this,null,function*(){if(this.Pu.length!==0){try{yield this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Vi(e))throw e;x("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}})}gu(e){let t=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;let i=function(a){let u=a.message||"";return a.stack&&(u=a.stack.includes(a.message)?a.stack:a.message+`
`+a.stack),u}(r);throw Ct("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);let i=jl.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&$()}verifyOperationInProgress(){}wu(){return D(this,null,function*(){let e;do e=this.mu,yield e;while(e!==this.mu)})}Su(e){for(let t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(let t of this.Tu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){let t=this.Tu.indexOf(e);this.Tu.splice(t,1)}};function Wg(n){return function(t,r){if(typeof t!="object"||t===null)return!1;let i=t;for(let s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}var dr=class extends hr{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new Bo,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){return D(this,null,function*(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new Bo(e),this._firestoreClient=void 0,yield e}})}};function Wm(n,e){let t=typeof n=="object"?n:oi(),r=typeof n=="string"?n:e||"(default)",i=Zu(t,"firestore").getImmediate({identifier:r});if(!i._initialized){let s=Tp("firestore");s&&zm(i,...s)}return i}function bh(n){if(n._terminated)throw new M(R.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||lT(n),n._firestoreClient}function lT(n){var e,t,r;let i=n._freezeSettings(),s=function(u,c,d,p){return new Vc(u,c,d,p.host,p.ssl,p.experimentalForceLongPolling,p.experimentalAutoDetectLongPolling,$m(p.experimentalLongPollingOptions),p.useFetchStreams)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Zl(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(u){let c=u?._online.build();return{_offline:u?._offline.build(c),_online:c}}(n._componentsProvider))}var Oi=class n{constructor(e){this._byteString=e}static fromBase64String(e){try{return new n(Oe.fromBase64String(e))}catch(t){throw new M(R.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new n(Oe.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};var fr=class{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new M(R.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new $e(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};var ki=class{constructor(e){this._methodName=e}};var Mi=class{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new M(R.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new M(R.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return te(this._lat,e._lat)||te(this._long,e._long)}};var xi=class{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}};var hT=/^__.*__$/,eh=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new pt(e,this.data,this.fieldMask,t,this.fieldTransforms):new An(e,this.data,t,this.fieldTransforms)}},$o=class{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new pt(e,this.data,this.fieldMask,t,this.fieldTransforms)}};function Hm(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw $()}}var th=class n{constructor(e,t,r,i,s,a){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=a||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new n(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;let r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return zo(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(Hm(this.Cu)&&hT.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},nh=class{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Jo(e)}Qu(e,t,r,i=!1){return new th({Cu:e,methodName:t,qu:r,path:$e.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Km(n){let e=n._freezeSettings(),t=Jo(n._databaseId);return new nh(n._databaseId,!!e.ignoreUndefinedProperties,t)}function dT(n,e,t,r,i,s={}){let a=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);Ch("Data must be an object, but it was:",a,r);let u=Qm(r,a),c,d;if(s.merge)c=new Ye(a.fieldMask),d=a.fieldTransforms;else if(s.mergeFields){let p=[];for(let m of s.mergeFields){let w=rh(e,m,t);if(!a.contains(w))throw new M(R.INVALID_ARGUMENT,`Field '${w}' is specified in your field mask but missing from your input data.`);Jm(p,w)||p.push(w)}c=new Ye(p),d=a.fieldTransforms.filter(m=>c.covers(m.field))}else c=null,d=a.fieldTransforms;return new eh(new Be(u),c,d)}var jo=class n extends ki{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof n}};function fT(n,e,t,r){let i=n.Qu(1,e,t);Ch("Data must be an object, but it was:",i,r);let s=[],a=Be.empty();Sn(r,(c,d)=>{let p=Rh(e,c,t);d=Te(d);let m=i.Nu(p);if(d instanceof jo)s.push(p);else{let w=$i(d,m);w!=null&&(s.push(p),a.set(p,w))}});let u=new Ye(s);return new $o(a,u,i.fieldTransforms)}function pT(n,e,t,r,i,s){let a=n.Qu(1,e,t),u=[rh(e,r,t)],c=[i];if(s.length%2!=0)throw new M(R.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let w=0;w<s.length;w+=2)u.push(rh(e,s[w])),c.push(s[w+1]);let d=[],p=Be.empty();for(let w=u.length-1;w>=0;--w)if(!Jm(d,u[w])){let S=u[w],P=c[w];P=Te(P);let N=a.Nu(S);if(P instanceof jo)d.push(S);else{let C=$i(P,N);C!=null&&(d.push(S),p.set(S,C))}}let m=new Ye(d);return new $o(p,m,a.fieldTransforms)}function gT(n,e,t,r=!1){return $i(t,n.Qu(r?4:3,e))}function $i(n,e){if(Ym(n=Te(n)))return Ch("Unsupported field value:",e,n),Qm(n,e);if(n instanceof ki)return function(r,i){if(!Hm(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);let s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){let s=[],a=0;for(let u of r){let c=$i(u,i.Lu(a));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),a++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Te(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return XI(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){let s=Ae.fromDate(r);return{timestampValue:Co(i.serializer,s)}}if(r instanceof Ae){let s=new Ae(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Co(i.serializer,s)}}if(r instanceof Mi)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Oi)return{bytesValue:_m(i.serializer,r._byteString)};if(r instanceof je){let s=i.databaseId,a=r.firestore._databaseId;if(!a.isEqual(s))throw i.Bu(`Document reference is for database ${a.projectId}/${a.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:_h(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof xi)return function(a,u){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:a.toArray().map(c=>{if(typeof c!="number")throw u.Bu("VectorValues must only contain numeric values.");return vh(u.serializer,c)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${ea(r)}`)}(n,e)}function Qm(n,e){let t={};return Yg(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Sn(n,(r,i)=>{let s=$i(i,e.Mu(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function Ym(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ae||n instanceof Mi||n instanceof Oi||n instanceof je||n instanceof ki||n instanceof xi)}function Ch(n,e,t){if(!Ym(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){let r=ea(t);throw r==="an object"?e.Bu(n+" a custom object"):e.Bu(n+" "+r)}}function rh(n,e,t){if((e=Te(e))instanceof fr)return e._internalPath;if(typeof e=="string")return Rh(n,e);throw zo("Field path arguments must be of type string or ",n,!1,void 0,t)}var mT=new RegExp("[~\\*/\\[\\]]");function Rh(n,e,t){if(e.search(mT)>=0)throw zo(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new fr(...e.split("."))._internalPath}catch{throw zo(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function zo(n,e,t,r,i){let s=r&&!r.isEmpty(),a=i!==void 0,u=`Function ${e}() called with invalid data`;t&&(u+=" (via `toFirestore()`)"),u+=". ";let c="";return(s||a)&&(c+=" (found",s&&(c+=` in field ${r}`),a&&(c+=` in document ${i}`),c+=")"),new M(R.INVALID_ARGUMENT,u+n+c)}function Jm(n,e){return n.some(t=>t.isEqual(e))}var qo=class{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new je(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let e=new ih(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(Ph("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}},ih=class extends qo{data(){return super.data()}};function Ph(n,e){return typeof e=="string"?Rh(n,e):e instanceof fr?e._internalPath:e._delegate._internalPath}function yT(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new M(R.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Fi=class{},Go=class extends Fi{};function Xm(n,e,...t){let r=[];e instanceof Fi&&r.push(e),r=r.concat(t),function(s){let a=s.filter(c=>c instanceof oh).length,u=s.filter(c=>c instanceof sh).length;if(a>1||a>0&&u>0)throw new M(R.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(let i of r)n=i._apply(n);return n}var sh=class n extends Go{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new n(e,t,r)}_apply(e){let t=this._parse(e);return ey(e._query,t),new Dn(e.firestore,e.converter,Jc(e._query,t))}_parse(e){let t=Km(e.firestore);return function(s,a,u,c,d,p,m){let w;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new M(R.INVALID_ARGUMENT,`Invalid Query. You can't perform '${p}' queries on documentId().`);if(p==="in"||p==="not-in"){Kg(m,p);let S=[];for(let P of m)S.push(Hg(c,s,P));w={arrayValue:{values:S}}}else w=Hg(c,s,m)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||Kg(m,p),w=gT(u,a,m,p==="in"||p==="not-in");return ye.create(d,p,w)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}};var oh=class n extends Fi{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new n(e,t)}_parse(e){let t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:rt.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let a=i,u=s.getFlattenedFilters();for(let c of u)ey(a,c),a=Jc(a,c)}(e._query,t),new Dn(e.firestore,e.converter,Jc(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var ah=class n extends Go{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new n(e,t)}_apply(e){let t=function(i,s,a){if(i.startAt!==null)throw new M(R.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new M(R.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new En(s,a)}(e._query,this._field,this._direction);return new Dn(e.firestore,e.converter,function(i,s){let a=i.explicitOrderBy.concat([s]);return new Qt(i.path,i.collectionGroup,a,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}};function Zm(n,e="asc"){let t=e,r=Ph("orderBy",n);return ah._create(r,t)}function Hg(n,e,t){if(typeof(t=Te(t))=="string"){if(t==="")throw new M(R.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!sm(e)&&t.indexOf("/")!==-1)throw new M(R.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);let r=e.path.child(he.fromString(t));if(!B.isDocumentKey(r))throw new M(R.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return yg(n,new B(r))}if(t instanceof je)return yg(n,t._key);throw new M(R.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${ea(t)}.`)}function Kg(n,e){if(!Array.isArray(n)||n.length===0)throw new M(R.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function ey(n,e){let t=function(i,s){for(let a of i)for(let u of a.getFlattenedFilters())if(s.indexOf(u.op)>=0)return u.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new M(R.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new M(R.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}var uh=class{convertValue(e,t="none"){switch(wn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ce(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Kt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw $()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let r={};return Sn(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;let s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(a=>ce(a.doubleValue));return new xi(s)}convertGeoPoint(e){return new Mi(ce(e.latitude),ce(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":let r=fh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Di(e));default:return null}}convertTimestamp(e){let t=Rt(e);return new Ae(t.seconds,t.nanos)}convertDocumentKey(e,t){let r=he.fromString(e);se(Dm(r));let i=new Io(r.get(1),r.get(3)),s=new B(r.popFirst(5));return i.isEqual(t)||Ct(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}};function vT(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}var yn=class{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},Wo=class extends qo{constructor(e,t,r,i,s,a){super(e,t,r,i,a),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new er(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let r=this._document.data.field(Ph("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}},er=class extends Wo{data(e={}){return super.data(e)}},ch=class{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new yn(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new er(this._firestore,this._userDataWriter,r.key,r,new yn(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new M(R.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let a=0;return i._snapshot.docChanges.map(u=>{let c=new er(i._firestore,i._userDataWriter,u.doc.key,u.doc,new yn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter);return u.doc,{type:"added",doc:c,oldIndex:-1,newIndex:a++}})}{let a=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(u=>s||u.type!==3).map(u=>{let c=new er(i._firestore,i._userDataWriter,u.doc.key,u.doc,new yn(i._snapshot.mutatedKeys.has(u.doc.key),i._snapshot.fromCache),i.query.converter),d=-1,p=-1;return u.type!==0&&(d=a.indexOf(u.doc.key),a=a.delete(u.doc.key)),u.type!==1&&(a=a.add(u.doc),p=a.indexOf(u.doc.key)),{type:_T(u.type),doc:c,oldIndex:d,newIndex:p}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}};function _T(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return $()}}var Ho=class extends uh{constructor(e){super(),this.firestore=e}convertBytes(e){return new Oi(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new je(this.firestore,null,t)}};function Nh(n,...e){var t,r,i;n=Te(n);let s={includeMetadataChanges:!1,source:"default"},a=0;typeof e[a]!="object"||Wg(e[a])||(s=e[a],a++);let u={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(Wg(e[a])){let m=e[a];e[a]=(t=m.next)===null||t===void 0?void 0:t.bind(m),e[a+1]=(r=m.error)===null||r===void 0?void 0:r.bind(m),e[a+2]=(i=m.complete)===null||i===void 0?void 0:i.bind(m)}let c,d,p;if(n instanceof je)d=Ti(n.firestore,dr),p=yh(n._key.path),c={next:m=>{e[a]&&e[a](ET(d,n,m))},error:e[a+1],complete:e[a+2]};else{let m=Ti(n,Dn);d=Ti(m.firestore,dr),p=m._query;let w=new Ho(d);c={next:S=>{e[a]&&e[a](new ch(d,w,m,S))},error:e[a+1],complete:e[a+2]},yT(n._query)}return function(w,S,P,N){let C=new Xl(N),U=new Wl(S,C,P);return w.asyncQueue.enqueueAndForget(()=>D(this,null,function*(){return z0(yield jg(w),U)})),()=>{C.Za(),w.asyncQueue.enqueueAndForget(()=>D(this,null,function*(){return q0(yield jg(w),U)}))}}(bh(d),p,u,c)}function wT(n,e){return function(r,i){let s=new St;return r.asyncQueue.enqueueAndForget(()=>D(this,null,function*(){return X0(yield uT(r),i,s)})),s.promise}(bh(n),e)}function ET(n,e,t){let r=t.docs.get(e._key),i=new Ho(n);return new Wo(n,i,e._key,r,new yn(t.hasPendingWrites,t.fromCache),e.converter)}var lh=class{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Km(e)}set(e,t,r){this._verifyNotCommitted();let i=Cc(e,this._firestore),s=vT(i.converter,t,r),a=dT(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(a.toMutation(i._key,bt.none())),this}update(e,t,r,...i){this._verifyNotCommitted();let s=Cc(e,this._firestore),a;return a=typeof(t=Te(t))=="string"||t instanceof fr?pT(this._dataReader,"WriteBatch.update",s._key,t,r,i):fT(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,bt.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=Cc(e,this._firestore);return this._mutations=this._mutations.concat(new bi(t._key,bt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new M(R.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Cc(n,e){if((n=Te(n)).firestore!==e)throw new M(R.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function ty(n){return bh(n=Ti(n,dr)),new lh(n,e=>wT(n,e))}(function(e,t=!0){(function(i){pr=i})(Gn),qt(new Qe("firestore",(r,{instanceIdentifier:i,options:s})=>{let a=r.getProvider("app").getImmediate(),u=new dr(new Nc(r.getProvider("auth-internal")),new xc(r.getProvider("app-check-internal")),function(d,p){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new M(R.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Io(d.options.projectId,p)}(a,i),a);return s=Object.assign({useFetchStreams:t},s),u._setSettings(s),u},"PUBLIC").setMultipleInstances(!0)),we(fg,"4.7.3",e),we(fg,"4.7.3","esm2017")})();var ta=function(){return ta=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},ta.apply(this,arguments)};var AT={includeMetadataChanges:!1};function ny(n,e){return e===void 0&&(e=AT),new Lt(function(t){var r=Nh(n,e,{next:t.next.bind(t),error:t.error.bind(t),complete:t.complete.bind(t)});return{unsubscribe:r}})}function ry(n,e){var t;e===void 0&&(e={});var r=n.data(e);return!n.exists()||typeof r!="object"||r===null||!e.idField?r:ta(ta({},r),(t={},t[e.idField]=n.id,t))}function iy(n){return ny(n,{includeMetadataChanges:!0}).pipe(K(function(e){return e.docs}))}function sy(n,e){return e===void 0&&(e={}),iy(n).pipe(K(function(t){return t.map(function(r){return ry(r,e)})}))}var Cn=class{constructor(e){return e}},oy="firestore",Oh=class{constructor(){return ui(oy)}};var kh=new ae("angularfire2.firestore-instances");function DT(n,e){let t=nc(oy,n,e);return t&&new Cn(t)}function ST(n){return(e,t)=>{let r=e.runOutsideAngular(()=>n(t));return new Cn(r)}}var bT={provide:Oh,deps:[[new ot,kh]]},CT={provide:Cn,useFactory:DT,deps:[[new ot,kh],dn]};function MP(n,...e){return we("angularfire",Hn.full,"fst"),Et([CT,bT,{provide:kh,useFactory:ST(n),multi:!0,deps:[xe,on,ci,li,[new ot,co],[new ot,ai],...e]}])}var Mh=tt(sy,!0);var xh=tt(qm,!0);var Fh=tt(Gm,!0);var xP=tt(Wm,!0);var ay=tt(Zm,!0);var Lh=tt(Xm,!0);var Vh=tt(ty,!0);var na=class n{firestore=F(Cn);http=F(Au);catsDataUrl="https://conseil.latelier.co/data/cats.json";catsCollection=xh(this.firestore,"cats");appearancesCollection=xh(this.firestore,"cat_appearances");fetchCatsData$(){return this.http.get(this.catsDataUrl).pipe(K(e=>e.images),st(()=>_t(()=>"An error occurred while fetching cats data from the remote source.")))}fetchPersistedCats$(){let e=Lh(this.catsCollection);return Mh(e).pipe(Ze(t=>!!t),st(()=>_t(()=>new Error("An error occurred while fetching persisted cats."))))}fetchCatAppearances$(){let e=Lh(this.appearancesCollection,ay("appearedAt","desc"));return Mh(e).pipe(Ze(t=>!!t),st(()=>_t(()=>new Error("An error occurred while fetching cat last appearances."))))}fetchCats$(){return As([this.fetchCatsData$(),this.fetchPersistedCats$()]).pipe(K(([e,t])=>this.mergeCats(e,t)))}mergeCats(e,t){return e.map(r=>{let i=t.find(s=>s.id===r.id);return i||{id:r.id,imageUrl:r.url,score:0,appearances:0}})}updateCats(e){return D(this,null,function*(){let t=Vh(this.firestore);e.forEach(r=>{let i=Fh(this.catsCollection,r.id);t.set(i,r)}),yield t.commit()})}updateCatAppearances(e){return D(this,null,function*(){let t=Vh(this.firestore);e.forEach(r=>{let i=Fh(this.appearancesCollection,r.catId);t.set(i,r)}),yield t.commit()})}static \u0275fac=function(t){return new(t||n)};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})};var uy=class n{MAX_RECENT_HISTORY=8;catStorage=F(na);getCatRanking$(){return this.catStorage.fetchCats$().pipe(K(e=>e.sort((t,r)=>r.score===t.score?t.appearances-r.appearances:r.score-t.score)))}selectCatOpponents$(){return As([this.catStorage.fetchCats$(),this.catStorage.fetchCatAppearances$()]).pipe(K(([e,t])=>this.selectCatOpponents(e,t)))}selectCatOpponents(e,t){let r=this.getUnseenCats(e,t),i=this.getLeastAppeared(r);if(i.length<2){let s=r[Math.floor(Math.random()*r.length)];return[i[0],s]}return i.sort(()=>Math.random()-.5),[i[0],i[1]]}getUnseenCats(e,t){let r=t.slice(0,this.MAX_RECENT_HISTORY);return e.filter(i=>!r.some(s=>s.catId===i.id))}getLeastAppeared(e){let t=Math.min(...e.map(r=>r.appearances));return e.filter(r=>r.appearances===t)}recordVote(r){return D(this,arguments,function*({winner:e,loser:t}){try{e.score+=1,e.appearances+=1,t.appearances+=1,yield this.catStorage.updateCats([e,t]);let i=[{catId:e.id,appearedAt:new Date().toISOString()},{catId:t.id,appearedAt:new Date().toISOString()}];yield this.catStorage.updateCatAppearances(i),this.countPlayedMatches()}catch(i){throw console.error("Error recording vote:",i),new Error("Failed to register the vote. Please try again later.")}})}getPlayedMatches(){let e=localStorage.getItem("playedMatches");return Number(e??"0")}countPlayedMatches(){let e=localStorage.getItem("playedMatches");e||localStorage.setItem("playedMatches","0");let t=parseInt(e??"0",10)+1;localStorage.setItem("playedMatches",t.toString())}static \u0275fac=function(t){return new(t||n)};static \u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})};var H="primary",is=Symbol("RouteTitle"),zh=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Er(n){return new zh(n)}function RT(n,e,t){let r=t.path.split("/");if(r.length>n.length||t.pathMatch==="full"&&(e.hasChildren()||r.length<n.length))return null;let i={};for(let s=0;s<r.length;s++){let a=r[s],u=n[s];if(a[0]===":")i[a.substring(1)]=u;else if(a!==u.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function PT(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!gt(n[t],e[t]))return!1;return!0}function gt(n,e){let t=n?qh(n):void 0,r=e?qh(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!my(n[i],e[i]))return!1;return!0}function qh(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function my(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;let t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}else return n===e}function yy(n){return n.length>0?n[n.length-1]:null}function Xt(n){return Cf(n)?n:fu(n)?Fe(Promise.resolve(n)):z(n)}var NT={exact:_y,subset:wy},vy={exact:OT,subset:kT,ignored:()=>!0};function cy(n,e,t){return NT[t.paths](n.root,e.root,t.matrixParams)&&vy[t.queryParams](n.queryParams,e.queryParams)&&!(t.fragment==="exact"&&n.fragment!==e.fragment)}function OT(n,e){return gt(n,e)}function _y(n,e,t){if(!Pn(n.segments,e.segments)||!sa(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(let r in e.children)if(!n.children[r]||!_y(n.children[r],e.children[r],t))return!1;return!0}function kT(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>my(n[t],e[t]))}function wy(n,e,t){return Ey(n,e,e.segments,t)}function Ey(n,e,t,r){if(n.segments.length>t.length){let i=n.segments.slice(0,t.length);return!(!Pn(i,t)||e.hasChildren()||!sa(i,t,r))}else if(n.segments.length===t.length){if(!Pn(n.segments,t)||!sa(n.segments,t,r))return!1;for(let i in e.children)if(!n.children[i]||!wy(n.children[i],e.children[i],r))return!1;return!0}else{let i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!Pn(n.segments,i)||!sa(n.segments,i,r)||!n.children[H]?!1:Ey(n.children[H],e,s,r)}}function sa(n,e,t){return e.every((r,i)=>vy[t](n[i].parameters,r.parameters))}var Ot=class{constructor(e=new ie([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=Er(this.queryParams),this._queryParamMap}toString(){return FT.serialize(this)}},ie=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return oa(this)}},Rn=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Er(this.parameters),this._parameterMap}toString(){return Ty(this)}};function MT(n,e){return Pn(n,e)&&n.every((t,r)=>gt(t.parameters,e[r].parameters))}function Pn(n,e){return n.length!==e.length?!1:n.every((t,r)=>t.path===e[r].path)}function xT(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===H&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==H&&(t=t.concat(e(i,r)))}),t}var md=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>new Ki,providedIn:"root"})}}return n})(),Ki=class{parse(e){let t=new Wh(e);return new Ot(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${ji(e.root,!0)}`,r=UT(e.queryParams),i=typeof e.fragment=="string"?`#${LT(e.fragment)}`:"";return`${t}${r}${i}`}},FT=new Ki;function oa(n){return n.segments.map(e=>Ty(e)).join("/")}function ji(n,e){if(!n.hasChildren())return oa(n);if(e){let t=n.children[H]?ji(n.children[H],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==H&&r.push(`${i}:${ji(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=xT(n,(r,i)=>i===H?[ji(n.children[H],!1)]:[`${i}:${ji(r,!1)}`]);return Object.keys(n.children).length===1&&n.children[H]!=null?`${oa(n)}/${t[0]}`:`${oa(n)}/(${t.join("//")})`}}function Iy(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function ra(n){return Iy(n).replace(/%3B/gi,";")}function LT(n){return encodeURI(n)}function Gh(n){return Iy(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function aa(n){return decodeURIComponent(n)}function ly(n){return aa(n.replace(/\+/g,"%20"))}function Ty(n){return`${Gh(n.path)}${VT(n.parameters)}`}function VT(n){return Object.entries(n).map(([e,t])=>`;${Gh(e)}=${Gh(t)}`).join("")}function UT(n){let e=Object.entries(n).map(([t,r])=>Array.isArray(r)?r.map(i=>`${ra(t)}=${ra(i)}`).join("&"):`${ra(t)}=${ra(r)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var BT=/^[^\/()?;#]+/;function Uh(n){let e=n.match(BT);return e?e[0]:""}var $T=/^[^\/()?;=#]+/;function jT(n){let e=n.match($T);return e?e[0]:""}var zT=/^[^=?&#]+/;function qT(n){let e=n.match(zT);return e?e[0]:""}var GT=/^[^&#]+/;function WT(n){let e=n.match(GT);return e?e[0]:""}var Wh=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new ie([],{}):new ie([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[H]=new ie(e,t)),r}parseSegment(){let e=Uh(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new fe(4009,!1);return this.capture(e),new Rn(aa(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=jT(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=Uh(this.remaining);i&&(r=i,this.capture(r))}e[aa(t)]=aa(r)}parseQueryParam(e){let t=qT(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let a=WT(this.remaining);a&&(r=a,this.capture(r))}let i=ly(t),s=ly(r);if(e.hasOwnProperty(i)){let a=e[i];Array.isArray(a)||(a=[a],e[i]=a),a.push(s)}else e[i]=s}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=Uh(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new fe(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=H);let a=this.parseChildren();t[s]=Object.keys(a).length===1?a[H]:new ie([],a),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new fe(4011,!1)}};function Ay(n){return n.segments.length>0?new ie([],{[H]:n}):n}function Dy(n){let e={};for(let[r,i]of Object.entries(n.children)){let s=Dy(i);if(r===H&&s.segments.length===0&&s.hasChildren())for(let[a,u]of Object.entries(s.children))e[a]=u;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}let t=new ie(n.segments,e);return HT(t)}function HT(n){if(n.numberOfChildren===1&&n.children[H]){let e=n.children[H];return new ie(n.segments.concat(e.segments),e.children)}return n}function Qi(n){return n instanceof Ot}function KT(n,e,t=null,r=null){let i=Sy(n);return by(i,e,t,r)}function Sy(n){let e;function t(s){let a={};for(let c of s.children){let d=t(c);a[c.outlet]=d}let u=new ie(s.url,a);return s===n&&(e=u),u}let r=t(n.root),i=Ay(r);return e??i}function by(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(e.length===0)return Bh(i,i,i,t,r);let s=QT(e);if(s.toRoot())return Bh(i,i,new ie([],{}),t,r);let a=YT(s,i,n),u=a.processChildren?Gi(a.segmentGroup,a.index,s.commands):Ry(a.segmentGroup,a.index,s.commands);return Bh(i,a.segmentGroup,u,t,r)}function ua(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function Yi(n){return typeof n=="object"&&n!=null&&n.outlets}function Bh(n,e,t,r,i){let s={};r&&Object.entries(r).forEach(([c,d])=>{s[c]=Array.isArray(d)?d.map(p=>`${p}`):`${d}`});let a;n===e?a=t:a=Cy(n,e,t);let u=Ay(Dy(a));return new Ot(u,s,i)}function Cy(n,e,t){let r={};return Object.entries(n.children).forEach(([i,s])=>{s===e?r[i]=t:r[i]=Cy(s,e,t)}),new ie(n.segments,r)}var ca=class{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&ua(r[0]))throw new fe(4003,!1);let i=r.find(Yi);if(i&&i!==yy(r))throw new fe(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function QT(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new ca(!0,0,n);let e=0,t=!1,r=n.reduce((i,s,a)=>{if(typeof s=="object"&&s!=null){if(s.outlets){let u={};return Object.entries(s.outlets).forEach(([c,d])=>{u[c]=typeof d=="string"?d.split("/"):d}),[...i,{outlets:u}]}if(s.segmentPath)return[...i,s.segmentPath]}return typeof s!="string"?[...i,s]:a===0?(s.split("/").forEach((u,c)=>{c==0&&u==="."||(c==0&&u===""?t=!0:u===".."?e++:u!=""&&i.push(u))}),i):[...i,s]},[]);return new ca(t,e,r)}var vr=class{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}};function YT(n,e,t){if(n.isAbsolute)return new vr(e,!0,0);if(!t)return new vr(e,!1,NaN);if(t.parent===null)return new vr(t,!0,0);let r=ua(n.commands[0])?0:1,i=t.segments.length-1+r;return JT(t,i,n.numberOfDoubleDots)}function JT(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new fe(4005,!1);i=r.segments.length}return new vr(r,!1,i-s)}function XT(n){return Yi(n[0])?n[0].outlets:{[H]:n}}function Ry(n,e,t){if(n??=new ie([],{}),n.segments.length===0&&n.hasChildren())return Gi(n,e,t);let r=ZT(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){let s=new ie(n.segments.slice(0,r.pathIndex),{});return s.children[H]=new ie(n.segments.slice(r.pathIndex),n.children),Gi(s,0,i)}else return r.match&&i.length===0?new ie(n.segments,{}):r.match&&!n.hasChildren()?Hh(n,e,t):r.match?Gi(n,0,i):Hh(n,e,t)}function Gi(n,e,t){if(t.length===0)return new ie(n.segments,{});{let r=XT(t),i={};if(Object.keys(r).some(s=>s!==H)&&n.children[H]&&n.numberOfChildren===1&&n.children[H].segments.length===0){let s=Gi(n.children[H],e,t);return new ie(n.segments,s.children)}return Object.entries(r).forEach(([s,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(i[s]=Ry(n.children[s],e,a))}),Object.entries(n.children).forEach(([s,a])=>{r[s]===void 0&&(i[s]=a)}),new ie(n.segments,i)}}function ZT(n,e,t){let r=0,i=e,s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;let a=n.segments[i],u=t[r];if(Yi(u))break;let c=`${u}`,d=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&d&&typeof d=="object"&&d.outlets===void 0){if(!dy(c,d,a))return s;r+=2}else{if(!dy(c,{},a))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Hh(n,e,t){let r=n.segments.slice(0,e),i=0;for(;i<t.length;){let s=t[i];if(Yi(s)){let c=eA(s.outlets);return new ie(r,c)}if(i===0&&ua(t[0])){let c=n.segments[e];r.push(new Rn(c.path,hy(t[0]))),i++;continue}let a=Yi(s)?s.outlets[H]:`${s}`,u=i<t.length-1?t[i+1]:null;a&&u&&ua(u)?(r.push(new Rn(a,hy(u))),i+=2):(r.push(new Rn(a,{})),i++)}return new ie(r,{})}function eA(n){let e={};return Object.entries(n).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(e[t]=Hh(new ie([],{}),0,r))}),e}function hy(n){let e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function dy(n,e,t){return n==t.path&&gt(e,t.parameters)}var Wi="imperative",De=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(De||{}),Je=class{constructor(e,t){this.id=e,this.url=t}},Ji=class extends Je{constructor(e,t,r="imperative",i=null){super(e,t),this.type=De.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Nn=class extends Je{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=De.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},qe=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(qe||{}),Kh=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Kh||{}),Nt=class extends Je{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=De.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},On=class extends Je{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=De.NavigationSkipped}},Xi=class extends Je{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=De.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},la=class extends Je{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=De.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Qh=class extends Je{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=De.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Yh=class extends Je{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=De.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Jh=class extends Je{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=De.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Xh=class extends Je{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=De.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Zh=class{constructor(e){this.route=e,this.type=De.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},ed=class{constructor(e){this.route=e,this.type=De.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},td=class{constructor(e){this.snapshot=e,this.type=De.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},nd=class{constructor(e){this.snapshot=e,this.type=De.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},rd=class{constructor(e){this.snapshot=e,this.type=De.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},id=class{constructor(e){this.snapshot=e,this.type=De.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Zi=class{},Ir=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function tA(n,e){return n.providers&&!n._injector&&(n._injector=$f(n.providers,e,`Route: ${n.path}`)),n._injector??e}function it(n){return n.outlet||H}function nA(n,e){let t=n.filter(r=>it(r)===e);return t.push(...n.filter(r=>it(r)!==e)),t}function ss(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var sd=class{get injector(){return ss(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new ya(this.rootInjector),this.attachRef=null}},ya=(()=>{class n{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new sd(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||n)(Q(Un))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),ha=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=od(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){let t=od(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=ad(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return ad(e,this._root).map(t=>t.value)}};function od(n,e){if(n===e.value)return e;for(let t of e.children){let r=od(n,t);if(r)return r}return null}function ad(n,e){if(n===e.value)return[e];for(let t of e.children){let r=ad(n,t);if(r.length)return r.unshift(e),r}return[]}var ze=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function yr(n){let e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}var da=class extends ha{constructor(e,t){super(e),this.snapshot=t,yd(this,e)}toString(){return this.snapshot.toString()}};function Py(n){let e=rA(n),t=new Ge([new Rn("",{})]),r=new Ge({}),i=new Ge({}),s=new Ge({}),a=new Ge(""),u=new Tr(t,r,s,a,i,H,n,e.root);return u.snapshot=e.root,new da(new ze(u,[]),e)}function rA(n){let e={},t={},r={},i="",s=new _r([],e,r,i,t,H,n,null,{});return new pa("",new ze(s,[]))}var Tr=class{constructor(e,t,r,i,s,a,u,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=a,this.component=u,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(K(d=>d[is]))??z(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(K(e=>Er(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(K(e=>Er(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function fa(n,e,t="emptyOnly"){let r,{routeConfig:i}=n;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?r={params:V(V({},e.params),n.params),data:V(V({},e.data),n.data),resolve:V(V(V(V({},n.data),e.data),i?.data),n._resolvedData)}:r={params:V({},n.params),data:V({},n.data),resolve:V(V({},n.data),n._resolvedData??{})},i&&Oy(i)&&(r.resolve[is]=i.title),r}var _r=class{get title(){return this.data?.[is]}constructor(e,t,r,i,s,a,u,c,d){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=a,this.component=u,this.routeConfig=c,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Er(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Er(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},pa=class extends ha{constructor(e,t){super(t),this.url=e,yd(this,t)}toString(){return Ny(this._root)}};function yd(n,e){e.value._routerState=n,e.children.forEach(t=>yd(n,t))}function Ny(n){let e=n.children.length>0?` { ${n.children.map(Ny).join(", ")} } `:"";return`${n.value}${e}`}function $h(n){if(n.snapshot){let e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,gt(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),gt(e.params,t.params)||n.paramsSubject.next(t.params),PT(e.url,t.url)||n.urlSubject.next(t.url),gt(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function ud(n,e){let t=gt(n.params,e.params)&&MT(n.url,e.url),r=!n.parent!=!e.parent;return t&&!r&&(!n.parent||ud(n.parent,e.parent))}function Oy(n){return typeof n.title=="string"||n.title===null}var iA=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=H,this.activateEvents=new an,this.deactivateEvents=new an,this.attachEvents=new an,this.detachEvents=new an,this.parentContexts=F(ya),this.location=F(lu),this.changeDetector=F(Kr),this.inputBinder=F(vd,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new fe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new fe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new fe(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new fe(4013,!1);this._activatedRoute=t;let i=this.location,a=t.snapshot.component,u=this.parentContexts.getOrCreateContext(this.name).children,c=new cd(t,u,i.injector);this.activated=i.createComponent(a,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=Ss({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[iu]})}}return n})(),cd=class n{__ngOutletInjector(e){return new n(this.route,this.childContexts,e)}constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Tr?this.route:e===ya?this.childContexts:this.parent.get(e,t)}},vd=new ae("");function sA(n,e,t){let r=es(n,e._root,t?t._root:void 0);return new da(r,e)}function es(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=e.value;let i=oA(n,e,t);return new ze(r,i)}else{if(n.shouldAttach(e.value)){let s=n.retrieve(e.value);if(s!==null){let a=s.route;return a.value._futureSnapshot=e.value,a.children=e.children.map(u=>es(n,u)),a}}let r=aA(e.value),i=e.children.map(s=>es(n,s));return new ze(r,i)}}function oA(n,e,t){return e.children.map(r=>{for(let i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return es(n,r,i);return es(n,r)})}function aA(n){return new Tr(new Ge(n.url),new Ge(n.params),new Ge(n.queryParams),new Ge(n.fragment),new Ge(n.data),n.outlet,n.component,n)}var ts=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},ky="ngNavigationCancelingError";function ga(n,e){let{redirectTo:t,navigationBehaviorOptions:r}=Qi(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=My(!1,qe.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function My(n,e){let t=new Error(`NavigationCancelingError: ${n||""}`);return t[ky]=!0,t.cancellationCode=e,t}function uA(n){return xy(n)&&Qi(n.url)}function xy(n){return!!n&&n[ky]}var cA=(n,e,t,r)=>K(i=>(new ld(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)),ld=class{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),$h(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){let i=yr(t);e.children.forEach(s=>{let a=s.value.outlet;this.deactivateRoutes(s,i[a],r),delete i[a]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if(i===s)if(i.component){let a=r.getContext(i.outlet);a&&this.deactivateChildRoutes(e,t,a.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=yr(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);if(r&&r.outlet){let a=r.outlet.detach(),u=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:a,route:e,contexts:u})}}deactivateRouteAndOutlet(e,t){let r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=yr(e);for(let a of Object.values(s))this.deactivateRouteAndItsChildren(a,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){let i=yr(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new id(s.value.snapshot))}),e.children.length&&this.forwardEvent(new nd(e.value.snapshot))}activateRoutes(e,t,r){let i=e.value,s=t?t.value:null;if($h(i),i===s)if(i.component){let a=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,a.children)}else this.activateChildRoutes(e,t,r);else if(i.component){let a=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let u=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),a.children.onOutletReAttached(u.contexts),a.attachRef=u.componentRef,a.route=u.route.value,a.outlet&&a.outlet.attach(u.componentRef,u.route.value),$h(u.route.value),this.activateChildRoutes(e,null,a.children)}else a.attachRef=null,a.route=i,a.outlet&&a.outlet.activateWith(i,a.injector),this.activateChildRoutes(e,null,a.children)}else this.activateChildRoutes(e,null,r)}},ma=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},wr=class{constructor(e,t){this.component=e,this.route=t}};function lA(n,e,t){let r=n._root,i=e?e._root:null;return zi(r,i,t,[r.value])}function hA(n){let e=n.routeConfig?n.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:n,guards:e}}function Dr(n,e){let t=Symbol(),r=e.get(n,t);return r===t?typeof n=="function"&&!Mf(n)?n:e.get(n):r}function zi(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=yr(e);return n.children.forEach(a=>{dA(a,s[a.value.outlet],t,r.concat([a.value]),i),delete s[a.value.outlet]}),Object.entries(s).forEach(([a,u])=>Hi(u,t.getContext(a),i)),i}function dA(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let s=n.value,a=e?e.value:null,u=t?t.getContext(n.value.outlet):null;if(a&&s.routeConfig===a.routeConfig){let c=fA(a,s,s.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new ma(r)):(s.data=a.data,s._resolvedData=a._resolvedData),s.component?zi(n,e,u?u.children:null,r,i):zi(n,e,t,r,i),c&&u&&u.outlet&&u.outlet.isActivated&&i.canDeactivateChecks.push(new wr(u.outlet.component,a))}else a&&Hi(e,u,i),i.canActivateChecks.push(new ma(r)),s.component?zi(n,null,u?u.children:null,r,i):zi(n,null,t,r,i);return i}function fA(n,e,t){if(typeof t=="function")return t(n,e);switch(t){case"pathParamsChange":return!Pn(n.url,e.url);case"pathParamsOrQueryParamsChange":return!Pn(n.url,e.url)||!gt(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!ud(n,e)||!gt(n.queryParams,e.queryParams);case"paramsChange":default:return!ud(n,e)}}function Hi(n,e,t){let r=yr(n),i=n.value;Object.entries(r).forEach(([s,a])=>{i.component?e?Hi(a,e.children.getContext(s),t):Hi(a,null,t):Hi(a,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new wr(e.outlet.component,i)):t.canDeactivateChecks.push(new wr(null,i)):t.canDeactivateChecks.push(new wr(null,i))}function os(n){return typeof n=="function"}function pA(n){return typeof n=="boolean"}function gA(n){return n&&os(n.canLoad)}function mA(n){return n&&os(n.canActivate)}function yA(n){return n&&os(n.canActivateChild)}function vA(n){return n&&os(n.canDeactivate)}function _A(n){return n&&os(n.canMatch)}function Fy(n){return n instanceof Rf||n?.name==="EmptyError"}var ia=Symbol("INITIAL_VALUE");function Ar(){return He(n=>Ja(n.map(e=>e.pipe(Ln(1),nu(ia)))).pipe(K(e=>{for(let t of e)if(t!==!0){if(t===ia)return ia;if(t===!1||wA(t))return t}return!0}),wt(e=>e!==ia),Ln(1)))}function wA(n){return Qi(n)||n instanceof ts}function EA(n,e){return We(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:a}}=t;return a.length===0&&s.length===0?z(_e(V({},t),{guardsResult:!0})):IA(a,r,i,n).pipe(We(u=>u&&pA(u)?TA(r,s,n,e):z(u)),K(u=>_e(V({},t),{guardsResult:u})))})}function IA(n,e,t,r){return Fe(n).pipe(We(i=>CA(i.component,i.route,t,e,r)),Ze(i=>i!==!0,!0))}function TA(n,e,t,r){return Fe(e).pipe(sn(i=>Pf(DA(i.route.parent,r),AA(i.route,r),bA(n,i.path,t),SA(n,i.route,t))),Ze(i=>i!==!0,!0))}function AA(n,e){return n!==null&&e&&e(new rd(n)),z(!0)}function DA(n,e){return n!==null&&e&&e(new td(n)),z(!0)}function SA(n,e,t){let r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||r.length===0)return z(!0);let i=r.map(s=>Xa(()=>{let a=ss(e)??t,u=Dr(s,a),c=mA(u)?u.canActivate(e,n):et(a,()=>u(e,n));return Xt(c).pipe(Ze())}));return z(i).pipe(Ar())}function bA(n,e,t){let r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(a=>hA(a)).filter(a=>a!==null).map(a=>Xa(()=>{let u=a.guards.map(c=>{let d=ss(a.node)??t,p=Dr(c,d),m=yA(p)?p.canActivateChild(r,n):et(d,()=>p(r,n));return Xt(m).pipe(Ze())});return z(u).pipe(Ar())}));return z(s).pipe(Ar())}function CA(n,e,t,r,i){let s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!s||s.length===0)return z(!0);let a=s.map(u=>{let c=ss(e)??i,d=Dr(u,c),p=vA(d)?d.canDeactivate(n,e,t,r):et(c,()=>d(n,e,t,r));return Xt(p).pipe(Ze())});return z(a).pipe(Ar())}function RA(n,e,t,r){let i=e.canLoad;if(i===void 0||i.length===0)return z(!0);let s=i.map(a=>{let u=Dr(a,n),c=gA(u)?u.canLoad(e,t):et(n,()=>u(e,t));return Xt(c)});return z(s).pipe(Ar(),Ly(r))}function Ly(n){return Ga(ve(e=>{if(typeof e!="boolean")throw ga(n,e)}),K(e=>e===!0))}function PA(n,e,t,r){let i=e.canMatch;if(!i||i.length===0)return z(!0);let s=i.map(a=>{let u=Dr(a,n),c=_A(u)?u.canMatch(e,t):et(n,()=>u(e,t));return Xt(c)});return z(s).pipe(Ar(),Ly(r))}var ns=class{constructor(e){this.segmentGroup=e||null}},rs=class extends Error{constructor(e){super(),this.urlTree=e}};function mr(n){return _t(new ns(n))}function NA(n){return _t(new fe(4e3,!1))}function OA(n){return _t(My(!1,qe.GuardRejected))}var hd=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return z(r);if(i.numberOfChildren>1||!i.children[H])return NA(`${e.redirectTo}`);i=i.children[H]}}applyRedirectCommands(e,t,r,i,s){if(typeof t!="string"){let u=t,{queryParams:c,fragment:d,routeConfig:p,url:m,outlet:w,params:S,data:P,title:N}=i,C=et(s,()=>u({params:S,data:P,queryParams:c,fragment:d,routeConfig:p,url:m,outlet:w,title:N}));if(C instanceof Ot)throw new rs(C);t=C}let a=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r);if(t[0]==="/")throw new rs(a);return a}applyRedirectCreateUrlTree(e,t,r,i){let s=this.createSegmentGroup(e,t.root,r,i);return new Ot(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let r={};return Object.entries(e).forEach(([i,s])=>{if(typeof s=="string"&&s[0]===":"){let u=s.substring(1);r[i]=t[u]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){let s=this.createSegments(e,t.segments,r,i),a={};return Object.entries(t.children).forEach(([u,c])=>{a[u]=this.createSegmentGroup(e,c,r,i)}),new ie(s,a)}createSegments(e,t,r,i){return t.map(s=>s.path[0]===":"?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){let i=r[t.path.substring(1)];if(!i)throw new fe(4001,!1);return i}findOrReturn(e,t){let r=0;for(let i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}},dd={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function kA(n,e,t,r,i){let s=Vy(n,e,t);return s.matched?(r=tA(e,r),PA(r,e,t,i).pipe(K(a=>a===!0?s:V({},dd)))):z(s)}function Vy(n,e,t){if(e.path==="**")return MA(t);if(e.path==="")return e.pathMatch==="full"&&(n.hasChildren()||t.length>0)?V({},dd):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||RT)(t,n,e);if(!i)return V({},dd);let s={};Object.entries(i.posParams??{}).forEach(([u,c])=>{s[u]=c.path});let a=i.consumed.length>0?V(V({},s),i.consumed[i.consumed.length-1].parameters):s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:a,positionalParamSegments:i.posParams??{}}}function MA(n){return{matched:!0,parameters:n.length>0?yy(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function fy(n,e,t,r){return t.length>0&&LA(n,t,r)?{segmentGroup:new ie(e,FA(r,new ie(t,n.children))),slicedSegments:[]}:t.length===0&&VA(n,t,r)?{segmentGroup:new ie(n.segments,xA(n,t,r,n.children)),slicedSegments:t}:{segmentGroup:new ie(n.segments,n.children),slicedSegments:t}}function xA(n,e,t,r){let i={};for(let s of t)if(va(n,e,s)&&!r[it(s)]){let a=new ie([],{});i[it(s)]=a}return V(V({},r),i)}function FA(n,e){let t={};t[H]=e;for(let r of n)if(r.path===""&&it(r)!==H){let i=new ie([],{});t[it(r)]=i}return t}function LA(n,e,t){return t.some(r=>va(n,e,r)&&it(r)!==H)}function VA(n,e,t){return t.some(r=>va(n,e,r))}function va(n,e,t){return(n.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function UA(n,e,t){return e.length===0&&!n.children[t]}var fd=class{};function BA(n,e,t,r,i,s,a="emptyOnly"){return new pd(n,e,t,r,i,a,s).recognize()}var $A=31,pd=class{constructor(e,t,r,i,s,a,u){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=a,this.urlSerializer=u,this.applyRedirects=new hd(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new fe(4002,`'${e.segmentGroup}'`)}recognize(){let e=fy(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(K(({children:t,rootSnapshot:r})=>{let i=new ze(r,t),s=new pa("",i),a=KT(r,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(a),{state:s,tree:a}}))}match(e){let t=new _r([],Object.freeze({}),Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),H,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,H,t).pipe(K(r=>({children:r,rootSnapshot:t})),st(r=>{if(r instanceof rs)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof ns?this.noMatchError(r):r}))}processSegmentGroup(e,t,r,i,s){return r.segments.length===0&&r.hasChildren()?this.processChildren(e,t,r,s):this.processSegment(e,t,r,r.segments,i,!0,s).pipe(K(a=>a instanceof ze?[a]:[]))}processChildren(e,t,r,i){let s=[];for(let a of Object.keys(r.children))a==="primary"?s.unshift(a):s.push(a);return Fe(s).pipe(sn(a=>{let u=r.children[a],c=nA(t,a);return this.processSegmentGroup(e,c,u,a,i)}),tu((a,u)=>(a.push(...u),a)),Za(null),Of(),We(a=>{if(a===null)return mr(r);let u=Uy(a);return jA(u),z(u)}))}processSegment(e,t,r,i,s,a,u){return Fe(t).pipe(sn(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,r,i,s,a,u).pipe(st(d=>{if(d instanceof ns)return z(null);throw d}))),Ze(c=>!!c),st(c=>{if(Fy(c))return UA(r,i,s)?z(new fd):mr(r);throw c}))}processSegmentAgainstRoute(e,t,r,i,s,a,u,c){return it(r)!==a&&(a===H||!va(i,s,r))?mr(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,r,s,a,c):this.allowRedirects&&u?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,a,c):mr(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,a,u){let{matched:c,parameters:d,consumedSegments:p,positionalParamSegments:m,remainingSegments:w}=Vy(t,i,s);if(!c)return mr(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>$A&&(this.allowRedirects=!1));let S=new _r(s,d,Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,py(i),it(i),i.component??i._loadedComponent??null,i,gy(i)),P=fa(S,u,this.paramsInheritanceStrategy);S.params=Object.freeze(P.params),S.data=Object.freeze(P.data);let N=this.applyRedirects.applyRedirectCommands(p,i.redirectTo,m,S,e);return this.applyRedirects.lineralizeSegments(i,N).pipe(We(C=>this.processSegment(e,r,t,C.concat(w),a,!1,u)))}matchSegmentAgainstRoute(e,t,r,i,s,a){let u=kA(t,r,i,e,this.urlSerializer);return r.path==="**"&&(t.children={}),u.pipe(He(c=>c.matched?(e=r._injector??e,this.getChildConfig(e,r,i).pipe(He(({routes:d})=>{let p=r._loadedInjector??e,{parameters:m,consumedSegments:w,remainingSegments:S}=c,P=new _r(w,m,Object.freeze(V({},this.urlTree.queryParams)),this.urlTree.fragment,py(r),it(r),r.component??r._loadedComponent??null,r,gy(r)),N=fa(P,a,this.paramsInheritanceStrategy);P.params=Object.freeze(N.params),P.data=Object.freeze(N.data);let{segmentGroup:C,slicedSegments:U}=fy(t,w,S,d);if(U.length===0&&C.hasChildren())return this.processChildren(p,d,C,P).pipe(K(L=>new ze(P,L)));if(d.length===0&&U.length===0)return z(new ze(P,[]));let j=it(r)===s;return this.processSegment(p,d,C,U,j?H:s,!0,P).pipe(K(L=>new ze(P,L instanceof ze?[L]:[])))}))):mr(t)))}getChildConfig(e,t,r){return t.children?z({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?z({routes:t._loadedRoutes,injector:t._loadedInjector}):RA(e,t,r,this.urlSerializer).pipe(We(i=>i?this.configLoader.loadChildren(e,t).pipe(ve(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):OA(t))):z({routes:[],injector:e})}};function jA(n){n.sort((e,t)=>e.value.outlet===H?-1:t.value.outlet===H?1:e.value.outlet.localeCompare(t.value.outlet))}function zA(n){let e=n.value.routeConfig;return e&&e.path===""}function Uy(n){let e=[],t=new Set;for(let r of n){if(!zA(r)){e.push(r);continue}let i=e.find(s=>r.value.routeConfig===s.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):e.push(r)}for(let r of t){let i=Uy(r.children);e.push(new ze(r.value,i))}return e.filter(r=>!t.has(r))}function py(n){return n.data||{}}function gy(n){return n.resolve||{}}function qA(n,e,t,r,i,s){return We(a=>BA(n,e,t,r,a.extractedUrl,i,s).pipe(K(({state:u,tree:c})=>_e(V({},a),{targetSnapshot:u,urlAfterRedirects:c}))))}function GA(n,e){return We(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return z(t);let s=new Set(i.map(c=>c.route)),a=new Set;for(let c of s)if(!a.has(c))for(let d of By(c))a.add(d);let u=0;return Fe(a).pipe(sn(c=>s.has(c)?WA(c,r,n,e):(c.data=fa(c,c.parent,n).resolve,z(void 0))),ve(()=>u++),eu(1),We(c=>u===a.size?z(t):Vt))})}function By(n){let e=n.children.map(t=>By(t)).flat();return[n,...e]}function WA(n,e,t,r){let i=n.routeConfig,s=n._resolve;return i?.title!==void 0&&!Oy(i)&&(s[is]=i.title),HA(s,n,e,r).pipe(K(a=>(n._resolvedData=a,n.data=fa(n,n.parent,t).resolve,null)))}function HA(n,e,t,r){let i=qh(n);if(i.length===0)return z({});let s={};return Fe(i).pipe(We(a=>KA(n[a],e,t,r).pipe(Ze(),ve(u=>{if(u instanceof ts)throw ga(new Ki,u);s[a]=u}))),eu(1),Nf(s),st(a=>Fy(a)?Vt:_t(a)))}function KA(n,e,t,r){let i=ss(e)??r,s=Dr(n,i),a=s.resolve?s.resolve(e,t):et(i,()=>s(e,t));return Xt(a)}function jh(n){return He(e=>{let t=n(e);return t?Fe(t).pipe(K(()=>e)):z(e)})}var $y=(()=>{class n{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===H);return r}getResolvedTitleForRoute(t){return t.data[is]}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>F(QA),providedIn:"root"})}}return n})(),QA=(()=>{class n extends $y{constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||n)(Q(vp))}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),_d=new ae("",{providedIn:"root",factory:()=>({})}),YA=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Ds({type:n,selectors:[["ng-component"]],standalone:!0,features:[ks],decls:1,vars:0,template:function(r,i){r&1&&jf(0,"router-outlet")},dependencies:[iA],encapsulation:2})}}return n})();function wd(n){let e=n.children&&n.children.map(wd),t=e?_e(V({},n),{children:e}):V({},n);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==H&&(t.component=YA),t}var Ed=new ae(""),JA=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=F(gu)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return z(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=Xt(t.loadComponent()).pipe(K(jy),ve(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),Vn(()=>{this.componentLoaders.delete(t)})),i=new Ha(r,()=>new rn).pipe(Wa());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return z({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let s=XA(r,this.compiler,t,this.onLoadEndListener).pipe(Vn(()=>{this.childrenLoaders.delete(r)})),a=new Ha(s,()=>new rn).pipe(Wa());return this.childrenLoaders.set(r,a),a}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function XA(n,e,t,r){return Xt(n.loadChildren()).pipe(K(jy),We(i=>i instanceof Bf||Array.isArray(i)?z(i):Fe(e.compileModuleAsync(i))),K(i=>{r&&r(n);let s,a,u=!1;return Array.isArray(i)?(a=i,u=!0):(s=i.create(t).injector,a=s.get(Ed,[],{optional:!0,self:!0}).flat()),{routes:a.map(wd),injector:s}}))}function ZA(n){return n&&typeof n=="object"&&"default"in n}function jy(n){return ZA(n)?n.default:n}var Id=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>F(eD),providedIn:"root"})}}return n})(),eD=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),tD=new ae("");var nD=new ae(""),rD=(()=>{class n{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new rn,this.transitionAbortSubject=new rn,this.configLoader=F(JA),this.environmentInjector=F(Un),this.urlSerializer=F(md),this.rootContexts=F(ya),this.location=F(Qr),this.inputBindingEnabled=F(vd,{optional:!0})!==null,this.titleStrategy=F($y),this.options=F(_d,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=F(Id),this.createViewTransition=F(tD,{optional:!0}),this.navigationErrorHandler=F(nD,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>z(void 0),this.rootComponentType=null;let t=i=>this.events.next(new Zh(i)),r=i=>this.events.next(new ed(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(_e(V(V({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new Ge({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Wi,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(wt(s=>s.id!==0),K(s=>_e(V({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),He(s=>{let a=!1,u=!1;return z(s).pipe(He(c=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",qe.SupersededByNewNavigation),Vt;this.currentTransition=s,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?_e(V({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),p=c.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!d&&p!=="reload"){let m="";return this.events.next(new On(c.id,this.urlSerializer.serialize(c.rawUrl),m,Kh.IgnoredSameUrlNavigation)),c.resolve(!1),Vt}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return z(c).pipe(He(m=>{let w=this.transitions?.getValue();return this.events.next(new Ji(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),w!==this.transitions?.getValue()?Vt:Promise.resolve(m)}),qA(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),ve(m=>{s.targetSnapshot=m.targetSnapshot,s.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation=_e(V({},this.currentNavigation),{finalUrl:m.urlAfterRedirects});let w=new la(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(w)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:m,extractedUrl:w,source:S,restoredState:P,extras:N}=c,C=new Ji(m,this.urlSerializer.serialize(w),S,P);this.events.next(C);let U=Py(this.rootComponentType).snapshot;return this.currentTransition=s=_e(V({},c),{targetSnapshot:U,urlAfterRedirects:w,extras:_e(V({},N),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=w,z(s)}else{let m="";return this.events.next(new On(c.id,this.urlSerializer.serialize(c.extractedUrl),m,Kh.IgnoredByUrlHandlingStrategy)),c.resolve(!1),Vt}}),ve(c=>{let d=new Qh(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}),K(c=>(this.currentTransition=s=_e(V({},c),{guards:lA(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),s)),EA(this.environmentInjector,c=>this.events.next(c)),ve(c=>{if(s.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw ga(this.urlSerializer,c.guardsResult);let d=new Yh(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(d)}),wt(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",qe.GuardRejected),!1)),jh(c=>{if(c.guards.canActivateChecks.length)return z(c).pipe(ve(d=>{let p=new Jh(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(p)}),He(d=>{let p=!1;return z(d).pipe(GA(this.paramsInheritanceStrategy,this.environmentInjector),ve({next:()=>p=!0,complete:()=>{p||this.cancelNavigationTransition(d,"",qe.NoDataFromResolver)}}))}),ve(d=>{let p=new Xh(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(p)}))}),jh(c=>{let d=p=>{let m=[];p.routeConfig?.loadComponent&&!p.routeConfig._loadedComponent&&m.push(this.configLoader.loadComponent(p.routeConfig).pipe(ve(w=>{p.component=w}),K(()=>{})));for(let w of p.children)m.push(...d(w));return m};return Ja(d(c.targetSnapshot.root)).pipe(Za(null),Ln(1))}),jh(()=>this.afterPreactivation()),He(()=>{let{currentSnapshot:c,targetSnapshot:d}=s,p=this.createViewTransition?.(this.environmentInjector,c.root,d.root);return p?Fe(p).pipe(K(()=>s)):z(s)}),K(c=>{let d=sA(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=s=_e(V({},c),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,s}),ve(()=>{this.events.next(new Zi)}),cA(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Ln(1),ve({next:c=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Nn(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{a=!0}}),kf(this.transitionAbortSubject.pipe(ve(c=>{throw c}))),Vn(()=>{!a&&!u&&this.cancelNavigationTransition(s,"",qe.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),st(c=>{if(u=!0,xy(c))this.events.next(new Nt(s.id,this.urlSerializer.serialize(s.extractedUrl),c.message,c.cancellationCode)),uA(c)?this.events.next(new Ir(c.url,c.navigationBehaviorOptions)):s.resolve(!1);else{let d=new Xi(s.id,this.urlSerializer.serialize(s.extractedUrl),c,s.targetSnapshot??void 0);try{let p=et(this.environmentInjector,()=>this.navigationErrorHandler?.(d));if(p instanceof ts){let{message:m,cancellationCode:w}=ga(this.urlSerializer,p);this.events.next(new Nt(s.id,this.urlSerializer.serialize(s.extractedUrl),m,w)),this.events.next(new Ir(p.redirectTo,p.navigationBehaviorOptions))}else{this.events.next(d);let m=t.errorHandler(c);s.resolve(!!m)}}catch(p){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(p)}}return Vt}))}))}cancelNavigationTransition(t,r,i){let s=new Nt(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function iD(n){return n!==Wi}var sD=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>F(oD),providedIn:"root"})}}return n})(),gd=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},oD=(()=>{class n extends gd{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=su(n)))(i||n)}})()}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),zy=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:()=>F(aD),providedIn:"root"})}}return n})(),aD=(()=>{class n extends zy{constructor(){super(...arguments),this.location=F(Qr),this.urlSerializer=F(md),this.options=F(_d,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=F(Id),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Ot,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Py(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof Ji)this.stateMemento=this.createStateMemento();else if(t instanceof On)this.rawUrlTree=r.initialUrl;else if(t instanceof la){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof Zi?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof Nt&&(t.code===qe.GuardRejected||t.code===qe.NoDataFromResolver)?this.restoreHistory(r):t instanceof Xi?this.restoreHistory(r,!0):t instanceof Nn&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof Ot?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let s=this.browserPageId,a=V(V({},r.extras.state),this.generateNgRouterState(r.id,s));this.location.replaceState(i,"",a)}else{let s=V(V({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",s)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,s=this.currentPageId-i;s!==0?this.location.historyGo(s):this.currentUrlTree===t.finalUrl&&s===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=su(n)))(i||n)}})()}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),qi=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(qi||{});function uD(n,e){n.events.pipe(wt(t=>t instanceof Nn||t instanceof Nt||t instanceof Xi||t instanceof On),K(t=>t instanceof Nn||t instanceof On?qi.COMPLETE:(t instanceof Nt?t.code===qe.Redirect||t.code===qe.SupersededByNewNavigation:!1)?qi.REDIRECTING:qi.FAILED),wt(t=>t!==qi.REDIRECTING),Ln(1)).subscribe(()=>{e()})}function cD(n){throw n}var lD={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},hD={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},_a=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=F(Ms),this.stateManager=F(zy),this.options=F(_d,{optional:!0})||{},this.pendingTasks=F(bs),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=F(rD),this.urlSerializer=F(md),this.location=F(Qr),this.urlHandlingStrategy=F(Id),this._events=new rn,this.errorHandler=this.options.errorHandler||cD,this.navigated=!1,this.routeReuseStrategy=F(sD),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=F(Ed,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!F(vd,{optional:!0}),this.eventsSubscription=new Df,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(i!==null&&s!==null){if(this.stateManager.handleRouterEvent(r,s),r instanceof Nt&&r.code!==qe.Redirect&&r.code!==qe.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Nn)this.navigated=!0;else if(r instanceof Ir){let a=r.navigationBehaviorOptions,u=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=V({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||iD(i.source)},a);this.scheduleNavigation(u,Wi,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}fD(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Wi,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let s={replaceUrl:!0},a=i?.navigationId?i:null;if(i){let c=V({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(s.state=c)}let u=this.parseUrl(t);this.scheduleNavigation(u,r,a,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(wd),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:s,fragment:a,queryParamsHandling:u,preserveFragment:c}=r,d=c?this.currentUrlTree.fragment:a,p=null;switch(u??this.options.defaultQueryParamsHandling){case"merge":p=V(V({},this.currentUrlTree.queryParams),s);break;case"preserve":p=this.currentUrlTree.queryParams;break;default:p=s||null}p!==null&&(p=this.removeEmptyProps(p));let m;try{let w=i?i.snapshot:this.routerState.snapshot.root;m=Sy(w)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),m=this.currentUrlTree.root}return by(m,t,p,d??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=Qi(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,Wi,null,r)}navigate(t,r={skipLocationChange:!1}){return dD(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=V({},lD):r===!1?i=V({},hD):i=r,Qi(t))return cy(this.currentUrlTree,t,i);let s=this.parseUrl(t);return cy(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,s])=>(s!=null&&(r[i]=s),r),{})}scheduleNavigation(t,r,i,s,a){if(this.disposed)return Promise.resolve(!1);let u,c,d;a?(u=a.resolve,c=a.reject,d=a.promise):d=new Promise((m,w)=>{u=m,c=w});let p=this.pendingTasks.add();return uD(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(p))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:s,resolve:u,reject:c,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(m=>Promise.reject(m))}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=W({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function dD(n){for(let e=0;e<n.length;e++)if(n[e]==null)throw new fe(4008,!1)}function fD(n){return!(n instanceof Zi)&&!(n instanceof Ir)}var pD=new ae("");function NN(n,...e){return Et([{provide:Ed,multi:!0,useValue:n},[],{provide:Tr,useFactory:gD,deps:[_a]},{provide:pu,multi:!0,useFactory:mD},e.map(t=>t.\u0275providers)])}function gD(n){return n.routerState.root}function mD(){let n=F(on);return e=>{let t=n.get(xs);if(e!==t.components[0])return;let r=n.get(_a),i=n.get(yD);n.get(vD)===1&&r.initialNavigation(),n.get(_D,null,ru.Optional)?.setUpPreloading(),n.get(pD,null,ru.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var yD=new ae("",{factory:()=>new rn}),vD=new ae("",{providedIn:"root",factory:()=>1});var _D=new ae("");var qy=class n{router=F(_a);item;navigate(){return D(this,null,function*(){yield this.router.navigate([this.item.route])})}static \u0275fac=function(t){return new(t||n)};static \u0275cmp=Ds({type:n,selectors:[["app-bottom-nav"]],inputs:{item:"item"},standalone:!0,features:[ks],decls:7,vars:2,consts:[["tabindex","0",1,"bottom-nav",3,"click","keydown.enter"],[1,"nav-arrow"],[1,"nav-button"],[1,"nav-info"]],template:function(t,r){t&1&&(Wr(0,"div",0),hu("click",function(){return r.navigate()})("keydown.enter",function(){return r.navigate()}),Wr(1,"span",1),Os(2,"\u2191"),Ns(),Wr(3,"p",2),Os(4),Ns(),Wr(5,"span",3),Os(6),Ns()()),t&2&&(cu(4),du(r.item.label),cu(2),du(r.item.info))},styles:[".bottom-nav[_ngcontent-%COMP%]{position:fixed;bottom:0;left:50%;transform:translate(-50%);width:33%;height:64px;padding:12px 0;cursor:pointer;border:1px solid #133167;border-radius:6px 6px 0 0;border-bottom:none;background-color:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:4px}.bottom-nav[_ngcontent-%COMP%]   .nav-button[_ngcontent-%COMP%]{font-size:14px;font-weight:600}.bottom-nav[_ngcontent-%COMP%]   .nav-info[_ngcontent-%COMP%]{font-size:12px;font-weight:400}"]})};export{YD as a,JD as b,hS as c,qS as d,iA as e,NN as f,Ob as g,kb as h,MP as i,xP as j,uy as k,qy as l};
